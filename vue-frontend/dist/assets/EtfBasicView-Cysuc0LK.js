import{d as H,a as v,r as O,y as J,c as y,b as z,e as a,w as o,i as c,E as K,k as C,l as Q,O as X,F as x,A as w,f as h,D as Z,G as ee,t as ae,u as le,o as p,_ as te}from"./index-B_RXet-9.js";import{g as E}from"./etfApi-BAY2m_w1.js";const ne={class:"etf-basic-view"},oe={class:"page-header"},se={class:"header-content"},de={class:"pagination"},ie=H({__name:"EtfBasicView",setup(re){const D=le(),V=v(!1),k=v([]),s=O({page:1,page_size:20,total:0,pages:0}),l=O({ts_code:"",index_code:"",exchange:"",list_status:"",etf_type:"",mgr_name:"",name:"",list_year:""}),F=v([]),B=v([]),S=v([]),T=v([]),U=v([]),M=async()=>{try{const d=await E({page:1,page_size:5e3});if(d.data){const t=d.data,m=new Map;t.forEach(n=>{n.index_code&&m.set(n.index_code,n.index_name||"")}),F.value=Array.from(m.entries()).map(([n,r])=>({value:n,label:r?`${n} ${r}`:n}));const f=new Set;t.forEach(n=>{n.exchange&&f.add(n.exchange)}),B.value=Array.from(f).sort();const g=new Set;t.forEach(n=>{n.etf_type&&g.add(n.etf_type)}),S.value=Array.from(g).sort();const i=new Set;t.forEach(n=>{n.mgr_name&&i.add(n.mgr_name)}),T.value=Array.from(i).sort((n,r)=>n.localeCompare(r,"zh-CN"));const u=new Set;t.forEach(n=>{const r=n.list_date||"";r&&r.length>=4&&u.add(r.slice(0,4))}),U.value=Array.from(u).sort((n,r)=>r.localeCompare(n))}}catch(d){console.error("获取筛选选项失败",d)}},b=async()=>{V.value=!0;try{if(!!l.list_year){const m=((await E({ts_code:l.ts_code||void 0,index_code:l.index_code||void 0,exchange:l.exchange||void 0,list_status:l.list_status||void 0,etf_type:l.etf_type||void 0,mgr_name:l.mgr_name||void 0,name:l.name||void 0,page:1,page_size:5e3})).data||[]).filter(n=>{const r=n.list_date||"";return r&&r.startsWith(l.list_year)}),f=m.length,g=Math.ceil(f/s.page_size),i=(s.page-1)*s.page_size,u=i+s.page_size;k.value=m.slice(i,u),s.total=f,s.pages=g,s.page>g&&(s.page=Math.max(1,g))}else{const t=await E({ts_code:l.ts_code||void 0,index_code:l.index_code||void 0,exchange:l.exchange||void 0,list_status:l.list_status||void 0,etf_type:l.etf_type||void 0,mgr_name:l.mgr_name||void 0,name:l.name||void 0,page:s.page,page_size:s.page_size});k.value=t.data||[],s.total=t.total||0,s.pages=t.pages||0}}catch(d){K.error(d?.message||"ETF 基本信息获取失败")}finally{V.value=!1}},N=()=>{s.page=1,b()},L=()=>{l.ts_code="",l.index_code="",l.exchange="",l.list_status="",l.etf_type="",l.mgr_name="",l.name="",l.list_year="",s.page=1,b()},P=()=>b(),Y=d=>{s.page_size=d,s.page=1,b()},$=d=>{s.page=d,b()},q=d=>{d&&D.push({name:"index-analysis",query:{ts_code:d}})};return J(()=>{M(),b()}),(d,t)=>{const m=c("el-button"),f=c("el-icon"),g=c("el-space"),i=c("el-option"),u=c("el-select"),n=c("el-form-item"),r=c("el-input"),I=c("el-form"),A=c("el-card"),_=c("el-table-column"),R=c("el-link"),j=c("el-table"),G=c("el-pagination"),W=ee("loading");return p(),y("div",ne,[z("div",oe,[z("div",se,[t[12]||(t[12]=z("h2",null,"ETF 基本信息",-1)),a(g,null,{default:o(()=>[a(m,{type:"primary",loading:V.value,onClick:N},{default:o(()=>[...t[9]||(t[9]=[C("查询",-1)])]),_:1},8,["loading"]),a(m,{onClick:L},{default:o(()=>[...t[10]||(t[10]=[C("重置",-1)])]),_:1}),a(m,{onClick:P},{default:o(()=>[a(f,null,{default:o(()=>[a(Q(X))]),_:1}),t[11]||(t[11]=C("刷新",-1))]),_:1})]),_:1})])]),a(A,{class:"search-card"},{default:o(()=>[a(I,{model:l,"label-width":"110px","label-position":"left",inline:""},{default:o(()=>[a(n,{label:"指数代码"},{default:o(()=>[a(u,{modelValue:l.index_code,"onUpdate:modelValue":t[0]||(t[0]=e=>l.index_code=e),placeholder:"选择或搜索指数",clearable:"",filterable:"",style:{width:"200px"}},{default:o(()=>[(p(!0),y(x,null,w(F.value,e=>(p(),h(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"交易所"},{default:o(()=>[a(u,{modelValue:l.exchange,"onUpdate:modelValue":t[1]||(t[1]=e=>l.exchange=e),placeholder:"选择交易所",clearable:"",style:{width:"140px"}},{default:o(()=>[(p(!0),y(x,null,w(B.value,e=>(p(),h(i,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"上市状态"},{default:o(()=>[a(u,{modelValue:l.list_status,"onUpdate:modelValue":t[2]||(t[2]=e=>l.list_status=e),placeholder:"全部",clearable:"",style:{width:"160px"}},{default:o(()=>[a(i,{label:"全部",value:""}),a(i,{label:"上市",value:"L"}),a(i,{label:"退市",value:"D"}),a(i,{label:"暂停",value:"P"})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"上市年份"},{default:o(()=>[a(u,{modelValue:l.list_year,"onUpdate:modelValue":t[3]||(t[3]=e=>l.list_year=e),placeholder:"选择年份",clearable:"",style:{width:"120px"}},{default:o(()=>[(p(!0),y(x,null,w(U.value,e=>(p(),h(i,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"ETF类型"},{default:o(()=>[a(u,{modelValue:l.etf_type,"onUpdate:modelValue":t[4]||(t[4]=e=>l.etf_type=e),placeholder:"选择类型",clearable:"",style:{width:"160px"}},{default:o(()=>[(p(!0),y(x,null,w(S.value,e=>(p(),h(i,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"管理人"},{default:o(()=>[a(u,{modelValue:l.mgr_name,"onUpdate:modelValue":t[5]||(t[5]=e=>l.mgr_name=e),placeholder:"选择或搜索管理人",clearable:"",filterable:"",style:{width:"180px"}},{default:o(()=>[(p(!0),y(x,null,w(T.value,e=>(p(),h(i,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"名称关键词"},{default:o(()=>[a(r,{modelValue:l.name,"onUpdate:modelValue":t[6]||(t[6]=e=>l.name=e),placeholder:"支持模糊搜索",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),a(A,{class:"table-card"},{default:o(()=>[Z((p(),h(j,{data:k.value,border:"",style:{width:"100%"}},{default:o(()=>[a(_,{prop:"extname",label:"ETF简称","min-width":"160",align:"center"}),a(_,{prop:"ts_code",label:"ETF代码","min-width":"140",align:"center"}),a(_,{prop:"index_name",label:"跟踪指数","min-width":"160",align:"center"}),a(_,{prop:"index_code",label:"指数代码","min-width":"140",align:"center"},{default:o(({row:e})=>[a(R,{type:"primary",underline:!1,onClick:ce=>q(e.index_code)},{default:o(()=>[C(ae(e.index_code),1)]),_:2},1032,["onClick"])]),_:1}),a(_,{prop:"exchange",label:"交易所","min-width":"80",align:"center"}),a(_,{prop:"csname",label:"基金简称","min-width":"160",align:"center"}),a(_,{prop:"etf_type",label:"ETF类型","min-width":"120",align:"center"}),a(_,{prop:"mgt_fee",label:"管理费率","min-width":"100",align:"center"}),a(_,{prop:"list_date",label:"上市日期","min-width":"120",align:"center"}),a(_,{prop:"delist_date",label:"退市日期","min-width":"120",align:"center"}),a(_,{prop:"custod_name",label:"托管人","min-width":"180",align:"center"})]),_:1},8,["data"])),[[W,V.value]]),z("div",de,[a(G,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:s.total,"page-sizes":[10,20,50,100],"page-size":s.page_size,"onUpdate:pageSize":t[7]||(t[7]=e=>s.page_size=e),"current-page":s.page,"onUpdate:currentPage":t[8]||(t[8]=e=>s.page=e),onSizeChange:Y,onCurrentChange:$},null,8,["total","page-size","current-page"])])]),_:1})])}}}),_e=te(ie,[["__scopeId","data-v-ac0c223b"]]);export{_e as default};
