import{J as g}from"./index-C0bjGGzq.js";const l="/django/api/stock";async function _(r,t){return(await g.get(`${l}/industry-sector/daily/${r}/`,{params:t})).data}function p(r){if(!r||r.length===0)return{avgChangePercent:0,avgPeRatio:0,avgPbRatio:0,avgChange60Day:0,avgChangeYtd:0};let t=0,a=0,s=0,c=0,e=0,i=0,o=0,u=0,d=0,h=0;return r.forEach(n=>{typeof n.change_percent=="number"&&(t+=n.change_percent,i++),typeof n.pe_ratio=="number"&&n.pe_ratio>0&&(a+=n.pe_ratio,o++),typeof n.pb_ratio=="number"&&n.pb_ratio>0&&(s+=n.pb_ratio,u++),typeof n.change_60day=="number"&&(c+=n.change_60day,d++),typeof n.change_ytd=="number"&&(e+=n.change_ytd,h++)}),{avgChangePercent:i>0?t/i:0,avgPeRatio:o>0?a/o:0,avgPbRatio:u>0?s/u:0,avgChange60Day:d>0?c/d:0,avgChangeYtd:h>0?e/h:0}}async function f(r){try{const t=await g.get(`${l}/industry-sectors/`);if(t.code!==200)throw new Error(t.message||"获取行业板块列表失败");const a=t.data.sectors.find(o=>o.name===r);if(!a)return console.warn(`未找到行业: ${r}`),null;const s=await g.get(`${l}/industry-sector/constituents/${a.code}/`);if(s.code!==200)throw new Error(s.message||"获取行业成分股失败");const c=s.data.constituents;let e=null;try{const o=await g.get(`${l}/industry-sector/realtime/${a.code}/`);o.code===200&&(e=o.data)}catch(o){console.warn(`获取行业 ${a.code} 实时行情失败:`,o)}const i=p(c);return{industry:a.name,code:a.code,count:a.stock_count,stocks:c,...i,latest_price:e?.latest_price||a.latest_price,change_amount:e?.change,change_percent:e?.change_percent||a.change_percent,open:e?.open,high:e?.high,low:e?.low,volume:e?.volume,amount:e?.amount,turnover_rate:e?.turnover_rate,rising_stocks:e?.rising_stocks,falling_stocks:e?.falling_stocks,unchanged_stocks:e?.unchanged_stocks}}catch(t){throw console.error("获取行业详情错误:",t),t}}async function m(r){try{const t=r?{industry:r}:{};return(await g.get(`${l}/industry/statistics/`,{params:t})).data}catch(t){throw console.error("Error fetching industry statistics:",t),t}}export{m as a,f,_ as g};
