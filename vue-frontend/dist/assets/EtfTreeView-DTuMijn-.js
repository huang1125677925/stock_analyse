import{c as Xe,g as Be,a as Ge}from"./etfApi-Bdw84FII.js";import{i as ye}from"./index-ElshY9iF.js";import{f as Pe,a as Ke}from"./indexBasicApi-DHXZFlIS.js";import{S as ve}from"./StockKLineChart-DYA-VXYV.js";import{d as ge,a as b,z as S,y as we,B as Q,c as V,e as o,i as v,w as s,k as m,b as f,D as be,G as he,f as _,L as Ue,F as ue,A as We,E as G,o as c,_ as xe,C as je,H as se,t as E,g as $}from"./index-DBlIMAuh.js";import{a as qe}from"./indexDailyApi-CHEVNkwN.js";import{g as Qe}from"./individualStockApi-B-09Q-jr.js";const He={class:"table-toolbar"},Ze=ge({__name:"EtfCategoryVolatilityTab",props:{etfCodes:{},codeNameMap:{}},setup(pe){const N=pe,O=b(!1),n=b([]),x=b("latest"),X=S(()=>x.value==="all"?95:120),h=b({start_date:"",end_date:"",sample_n:void 0}),P=T=>{const r=T.getFullYear(),w=String(T.getMonth()+1).padStart(2,"0"),M=String(T.getDate()).padStart(2,"0");return`${r}-${w}-${M}`},H=()=>{const T=new Date,r=new Date;r.setDate(T.getDate()-365),h.value.start_date=P(r),h.value.end_date=P(T)},B=async()=>{if(!N.etfCodes||N.etfCodes.length<1){G.warning("请至少选择一个ETF");return}O.value=!0;try{n.value=await Xe({ts_codes:N.etfCodes,start_date:h.value.start_date||void 0,end_date:h.value.end_date||void 0,sample_n:h.value.sample_n})}catch(T){G.error(T?.message||"波动性数据查询失败")}finally{O.value=!1}},U=()=>{h.value.start_date="",h.value.end_date="",h.value.sample_n=void 0,n.value=[]},Z=S(()=>(Array.isArray(n.value)?n.value:[]).map(r=>{const w=r.ts_code;return{etf_name:w?N.codeNameMap[w]||w:"",...r}})),W=S(()=>({period:["start_date","end_date"],extremes:["highest_value","highest_date","lowest_value","lowest_date"],drawdown:["max_drawdown_pct","mdd_start_date","mdd_end_date","mdd_days"],rise:["max_rise_pct","rise_start_date","rise_end_date","rise_days"],latest:["latest_price","latest_date","percentile_between_min_max"],stats:["mean","variance","stddev"],trend:["trend","grid_applicable","sample_used","sample_n"],all:["start_date","end_date","highest_value","highest_date","lowest_value","lowest_date","max_drawdown_pct","mdd_start_date","mdd_end_date","mdd_days","max_rise_pct","rise_start_date","rise_end_date","rise_days","latest_price","latest_date","percentile_between_min_max","mean","variance","stddev","trend","grid_applicable","sample_used","sample_n"]})[x.value]||[]),J={ts_code:"ETF代码",start_date:"开始日期",end_date:"结束日期",highest_value:"最高值",highest_date:"最高值日期",lowest_value:"最低值",lowest_date:"最低值日期",max_drawdown_pct:"最大回撤(%)",mdd_start_date:"回撤峰值开始",mdd_end_date:"回撤最低结束",mdd_days:"回撤交易日数",max_rise_pct:"最大上涨(%)",rise_start_date:"上涨谷底开始",rise_end_date:"上涨峰值结束",rise_days:"上涨交易日数",latest_price:"最新收盘价",latest_date:"最新价日期",percentile_between_min_max:"最新价区间百分位",mean:"均值",variance:"方差",stddev:"标准差",trend:"趋势",grid_applicable:"网格适配",sample_used:"使用抽样",sample_n:"抽样点数"},z=(T,r,w)=>{const M=T[w],F=r[w],L=Number(M),I=Number(F),j=!Number.isNaN(L),Y=!Number.isNaN(I);if(j&&Y)return L-I;const te=String(M??""),A=String(F??"");return te.localeCompare(A)},ee=T=>(r,w)=>z(r,w,T);return we(()=>{H(),N.etfCodes&&N.etfCodes.length>0&&B()}),Q(()=>N.etfCodes.slice(),()=>{N.etfCodes&&N.etfCodes.length>0?B():n.value=[]}),(T,r)=>{const w=v("el-date-picker"),M=v("el-form-item"),F=v("el-input-number"),L=v("el-button"),I=v("el-form"),j=v("el-card"),Y=v("el-radio-button"),te=v("el-radio-group"),A=v("el-table-column"),ie=v("el-table"),K=he("loading");return c(),V("div",null,[o(j,{class:"search-card",shadow:"never"},{default:s(()=>[o(I,{model:h.value,"label-width":"110px","label-position":"left",inline:""},{default:s(()=>[o(M,{label:"开始日期"},{default:s(()=>[o(w,{modelValue:h.value.start_date,"onUpdate:modelValue":r[0]||(r[0]=C=>h.value.start_date=C),type:"date",placeholder:"选择开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),o(M,{label:"结束日期"},{default:s(()=>[o(w,{modelValue:h.value.end_date,"onUpdate:modelValue":r[1]||(r[1]=C=>h.value.end_date=C),type:"date",placeholder:"选择结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),o(M,{label:"抽样点数"},{default:s(()=>[o(F,{modelValue:h.value.sample_n,"onUpdate:modelValue":r[2]||(r[2]=C=>h.value.sample_n=C),min:0,max:1e3,step:10,"controls-position":"right",placeholder:"可选"},null,8,["modelValue"])]),_:1}),o(M,null,{default:s(()=>[o(L,{type:"primary",loading:O.value,onClick:B},{default:s(()=>[...r[4]||(r[4]=[m("查询",-1)])]),_:1},8,["loading"]),o(L,{onClick:U},{default:s(()=>[...r[5]||(r[5]=[m("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),o(j,{class:"table-card",shadow:"never"},{default:s(()=>[f("div",He,[o(te,{modelValue:x.value,"onUpdate:modelValue":r[3]||(r[3]=C=>x.value=C),size:"small"},{default:s(()=>[o(Y,{label:"latest"},{default:s(()=>[...r[6]||(r[6]=[m("最新价",-1)])]),_:1}),o(Y,{label:"extremes"},{default:s(()=>[...r[7]||(r[7]=[m("极值",-1)])]),_:1}),o(Y,{label:"drawdown"},{default:s(()=>[...r[8]||(r[8]=[m("最大回撤",-1)])]),_:1}),o(Y,{label:"rise"},{default:s(()=>[...r[9]||(r[9]=[m("最大上涨",-1)])]),_:1}),o(Y,{label:"stats"},{default:s(()=>[...r[10]||(r[10]=[m("统计量",-1)])]),_:1}),o(Y,{label:"trend"},{default:s(()=>[...r[11]||(r[11]=[m("趋势网格",-1)])]),_:1}),o(Y,{label:"period"},{default:s(()=>[...r[12]||(r[12]=[m("区间",-1)])]),_:1}),o(Y,{label:"all"},{default:s(()=>[...r[13]||(r[13]=[m("全部",-1)])]),_:1})]),_:1},8,["modelValue"])]),be((c(),_(ie,{data:Z.value,border:"",style:{width:"100%"},class:Ue({"compact-table":x.value==="all"})},{default:s(()=>[o(A,{prop:"etf_name",label:"ETF名称","min-width":X.value,sortable:"","sort-method":ee("etf_name")},null,8,["min-width","sort-method"]),(c(!0),V(ue,null,We(W.value,C=>(c(),_(A,{key:C,prop:C,label:J[C]||C,"min-width":X.value,sortable:"","sort-method":ee(C)},null,8,["prop","label","min-width","sort-method"]))),128))]),_:1},8,["data","class"])),[[K,O.value]])]),_:1})])}}}),Je=xe(Ze,[["__scopeId","data-v-ffcda692"]]),et={class:"etf-tree-view"},tt={class:"main-container"},at={class:"tree-wrapper"},nt={class:"tree-search"},lt={class:"custom-tree-node"},ot={class:"node-label"},st={class:"node-info"},it={key:0,class:"detail-content"},dt={class:"tab-content"},rt={class:"detail-title"},ct={key:0,class:"children-section"},ut={class:"section-header"},pt={key:1,class:"no-children-tip"},mt={class:"tab-content"},_t={style:{"margin-bottom":"10px",display:"flex","justify-content":"flex-end",gap:"8px"}},ft={key:0,style:{padding:"20px"}},yt={key:1},vt={class:"tab-content"},gt={class:"tab-content"},wt={class:"tab-content"},bt={key:0,style:{padding:"20px"}},ht={key:1},xt={key:1,class:"empty-state"},Tt=ge({__name:"EtfTreeView",setup(pe){const N=b(),O=b(""),n=b(null),x=b(null),X=b([]),h=b("basic"),P=b([]),H=b([]),B=b(!1),U=b(!1),Z=b([]),W=b(!1),J=b([]),z=b("1y"),ee=S(()=>(Z.value||[]).map(l=>({date:l.trade_date,open_price:l.open,close_price:l.close,high_price:l.high,low_price:l.low,volume:l.vol,amount:l.amount}))),T=S(()=>(J.value||[]).map(l=>({date:l.date,open_price:l.open,close_price:l.close,high_price:l.high,low_price:l.low,volume:l.vol??0,amount:l.amount??0}))),r=b(new Map),w=b(new Map),M=b();let F=null;const L=b();let I=null;const j=[{code:"纯境内",name:"纯境内"},{code:"QDII",name:"QDII"}],Y={label:"label",isLeaf:(l,e)=>l.nodeType==="ETF"},te=(l,e,t)=>{if(!l)return!0;const a=l.trim().toLowerCase();return[e.label||"",e.etf_type||"",e.index_code||"",e.index_name||"",e.mgr_name||"",e.category||"",e.item?.ts_code||"",e.item?.csname||"",e.item?.extname||""].some(p=>p.toLowerCase().includes(a))};Q(O,l=>{N.value&&typeof N.value.filter=="function"&&N.value.filter(l)});const A=l=>{l&&l.childNodes?X.value=l.childNodes.map(e=>e.data):X.value=[]},ie=async(l,e=12e3)=>{const t=Date.now();for(;Date.now()-t<e;){if(await se(),l.childNodes&&l.childNodes.length>0)return;await new Promise(a=>setTimeout(a,100))}},K=async l=>{const e=N.value,t=e?.getNode?.(l);if(t){if(typeof t.expand=="function")t.expand();else if(typeof e.setExpandedKeys=="function"){const a=typeof e.getExpandedKeys=="function"?e.getExpandedKeys():[];e.setExpandedKeys(Array.from(new Set([...a||[],l])))}return await ie(t),t}},C=async()=>{await se();const l=await K("ROOT");if(l)for(const e of l.childNodes||[]){const t=await K(e.key);if(t)for(const a of t.childNodes||[]){const i=await K(a.key);if(i)for(const p of i.childNodes||[]){const d=await K(p.key);if(d)for(const y of d.childNodes||[]){const u=await K(y.key);if(u)for(const g of u.childNodes||[]);}}}}},ne=async l=>{const e=r.value.get(l);if(e)return e;const t=2500;let a=1,i=1;const p=[];try{for(;a<=i;){const d=await Be({etf_type:l,page:a,page_size:t});p.push(...d.data||[]),i=d.pages||1,a+=1}return r.value.set(l,p),p}catch{return G.error("加载ETF基础信息失败"),[]}},Te=async(l,e)=>{try{if(l.level===0){e([{key:"ROOT",label:"ETF分类",nodeType:"ROOT"}]);return}const t=l.data;if(t.nodeType==="ROOT"){const a=j.map(i=>({key:`TYPE:${i.code}`,label:`${i.name}`,nodeType:"TYPE",etf_type:i.code}));e(a),x.value&&x.value.key===l.key&&A(l);return}if(t.nodeType==="TYPE"&&t.etf_type){const a=await ne(t.etf_type),i=new Set(a.map(d=>d.mgr_name||"").filter(d=>!!d)),p=Array.from(i).map(d=>({key:`MGR:${t.etf_type}:${d}`,label:d,nodeType:"MGR",etf_type:t.etf_type,mgr_name:d}));e(p),x.value&&x.value.key===l.key&&A(l);return}if(t.nodeType==="MGR"&&t.etf_type&&t.mgr_name){await le();const i=(await ne(t.etf_type)).filter(y=>y.mgr_name===t.mgr_name),p=new Set;for(const y of i){const u=y.index_code||"";if(!u)continue;const g=w.value.get(u);p.add(g?.category||"未知")}const d=Array.from(p.values()).map(y=>({key:`CAT:${t.etf_type}:${t.mgr_name}:${y}`,label:y,nodeType:"CAT",etf_type:t.etf_type,mgr_name:t.mgr_name,category:y}));e(d),x.value&&x.value.key===l.key&&A(l);return}if(t.nodeType==="CAT"&&t.etf_type&&t.mgr_name&&t.category){await le();const i=(await ne(t.etf_type)).filter(y=>y.mgr_name===t.mgr_name),p=new Map;for(const y of i){const u=y.index_code||"";if(!u||(w.value.get(u)?.category||"未知")!==t.category)continue;const R=y.index_name||"";p.has(u)||p.set(u,R)}const d=Array.from(p.entries()).map(([y,u])=>({key:`INDEX:${t.etf_type}:${t.mgr_name}:${t.category}:${y}`,label:u||y,nodeType:"INDEX",etf_type:t.etf_type,mgr_name:t.mgr_name,index_code:y,index_name:u,category:t.category}));e(d),x.value&&x.value.key===l.key&&A(l);return}if(t.nodeType==="INDEX"&&t.etf_type&&t.index_code&&t.mgr_name){const p=(await ne(t.etf_type)).filter(d=>d.index_code===t.index_code&&d.mgr_name===t.mgr_name).map(d=>({key:`ETF:${d.ts_code}`,label:`${d.csname||d.extname||d.ts_code}`,nodeType:"ETF",etf_type:t.etf_type,index_code:d.index_code||void 0,index_name:d.index_name||void 0,mgr_name:d.mgr_name||void 0,category:t.category,item:d}));e(p),x.value&&x.value.key===l.key&&A(l);return}e([])}catch{G.error("加载ETF分类失败"),e([])}},ke=(l,e)=>{n.value=l,x.value=e,A(e)},Ee=(l,e)=>{x.value&&x.value.key===e.key&&A(e)},Ne=S(()=>{if(!n.value||n.value.nodeType!=="TYPE")return[];const l=r.value.get(n.value.etf_type||"")||[],e=new Map;for(const t of l){const a=t.mgr_name||"";a&&e.set(a,(e.get(a)||0)+1)}return Array.from(e.entries()).map(([t,a])=>({mgr_name:t,count:a})).sort((t,a)=>a.count-t.count)}),Ce=S(()=>{if(!n.value||n.value.nodeType!=="MGR")return[];const e=(r.value.get(n.value.etf_type||"")||[]).filter(a=>a.mgr_name===n.value?.mgr_name),t=new Map;for(const a of e){const i=a.index_code||"";if(!i)continue;const p=a.index_name||"",d=t.get(i)||{index_name:p,count:0};d.count+=1,t.set(i,d)}return Array.from(t.entries()).map(([a,i])=>({index_code:a,index_name:i.index_name,count:i.count})).sort((a,i)=>i.count-a.count)}),le=async()=>{if(!(w.value.size>0))try{const l=await Pe({fields:"ts_code,name,market,publisher,category"}),e=new Map;for(const t of l)e.set(t.ts_code,t);w.value=e}catch{G.error("加载指数基础信息失败")}},me=S(()=>{if(!n.value||n.value.nodeType!=="MGR")return[];const e=(r.value.get(n.value.etf_type||"")||[]).filter(i=>i.mgr_name===n.value?.mgr_name),t=new Set;for(const i of e){const p=i.index_code||"";p&&t.add(p)}const a=new Map;for(const i of t){const d=w.value.get(i)?.category||"未知";a.set(d,(a.get(d)||0)+1)}return Array.from(a.entries()).map(([i,p])=>({category:i,count:p})).sort((i,p)=>p.count-i.count)}),De=S(()=>{if(!n.value||n.value.nodeType!=="CAT")return[];const e=(r.value.get(n.value.etf_type||"")||[]).filter(a=>a.mgr_name===n.value?.mgr_name),t=new Map;for(const a of e){const i=a.index_code||"";if(!i||(w.value.get(i)?.category||"未知")!==n.value.category)continue;const y=a.index_name||"",u=t.get(i)||{index_name:y,count:0};u.count+=1,t.set(i,u)}return Array.from(t.entries()).map(([a,i])=>({index_code:a,index_name:i.index_name,count:i.count})).sort((a,i)=>i.count-a.count)}),Me=()=>{if(!M.value)return;F||(F=ye(M.value));const l=me.value.map(t=>({name:t.category,value:t.count})),e={tooltip:{trigger:"item"},legend:{bottom:0},series:[{type:"pie",radius:["40%","70%"],avoidLabelOverlap:!0,label:{show:!0,formatter:"{b}: {d}%"},data:l}]};F.setOption(e)};we(()=>{C()}),je(()=>{F&&(F.dispose(),F=null),I&&(I.dispose(),I=null)});const Fe=S(()=>!n.value||n.value.nodeType!=="INDEX"?[]:(r.value.get(n.value.etf_type||"")||[]).filter(e=>e.index_code===n.value?.index_code&&e.mgr_name===n.value?.mgr_name)),Ie=S(()=>{if(!n.value||n.value.nodeType!=="CAT")return[];const e=(r.value.get(n.value.etf_type||"")||[]).filter(a=>a.mgr_name===n.value?.mgr_name),t=[];for(const a of e){const i=a.index_code||"";!i||(w.value.get(i)?.category||"未知")!==n.value.category||a.ts_code&&t.push(a.ts_code)}return t}),Ve=S(()=>{if(!n.value||n.value.nodeType!=="CAT")return new Map;const e=(r.value.get(n.value.etf_type||"")||[]).filter(a=>a.mgr_name===n.value?.mgr_name),t=new Map;for(const a of e){const i=a.index_code||"";if(!i||(w.value.get(i)?.category||"未知")!==n.value.category)continue;const y=a.extname||a.csname||a.cname||a.ts_code||"";a.ts_code&&t.set(a.ts_code,y)}return t}),Se=S(()=>Object.fromEntries(Ve.value));Q(X,()=>{h.value="basic"}),Q(n,async()=>{n.value?.nodeType==="MGR"?(await le(),await se(),Me()):F&&(F.dispose(),F=null),n.value?.nodeType!=="INDEX"&&(P.value=[],B.value=!1,I&&(I.dispose(),I=null)),n.value?.nodeType!=="INDEX"&&(J.value=[],W.value=!1),n.value?.nodeType!=="ETF"&&(Z.value=[],U.value=!1)});const Ye=async()=>{if(!n.value||n.value.nodeType!=="INDEX")return;const l=n.value.index_code||"";if(l){B.value=!0;try{const e=await Ke({index_code:l,fields:"index_code,con_code,con_name,weight,trade_date"}),t=g=>(g||"").replace(/-/g,"");let a="";for(const g of e){const k=t(g.trade_date);k>a&&(a=k)}const i=e.filter(g=>t(g.trade_date)===a);P.value=[...i].sort((g,k)=>Number(k.weight||0)-Number(g.weight||0));const p=g=>(g||"").replace(/\.[A-Z]+$/i,""),d=Array.from(new Set(P.value.map(g=>p(g.con_code))));let y=new Map,u=new Map;if(d.length>0)try{const k=(await Qe({codes:d.join(","),page_size:d.length})).data||[];y=new Map(k.map(R=>[R.code,R.name])),u=new Map(k.map(R=>[R.code,R.industry]))}catch{}H.value=P.value.map(g=>{const k=p(g.con_code),R=k&&y.get(k)||void 0,de=k&&u.get(k)||void 0;return{...g,base_code:k,stock_name:R,industry:de}})}catch{G.error("加载指数成分权重失败")}finally{B.value=!1}}},Ae=()=>{if(!L.value)return;I||(I=ye(L.value));const l=new Map;for(const a of H.value){const i=a.industry||"未知";l.set(i,(l.get(i)||0)+1)}const e=Array.from(l.entries()).map(([a,i])=>({name:a,value:i})).sort((a,i)=>i.value-a.value),t={tooltip:{trigger:"item"},legend:{bottom:0,type:"scroll"},series:[{type:"pie",center:["50%","45%"],radius:["40%","70%"],avoidLabelOverlap:!0,label:{show:!0,formatter:"{b}: {d}%"},data:e}]};I.setOption(t)};Q(h,async l=>{l==="weights"?(await Ye(),await se(),Ae()):l==="trend"?await _e():l==="index-trend"?await ze():l==="cat-volatility"&&await le()}),Q(z,async()=>{h.value==="trend"&&await _e()});const $e=l=>{const e=Number(l||0);return Number.isNaN(e)?"--":(e*100).toFixed(2)},oe=l=>{const e=l.getFullYear(),t=String(l.getMonth()+1).padStart(2,"0"),a=String(l.getDate()).padStart(2,"0");return`${e}-${t}-${a}`},_e=async()=>{if(!n.value||n.value.nodeType!=="ETF"||!n.value.item)return;const l=n.value.item.ts_code;if(l){U.value=!0;try{const e=new Date,t=new Date,a=z.value==="1y"?1:z.value==="3y"?3:5;t.setFullYear(e.getFullYear()-a);const i=await Ge({ts_code:l,start_date:oe(t),end_date:oe(e)});Z.value=i}catch{G.error("加载ETF趋势数据失败")}finally{U.value=!1}}},ze=async()=>{if(!n.value||n.value.nodeType!=="INDEX")return;const l=n.value.index_code||"";if(l){W.value=!0;try{const e=new Date,t=new Date;t.setDate(e.getDate()-180);const a=await qe(l,oe(t).replace(/-/g,""),oe(e).replace(/-/g,""));J.value=a}catch{G.error("加载指数趋势数据失败")}finally{W.value=!1}}};return(l,e)=>{const t=v("el-input"),a=v("el-tag"),i=v("el-tree"),p=v("el-card"),d=v("el-descriptions-item"),y=v("el-descriptions"),u=v("el-table-column"),g=v("el-table"),k=v("el-col"),R=v("el-row"),de=v("el-text"),ae=v("el-tab-pane"),re=v("el-button"),Re=v("el-button-group"),fe=v("el-skeleton"),ce=v("el-empty"),Le=v("el-tabs"),Oe=he("loading");return c(),V("div",et,[f("div",tt,[o(p,{class:"left-panel"},{header:s(()=>[...e[5]||(e[5]=[f("div",{class:"card-header"},[f("span",null,"ETF分类树状图")],-1)])]),default:s(()=>[f("div",at,[f("div",nt,[o(t,{modelValue:O.value,"onUpdate:modelValue":e[0]||(e[0]=D=>O.value=D),clearable:"",size:"small",placeholder:"筛选节点（模糊匹配名称/代码/管理人）"},null,8,["modelValue"])]),o(i,{ref_key:"treeRef",ref:N,props:Y,load:Te,lazy:"","node-key":"key","highlight-current":"","filter-node-method":te,onNodeClick:ke,onNodeExpand:Ee},{default:s(({node:D,data:q})=>[f("span",lt,[f("span",ot,E(D.label),1),f("span",st,[q.nodeType==="TYPE"?(c(),_(a,{key:0,size:"small",type:"primary",effect:"plain"},{default:s(()=>[m(E(q.etf_type),1)]),_:2},1024)):q.nodeType==="INDEX"?(c(),_(a,{key:1,size:"small",type:"warning",effect:"plain"},{default:s(()=>[...e[6]||(e[6]=[m(" 指数 ",-1)])]),_:1})):q.nodeType==="CAT"?(c(),_(a,{key:2,size:"small",type:"info",effect:"plain"},{default:s(()=>[...e[7]||(e[7]=[m(" 指数类别 ",-1)])]),_:1})):q.nodeType==="MGR"?(c(),_(a,{key:3,size:"small",type:"info",effect:"plain"},{default:s(()=>[...e[8]||(e[8]=[m(" 基金管理人 ",-1)])]),_:1})):q.nodeType==="ETF"?(c(),_(a,{key:4,size:"small",type:"success",effect:"plain"},{default:s(()=>[...e[9]||(e[9]=[m(" ETF ",-1)])]),_:1})):$("",!0)])])]),_:1},512)])]),_:1}),o(p,{class:"right-panel"},{header:s(()=>[...e[10]||(e[10]=[f("div",{class:"card-header"},[f("span",null,"详情信息")],-1)])]),default:s(()=>[n.value?(c(),V("div",it,[o(Le,{modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=D=>h.value=D),class:"detail-tabs"},{default:s(()=>[o(ae,{label:"基本信息",name:"basic"},{default:s(()=>[f("div",dt,[o(y,{column:1,border:""},{default:s(()=>[o(d,{label:"类型"},{default:s(()=>[n.value.nodeType==="TYPE"?(c(),_(a,{key:0,type:"primary"},{default:s(()=>[...e[11]||(e[11]=[m("ETF类型",-1)])]),_:1})):n.value.nodeType==="INDEX"?(c(),_(a,{key:1,type:"warning"},{default:s(()=>[...e[12]||(e[12]=[m("基准指数",-1)])]),_:1})):n.value.nodeType==="CAT"?(c(),_(a,{key:2,type:"info"},{default:s(()=>[...e[13]||(e[13]=[m("指数类别",-1)])]),_:1})):n.value.nodeType==="MGR"?(c(),_(a,{key:3,type:"info"},{default:s(()=>[...e[14]||(e[14]=[m("基金管理人",-1)])]),_:1})):n.value.nodeType==="ETF"?(c(),_(a,{key:4,type:"success"},{default:s(()=>[...e[15]||(e[15]=[m("ETF",-1)])]),_:1})):(c(),_(a,{key:5,type:"info"},{default:s(()=>[...e[16]||(e[16]=[m("根",-1)])]),_:1}))]),_:1}),o(d,{label:"名称"},{default:s(()=>[f("span",rt,E(n.value.label),1)]),_:1}),n.value.etf_type?(c(),_(d,{key:0,label:"ETF类型"},{default:s(()=>[o(a,null,{default:s(()=>[m(E(n.value.etf_type),1)]),_:1})]),_:1})):$("",!0),n.value.index_code?(c(),_(d,{key:1,label:"指数代码"},{default:s(()=>[o(a,{type:"warning"},{default:s(()=>[m(E(n.value.index_code),1)]),_:1})]),_:1})):$("",!0),n.value.index_name?(c(),_(d,{key:2,label:"指数名称"},{default:s(()=>[m(E(n.value.index_name),1)]),_:1})):$("",!0),n.value.mgr_name?(c(),_(d,{key:3,label:"基金管理人"},{default:s(()=>[m(E(n.value.mgr_name),1)]),_:1})):$("",!0),n.value.nodeType==="ETF"&&n.value.item?(c(),V(ue,{key:4},[o(d,{label:"交易代码"},{default:s(()=>[o(a,{type:"success"},{default:s(()=>[m(E(n.value.item.ts_code),1)]),_:1})]),_:1}),o(d,{label:"简称"},{default:s(()=>[m(E(n.value.item.csname||n.value.item.extname),1)]),_:1}),o(d,{label:"交易所"},{default:s(()=>[m(E(n.value.item.exchange),1)]),_:1}),o(d,{label:"管理人"},{default:s(()=>[m(E(n.value.item.mgr_name),1)]),_:1}),o(d,{label:"上市状态"},{default:s(()=>[m(E(n.value.item.list_status),1)]),_:1}),o(d,{label:"上市日期"},{default:s(()=>[m(E(n.value.item.list_date||"--"),1)]),_:1})],64)):$("",!0)]),_:1}),X.value.length>0?(c(),V("div",ct,[f("div",ut,[f("span",null,"下级列表 ("+E(X.value.length)+")",1)]),n.value.nodeType==="TYPE"?(c(),_(g,{key:0,data:Ne.value,style:{width:"100%"},height:"300",border:"",stripe:"",size:"small"},{default:s(()=>[o(u,{prop:"mgr_name",label:"基金管理人","min-width":"220","show-overflow-tooltip":""}),o(u,{prop:"count",label:"ETF数量",width:"100",align:"center"})]),_:1},8,["data"])):n.value.nodeType==="MGR"?(c(),V(ue,{key:1},[o(g,{data:Ce.value,style:{width:"100%"},height:"300",border:"",stripe:"",size:"small"},{default:s(()=>[o(u,{prop:"index_code",label:"指数代码",width:"160"}),o(u,{prop:"index_name",label:"指数名称","min-width":"220","show-overflow-tooltip":""}),o(u,{prop:"count",label:"ETF数量",width:"100",align:"center"})]),_:1},8,["data"]),e[17]||(e[17]=f("div",{class:"section-header"},"指数类别分布",-1)),o(R,{gutter:20,class:"mt-10"},{default:s(()=>[o(k,{span:10},{default:s(()=>[o(g,{data:me.value,style:{width:"100%"},height:"260",border:"",stripe:"",size:"small"},{default:s(()=>[o(u,{prop:"category",label:"类别","min-width":"160","show-overflow-tooltip":""}),o(u,{prop:"count",label:"数量",width:"100",align:"center"})]),_:1},8,["data"])]),_:1}),o(k,{span:14},{default:s(()=>[f("div",{ref_key:"categoryChartRef",ref:M,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1})],64)):n.value.nodeType==="CAT"?(c(),_(g,{key:2,data:De.value,style:{width:"100%"},height:"300",border:"",stripe:"",size:"small"},{default:s(()=>[o(u,{prop:"index_code",label:"指数代码",width:"160"}),o(u,{prop:"index_name",label:"指数名称","min-width":"220","show-overflow-tooltip":""}),o(u,{prop:"count",label:"ETF数量",width:"100",align:"center"})]),_:1},8,["data"])):n.value.nodeType==="INDEX"?(c(),_(g,{key:3,data:Fe.value,style:{width:"100%"},height:"360",border:"",stripe:"",size:"small"},{default:s(()=>[o(u,{prop:"ts_code",label:"交易代码",width:"140",align:"center"}),o(u,{prop:"csname",label:"ETF简称","min-width":"220","show-overflow-tooltip":""}),o(u,{prop:"extname",label:"扩位简称","min-width":"160","show-overflow-tooltip":""}),o(u,{prop:"exchange",label:"交易所",width:"100",align:"center"}),o(u,{prop:"mgr_name",label:"管理人","min-width":"160","show-overflow-tooltip":""}),o(u,{prop:"list_status",label:"上市状态",width:"100",align:"center"}),o(u,{prop:"list_date",label:"上市日期",width:"120",align:"center"})]),_:1},8,["data"])):$("",!0)])):n.value.nodeType!=="ETF"?(c(),V("div",pt,[o(de,{type:"info"},{default:s(()=>[...e[18]||(e[18]=[m("暂无已展开的下级节点，请在左侧点击展开",-1)])]),_:1})])):$("",!0)])]),_:1}),n.value.nodeType==="ETF"?(c(),_(ae,{key:0,label:"趋势图",name:"trend"},{default:s(()=>[f("div",mt,[f("div",_t,[e[22]||(e[22]=f("span",{style:{"align-self":"center",color:"#606266","font-size":"13px"}},"日期范围",-1)),o(Re,null,{default:s(()=>[o(re,{type:z.value==="1y"?"primary":"default",size:"small",onClick:e[1]||(e[1]=D=>z.value="1y")},{default:s(()=>[...e[19]||(e[19]=[m("一年",-1)])]),_:1},8,["type"]),o(re,{type:z.value==="3y"?"primary":"default",size:"small",onClick:e[2]||(e[2]=D=>z.value="3y")},{default:s(()=>[...e[20]||(e[20]=[m("三年",-1)])]),_:1},8,["type"]),o(re,{type:z.value==="5y"?"primary":"default",size:"small",onClick:e[3]||(e[3]=D=>z.value="5y")},{default:s(()=>[...e[21]||(e[21]=[m("五年",-1)])]),_:1},8,["type"])]),_:1})]),U.value?(c(),V("div",ft,[o(fe,{rows:8,animated:""})])):(c(),V("div",yt,[ee.value.length>0&&n.value?.item?(c(),_(ve,{key:0,"stock-code":n.value.item.ts_code,"stock-name":n.value.item.csname||n.value.item.extname,"kline-data":ee.value,height:"420px"},null,8,["stock-code","stock-name","kline-data"])):(c(),_(ce,{key:1,description:"暂无趋势数据"}))]))])]),_:1})):$("",!0),n.value.nodeType==="INDEX"?(c(),_(ae,{key:1,label:"成分与权重",name:"weights"},{default:s(()=>[f("div",vt,[be((c(),_(g,{data:H.value,"element-loading-text":"加载指数成分权重...",style:{width:"100%"},height:"360",border:"",stripe:"",size:"small"},{default:s(()=>[o(u,{label:"成分代码",width:"140",align:"center"},{default:s(D=>[f("span",null,E(D.row.base_code),1)]),_:1}),o(u,{label:"成分名称","min-width":"200","show-overflow-tooltip":""},{default:s(D=>[f("span",null,E(D.row.stock_name||D.row.con_name),1)]),_:1}),o(u,{prop:"weight",label:"权重(%)",width:"120",align:"right"},{default:s(D=>[f("span",null,E($e(D.row.weight)),1)]),_:1}),o(u,{prop:"trade_date",label:"交易日期",width:"120",align:"center"})]),_:1},8,["data"])),[[Oe,B.value]]),e[23]||(e[23]=f("div",{class:"section-header",style:{"margin-top":"10px"}},"成分行业分布",-1)),f("div",{ref_key:"industryChartRef",ref:L,style:{width:"100%",height:"280px"}},null,512)])]),_:1})):$("",!0),n.value.nodeType==="CAT"?(c(),_(ae,{key:2,label:"波动性分析",name:"cat-volatility"},{default:s(()=>[f("div",gt,[o(Je,{"etf-codes":Ie.value,"code-name-map":Se.value},null,8,["etf-codes","code-name-map"])])]),_:1})):$("",!0),n.value.nodeType==="INDEX"?(c(),_(ae,{key:3,label:"趋势图",name:"index-trend"},{default:s(()=>[f("div",wt,[W.value?(c(),V("div",bt,[o(fe,{rows:8,animated:""})])):(c(),V("div",ht,[T.value.length>0&&n.value?.index_code?(c(),_(ve,{key:0,"stock-code":n.value.index_code,"stock-name":n.value.index_name||n.value.index_code,"kline-data":T.value,height:"420px"},null,8,["stock-code","stock-name","kline-data"])):(c(),_(ce,{key:1,description:"暂无指数趋势数据"}))]))])]),_:1})):$("",!0)]),_:1},8,["modelValue"])])):(c(),V("div",xt,[o(ce,{description:"请选择左侧节点查看详情"})]))]),_:1})])])}}}),It=xe(Tt,[["__scopeId","data-v-3ca999ae"]]);export{It as default};
