import{x as N,d as U,a as m,r as $,y as j,c as V,e as t,b as i,w as a,i as s,E as R,k as y,D as q,G as A,f as k,F as G,A as L,t as O,o as g,_ as T}from"./index-CPDmQmJM.js";async function z(r){return(await N.get("/django/api/tasks/index-dailybasic/",{params:{ts_code:r.tsCode,start_date:r.startDate,end_date:r.endDate,trade_date:r.tradeDate,fields:r.fields}})).data}const J={class:"index-dailybasic-view"},K={class:"header-content"},P={class:"actions"},Q={class:"search-section"},W={class:"table-section"},X={class:"card-header"},Z=U({__name:"IndexDailybasicView",emits:["loaded"],setup(r,{emit:b}){const x=b,p=m(!1),l=$({tsCode:"000001.SH",fields:""}),u=m(),_=m([]),w=m([]),h=m(0);function D(c=30){const e=new Date,n=new Date(Date.now()-c*24*60*60*1e3),f=d=>`${d.getFullYear()}${String(d.getMonth()+1).padStart(2,"0")}${String(d.getDate()).padStart(2,"0")}`;return[f(n),f(e)]}async function v(){try{p.value=!0;const[c,e]=u.value||D(),n=await z({tsCode:l.tsCode,startDate:c,endDate:e,fields:l.fields||void 0});_.value=n.records||[],w.value=_.value.length?Object.keys(_.value[0]):[],h.value=n.count||_.value.length,x("loaded",h.value)}catch(c){R.error(c?.message||"数据加载失败")}finally{p.value=!1}}function S(){v()}function M(){v()}function Y(){l.tsCode="000001.SH",l.fields="",u.value=D(),v()}return j(()=>{u.value=D(),v()}),(c,e)=>{const n=s("el-button"),f=s("el-input"),d=s("el-form-item"),B=s("el-date-picker"),F=s("el-form"),C=s("el-card"),I=s("el-table-column"),E=s("el-table"),H=A("loading");return g(),V("div",J,[t(C,{class:"page-header",shadow:"hover"},{header:a(()=>[i("div",K,[e[5]||(e[5]=i("h2",null,"指数每日基础指标",-1)),i("div",P,[t(n,{type:"primary",loading:p.value,onClick:S},{default:a(()=>[...e[3]||(e[3]=[y("查询",-1)])]),_:1},8,["loading"]),t(n,{onClick:Y},{default:a(()=>[...e[4]||(e[4]=[y("重置",-1)])]),_:1})])])]),default:a(()=>[i("div",Q,[t(F,{inline:!0,model:l,class:"query-form"},{default:a(()=>[t(d,{label:"指数代码"},{default:a(()=>[t(f,{modelValue:l.tsCode,"onUpdate:modelValue":e[0]||(e[0]=o=>l.tsCode=o),placeholder:"例如 000001.SH",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),t(d,{label:"日期范围"},{default:a(()=>[t(B,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=o=>u.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),t(d,{label:"字段"},{default:a(()=>[t(f,{modelValue:l.fields,"onUpdate:modelValue":e[2]||(e[2]=o=>l.fields=o),placeholder:"可选，逗号分隔，留空为默认字段",style:{width:"320px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1}),i("div",W,[t(C,null,{header:a(()=>[i("div",X,[i("span",null,"数据列表（"+O(h.value)+" 条）",1),t(n,{link:"",onClick:M},{default:a(()=>[...e[6]||(e[6]=[y("刷新",-1)])]),_:1})])]),default:a(()=>[q((g(),k(E,{data:_.value,style:{width:"100%"},height:"560"},{default:a(()=>[(g(!0),V(G,null,L(w.value,o=>(g(),k(I,{key:o,prop:o,label:o,"show-overflow-tooltip":""},null,8,["prop","label"]))),128))]),_:1},8,["data"])),[[H,p.value]])]),_:1})])])}}}),te=T(Z,[["__scopeId","data-v-f7069efa"]]);export{te as default};
