import{f as u,g as i,a as $,S as E,b as q,c as A}from"./stockHistoryApi-CcP5F4Xu.js";import{d as H,r as x,a as v,y as j,c as h,b as r,e as a,w as s,i as d,E as k,f as T,g as z,F as G,A as J,k as L,t as p,o as m,_ as O}from"./index-B9GPqjFv.js";import"./index-ElshY9iF.js";const P={class:"stock-kline-view"},Q={class:"control-panel"},W={key:0,class:"chart-container"},X={class:"card-header"},Z={class:"stock-info"},ee={key:1,class:"empty-state"},te=H({__name:"StockKLineView",setup(ae){const t=x({stockCode:"",stockName:"",dateRangeType:"month",startDate:"",endDate:""}),_=v([]),l=x({code:"",name:"",industry:"",listDate:"",totalMarketCap:0,circulatingMarketCap:0}),g=v([]),D=v(!1),N=o=>{const e=g.value.find(n=>n.code===o);e&&(t.stockCode=e.code,t.stockName=e.name,R(e.code))},R=async o=>{try{const e=await q(o);l.code=e.code,l.name=e.name,l.industry=e.industry,l.listDate=e.list_date,l.totalMarketCap=e.total_market_cap,l.circulatingMarketCap=e.circulating_market_cap}catch(e){console.error("获取股票详细信息失败:",e),k.error("获取股票详细信息失败")}},b=()=>{const e=u(new Date);switch(t.endDate=e,t.dateRangeType){case"week":t.startDate=u(i(7));break;case"month":t.startDate=u(i(30));break;case"threeMonths":t.startDate=u(i(90));break;case"sixMonths":t.startDate=u(i(180));break;case"year":t.startDate=u(i(365));break;case"threeYears":t.startDate=u(i(365*3));break;case"all":t.startDate="";break}},F=async()=>{if(!t.stockCode){k.warning("请选择股票");return}D.value=!0;try{let o=t.startDate,e=t.endDate;o&&(o=o.replace(/-/g,"")),e&&(e=e.replace(/-/g,""));const n=await A(t.stockCode,o,e);_.value=n,n.length===0&&k.warning("未查询到股票历史数据")}catch(o){console.error("获取股票数据失败:",o),k.error("获取股票数据失败")}finally{D.value=!1}},K=()=>{t.stockCode="",t.stockName="",t.dateRangeType="month",t.startDate="",t.endDate="",_.value=[],l.code="",l.name="",l.industry="",l.listDate="",l.totalMarketCap=0,l.circulatingMarketCap=0},C=o=>o?o>=1e8?`${(o/1e8).toFixed(2)}亿`:o>=1e4?`${(o/1e4).toFixed(2)}万`:o.toString():"未知",I=async()=>{try{D.value=!0;const{data:o}=await $(1,100);g.value=o}catch(o){console.error("加载股票列表失败:",o),k.error("加载股票列表失败")}finally{D.value=!1}};return j(()=>{b(),I()}),(o,e)=>{const n=d("el-option"),M=d("el-select"),f=d("el-form-item"),y=d("el-col"),w=d("el-row"),Y=d("el-date-picker"),V=d("el-button"),B=d("el-form"),S=d("el-card"),U=d("el-empty");return m(),h("div",P,[e[7]||(e[7]=r("div",{class:"page-header"},[r("h1",null,"股票K线图分析"),r("p",null,"查看个股历史K线数据，支持技术指标分析")],-1)),r("div",Q,[a(S,null,{header:s(()=>[...e[4]||(e[4]=[r("div",{class:"card-header"},[r("span",null,"查询条件")],-1)])]),default:s(()=>[a(B,{model:t,"label-width":"100px",class:"query-form"},{default:s(()=>[a(w,{gutter:20},{default:s(()=>[a(y,{span:8},{default:s(()=>[a(f,{label:"股票代码"},{default:s(()=>[a(M,{modelValue:t.stockCode,"onUpdate:modelValue":e[0]||(e[0]=c=>t.stockCode=c),placeholder:"请选择股票",class:"full-width",onChange:N},{default:s(()=>[(m(!0),h(G,null,J(g.value,c=>(m(),T(n,{key:c.code,label:`${c.code} ${c.name}`,value:c.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(y,{span:8},{default:s(()=>[a(f,{label:"时间范围"},{default:s(()=>[a(M,{modelValue:t.dateRangeType,"onUpdate:modelValue":e[1]||(e[1]=c=>t.dateRangeType=c),onChange:b,class:"full-width"},{default:s(()=>[a(n,{label:"最近一周",value:"week"}),a(n,{label:"最近一月",value:"month"}),a(n,{label:"最近三月",value:"threeMonths"}),a(n,{label:"最近六月",value:"sixMonths"}),a(n,{label:"最近一年",value:"year"}),a(n,{label:"最近三年",value:"threeYears"}),a(n,{label:"全部",value:"all"}),a(n,{label:"自定义",value:"custom"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t.dateRangeType==="custom"?(m(),T(w,{key:0,gutter:20},{default:s(()=>[a(y,{span:8},{default:s(()=>[a(f,{label:"开始日期"},{default:s(()=>[a(Y,{modelValue:t.startDate,"onUpdate:modelValue":e[2]||(e[2]=c=>t.startDate=c),type:"date",placeholder:"选择开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",class:"full-width"},null,8,["modelValue"])]),_:1})]),_:1}),a(y,{span:8},{default:s(()=>[a(f,{label:"结束日期"},{default:s(()=>[a(Y,{modelValue:t.endDate,"onUpdate:modelValue":e[3]||(e[3]=c=>t.endDate=c),type:"date",placeholder:"选择结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",class:"full-width"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):z("",!0),a(f,null,{default:s(()=>[a(V,{type:"primary",onClick:F},{default:s(()=>[...e[5]||(e[5]=[L("查询",-1)])]),_:1}),a(V,{onClick:K},{default:s(()=>[...e[6]||(e[6]=[L("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_.value.length>0?(m(),h("div",W,[a(S,null,{header:s(()=>[r("div",X,[r("span",null,p(l.name)+"("+p(l.code)+") K线图",1),r("div",Z,[r("span",null,"行业: "+p(l.industry||"未知"),1),r("span",null,"上市日期: "+p(l.listDate||"未知"),1),r("span",null,"总市值: "+p(C(l.totalMarketCap)),1),r("span",null,"流通市值: "+p(C(l.circulatingMarketCap)),1)])])]),default:s(()=>[a(E,{"stock-code":l.code,"stock-name":l.name,"kline-data":_.value,height:"600px","show-volume":!0},null,8,["stock-code","stock-name","kline-data"])]),_:1})])):(m(),h("div",ee,[a(U,{description:"请选择股票并查询数据"})]))])}}}),ne=O(te,[["__scopeId","data-v-7cce85c9"]]);export{ne as default};
