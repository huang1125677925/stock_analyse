import{x as D,d as $,a as h,y as G,E as S,z as O,c,e as l,w as t,i as _,F as g,A as b,f as v,b as w,l as B,M as q,k as P,O as H,D as J,G as K,t as Q,o,_ as W}from"./index-CTG2XoSg.js";const X=n=>{const a=f=>f?f.map(([u,x])=>({value:u,label:x})):[];return{pattern_types:a(n.pattern_types),technical_indicator_types:a(n.technical_indicator_types),stock_types:a(n.stock_types),market_cap_types:a(n.market_cap_types),pe_range_types:a(n.pe_range_types),pb_range_types:a(n.pb_range_types),industry_types:a(n.industry_types),volume_types:a(n.volume_types),volatility_types:a(n.volatility_types),trend_types:a(n.trend_types)}},E="/django/api/individual_stock/stock-tags",Z=async(n={})=>(await D.get(`${E}/`,{params:{page:n.page??1,page_size:n.page_size??20,stock_codes:n.stock_codes,pattern_types:n.pattern_types,technical_indicator_types:n.technical_indicator_types,stock_types:n.stock_types,market_cap_types:n.market_cap_types,pe_range_types:n.pe_range_types,pb_range_types:n.pb_range_types,industry_types:n.industry_types,volume_types:n.volume_types,volatility_types:n.volatility_types,trend_types:n.trend_types,start_date:n.start_date,end_date:n.end_date}})).data,ee=async()=>{const n=await D.get(`${E}/choices/`);return{code:n.code,message:n.message,timestamp:n.timestamp,data:X(n.data||{})}},le={class:"factor-stock-picker-view"},te={class:"card-header"},ae={class:"result-header"},se={class:"pagination-bar"},ne=$({__name:"FactorStockPickerView",setup(n){const a=h({pattern_types:[],technical_indicator_types:[],market_cap_types:[],pe_range_types:[],pb_range_types:[],industry_types:[],volume_types:[],volatility_types:[],trend_types:[],page:1,page_size:20}),f=h(null),u=h({pattern_types:[],technical_indicator_types:[],stock_types:[],market_cap_types:[],pe_range_types:[],pb_range_types:[],industry_types:[],volume_types:[],volatility_types:[],trend_types:[]}),x=h([]),V=h({total:0,page:1,page_size:20,total_pages:0}),k=h(!1),z=async()=>{k.value=!0;try{const p={...a.value,start_date:f.value?.[0],end_date:f.value?.[1]},s=await Z(p);console.log(s),x.value=s.data,V.value={total:s.total,page:s.page,page_size:s.page_size,total_pages:s.total_pages}}catch{S.error("获取股票列表失败")}finally{k.value=!1}},F=()=>{a.value={pattern_types:[],technical_indicator_types:[],market_cap_types:[],pe_range_types:[],pb_range_types:[],industry_types:[],volume_types:[],volatility_types:[],trend_types:[],page:1,page_size:20},f.value=null},M=async p=>{a.value.page=p,await z()},Y=async p=>{a.value.page_size=p,a.value.page=1,await z()};return G(async()=>{k.value=!0;try{const p=await ee();u.value=p.data,await z()}catch{S.error("初始化因子选项失败")}finally{k.value=!1}}),O(()=>{const p=a.value;return[p.pattern_types,p.technical_indicator_types,p.market_cap_types,p.pe_range_types,p.pb_range_types,p.industry_types,p.volume_types,p.volatility_types,p.trend_types].reduce((C,d)=>C+(d?.length||0),0)}),(p,s)=>{const C=_("el-button"),d=_("el-option"),m=_("el-select"),i=_("el-form-item"),y=_("el-col"),A=_("el-date-picker"),I=_("el-row"),L=_("el-form"),U=_("el-card"),N=_("el-text"),r=_("el-table-column"),T=_("el-table"),j=_("el-pagination"),R=K("loading");return o(),c("div",le,[l(U,{class:"filter-card",shadow:"hover"},{header:t(()=>[w("div",te,[s[12]||(s[12]=w("span",null,"因子选股",-1)),l(C,{type:"primary",icon:B(q),loading:k.value,onClick:z},{default:t(()=>[...s[10]||(s[10]=[P("查询",-1)])]),_:1},8,["icon","loading"]),l(C,{icon:B(H),onClick:F},{default:t(()=>[...s[11]||(s[11]=[P("重置",-1)])]),_:1},8,["icon"])])]),default:t(()=>[l(L,{"label-width":"120px",model:a.value,class:"filter-form"},{default:t(()=>[l(I,{gutter:12},{default:t(()=>[l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"形态类型"},{default:t(()=>[l(m,{modelValue:a.value.pattern_types,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value.pattern_types=e),multiple:"",clearable:"",filterable:"",placeholder:"选择形态类型"},{default:t(()=>[(o(!0),c(g,null,b(u.value.pattern_types,e=>(o(),v(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"技术指标"},{default:t(()=>[l(m,{modelValue:a.value.technical_indicator_types,"onUpdate:modelValue":s[1]||(s[1]=e=>a.value.technical_indicator_types=e),multiple:"",clearable:"",filterable:"",placeholder:"选择技术指标"},{default:t(()=>[(o(!0),c(g,null,b(u.value.technical_indicator_types,e=>(o(),v(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"市值类型"},{default:t(()=>[l(m,{modelValue:a.value.market_cap_types,"onUpdate:modelValue":s[2]||(s[2]=e=>a.value.market_cap_types=e),multiple:"",clearable:"",filterable:"",placeholder:"选择市值类型"},{default:t(()=>[(o(!0),c(g,null,b(u.value.market_cap_types,e=>(o(),v(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"PE区间"},{default:t(()=>[l(m,{modelValue:a.value.pe_range_types,"onUpdate:modelValue":s[3]||(s[3]=e=>a.value.pe_range_types=e),multiple:"",clearable:"",filterable:"",placeholder:"选择PE区间"},{default:t(()=>[(o(!0),c(g,null,b(u.value.pe_range_types,e=>(o(),v(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"PB区间"},{default:t(()=>[l(m,{modelValue:a.value.pb_range_types,"onUpdate:modelValue":s[4]||(s[4]=e=>a.value.pb_range_types=e),multiple:"",clearable:"",filterable:"",placeholder:"选择PB区间"},{default:t(()=>[(o(!0),c(g,null,b(u.value.pb_range_types,e=>(o(),v(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"行业类型"},{default:t(()=>[l(m,{modelValue:a.value.industry_types,"onUpdate:modelValue":s[5]||(s[5]=e=>a.value.industry_types=e),multiple:"",clearable:"",filterable:"",placeholder:"选择行业类型"},{default:t(()=>[(o(!0),c(g,null,b(u.value.industry_types,e=>(o(),v(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"成交量"},{default:t(()=>[l(m,{modelValue:a.value.volume_types,"onUpdate:modelValue":s[6]||(s[6]=e=>a.value.volume_types=e),multiple:"",clearable:"",filterable:"",placeholder:"选择成交量类型"},{default:t(()=>[(o(!0),c(g,null,b(u.value.volume_types,e=>(o(),v(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"波动率"},{default:t(()=>[l(m,{modelValue:a.value.volatility_types,"onUpdate:modelValue":s[7]||(s[7]=e=>a.value.volatility_types=e),multiple:"",clearable:"",filterable:"",placeholder:"选择波动率类型"},{default:t(()=>[(o(!0),c(g,null,b(u.value.volatility_types,e=>(o(),v(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"趋势类型"},{default:t(()=>[l(m,{modelValue:a.value.trend_types,"onUpdate:modelValue":s[8]||(s[8]=e=>a.value.trend_types=e),multiple:"",clearable:"",filterable:"",placeholder:"选择趋势类型"},{default:t(()=>[(o(!0),c(g,null,b(u.value.trend_types,e=>(o(),v(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{xs:24,sm:12,md:12,lg:8},{default:t(()=>[l(i,{label:"创建时间"},{default:t(()=>[l(A,{modelValue:f.value,"onUpdate:modelValue":s[9]||(s[9]=e=>f.value=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD","unlink-panels":"",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(U,{class:"result-card",shadow:"never"},{header:t(()=>[w("div",ae,[s[13]||(s[13]=w("span",null,"结果列表",-1)),l(N,{type:"info"},{default:t(()=>[P("共 "+Q(V.value.total)+" 条",1)]),_:1})])]),default:t(()=>[J((o(),v(T,{data:x.value,stripe:"",border:""},{default:t(()=>[l(r,{prop:"stock_code",label:"股票代码",width:"120"}),l(r,{prop:"stock_name",label:"股票名称","min-width":"140"}),l(r,{prop:"pattern_type_display",label:"形态","min-width":"140"}),l(r,{prop:"technical_indicator_type_display",label:"技术指标","min-width":"160"}),l(r,{prop:"market_cap_type_display",label:"市值","min-width":"160"}),l(r,{prop:"pe_range_type_display",label:"PE区间","min-width":"140"}),l(r,{prop:"pb_range_type_display",label:"PB区间","min-width":"140"}),l(r,{prop:"industry_type_display",label:"行业","min-width":"140"}),l(r,{prop:"volume_type_display",label:"成交量","min-width":"140"}),l(r,{prop:"volatility_type_display",label:"波动率","min-width":"140"}),l(r,{prop:"trend_type_display",label:"趋势","min-width":"140"}),l(r,{prop:"created_at",label:"创建时间",width:"200"})]),_:1},8,["data"])),[[R,k.value]]),w("div",se,[l(j,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:V.value.total,"page-sizes":[10,20,50,100],"page-size":V.value.page_size,"current-page":V.value.page,onSizeChange:Y,onCurrentChange:M},null,8,["total","page-size","current-page"])])]),_:1})])}}}),oe=W(ne,[["__scopeId","data-v-1af79b18"]]);export{oe as default};
