import{d as J,a as y,r as oe,B as Q,y as ee,c as S,e,i,w as a,b as w,f as X,g as ne,l as W,M as ae,k as g,t as p,L as M,E as U,o as v,_ as Z,z as q,D as de,G as _e,H as te,Y as le,j as ue,F as pe,A as me,N as ge,Q as he,O as fe,u as ye}from"./index-B1jknyhk.js";import{e as be,f as ve,h as we,a as ke,i as Ce,g as De}from"./individualStockApi-zHq7wJlW.js";import{i as re}from"./index-ElshY9iF.js";import{H as Le}from"./HeatmapChart-jp61x8vl.js";import{b as Se}from"./strategyApi-DPA8D408.js";const Ie={class:"balance-sheet-table"},xe={class:"filter-section"},Ae={key:1,class:"pagination-container"},Ee={key:2,class:"loading-container"},Re={key:3,class:"empty-container"},Ne=J({__name:"BalanceSheetTable",props:{stockCode:{}},emits:["loading","error"],setup(G,{emit:_}){const D=G,d=_,f=y(!1),m=y([]),k=y(0),r=y(1),E=y(20),I=y(""),L=oe({page:1,page_size:20,date:""}),C=async()=>{if(!D.stockCode){U.warning("请提供股票代码");return}f.value=!0,d("loading",!0);try{L.page=r.value,L.page_size=E.value;const t=await be(D.stockCode,L);m.value=t.data,console.log("资产负债表数据:",t),k.value=t.data.length,t.data.length===0&&U.info("暂无资产负债表数据")}catch(t){console.error("获取资产负债表数据失败:",t);const l="获取资产负债表数据失败，请稍后重试";U.error(l),d("error",l)}finally{f.value=!1,d("loading",!1)}},F=({prop:t,order:l})=>{console.log("排序变化:",t,l)},P=t=>{E.value=t,r.value=1,C()},V=t=>{r.value=t,C()},h=t=>t==null?"-":t>=1e8?(t/1e8).toFixed(2)+"亿":t>=1e4?(t/1e4).toFixed(2)+"万":t.toString(),z=t=>t==null?"":t>0?"growth-positive":t<0?"growth-negative":"",A=()=>{},s=()=>{I.value=""};return Q(()=>D.stockCode,t=>{t&&(r.value=1,C())}),ee(()=>{D.stockCode&&C()}),(t,l)=>{const x=i("el-icon"),H=i("el-input"),N=i("el-col"),T=i("el-button"),$=i("el-row"),n=i("el-table-column"),c=i("el-table"),b=i("el-pagination"),R=i("el-skeleton"),O=i("el-empty"),u=i("el-card");return v(),S("div",Ie,[e(u,null,{default:a(()=>[w("div",xe,[e($,{gutter:20,align:"middle"},{default:a(()=>[e(N,{span:8},{default:a(()=>[e(H,{modelValue:I.value,"onUpdate:modelValue":l[0]||(l[0]=o=>I.value=o),placeholder:"输入报告期进行筛选（如：2023、2023-12）",clearable:"",onInput:A},{prefix:a(()=>[e(x,null,{default:a(()=>[e(W(ae))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(N,{span:4},{default:a(()=>[e(T,{onClick:s},{default:a(()=>[...l[2]||(l[2]=[g("清除筛选",-1)])]),_:1})]),_:1})]),_:1})]),!f.value&&m.value.length>0?(v(),X(c,{key:0,data:m.value,border:"",stripe:"",style:{width:"100%"},height:"500",onSortChange:F},{default:a(()=>[e(n,{prop:"report_date",label:"报告期",width:"120",sortable:""}),e(n,{prop:"monetary_funds",label:"货币资金","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.monetary_funds)),1)]),_:1}),e(n,{prop:"accounts_receivable",label:"应收账款","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.accounts_receivable)),1)]),_:1}),e(n,{prop:"inventory",label:"存货","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.inventory)),1)]),_:1}),e(n,{prop:"total_assets",label:"总资产","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.total_assets)),1)]),_:1}),e(n,{prop:"total_assets_growth_rate",label:"总资产增长率","min-width":"120",sortable:""},{default:a(o=>[w("span",{class:M(z(o.row.total_assets_growth_rate))},p(o.row.total_assets_growth_rate?o.row.total_assets_growth_rate.toFixed(2)+"%":"-"),3)]),_:1}),e(n,{prop:"accounts_payable",label:"应付账款","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.accounts_payable)),1)]),_:1}),e(n,{prop:"total_liabilities",label:"总负债","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.total_liabilities)),1)]),_:1}),e(n,{prop:"total_liabilities_growth_rate",label:"总负债增长率","min-width":"120",sortable:""},{default:a(o=>[w("span",{class:M(z(o.row.total_liabilities_growth_rate))},p(o.row.total_liabilities_growth_rate?o.row.total_liabilities_growth_rate.toFixed(2)+"%":"-"),3)]),_:1}),e(n,{prop:"debt_to_asset_ratio",label:"资产负债率","min-width":"120",sortable:""},{default:a(o=>[g(p(o.row.debt_to_asset_ratio?o.row.debt_to_asset_ratio.toFixed(2)+"%":"-"),1)]),_:1}),e(n,{prop:"total_equity",label:"股东权益","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.total_equity)),1)]),_:1}),e(n,{prop:"announcement_date",label:"公告日期",width:"120"})]),_:1},8,["data"])):ne("",!0),!f.value&&m.value.length>0?(v(),S("div",Ae,[e(b,{"current-page":r.value,"onUpdate:currentPage":l[1]||(l[1]=o=>r.value=o),"page-size":E.value,total:k.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:P,onCurrentChange:V},null,8,["current-page","page-size","total"])])):f.value?(v(),S("div",Ee,[e(R,{rows:10,animated:""})])):(v(),S("div",Re,[e(O,{description:"暂无资产负债表数据"},{default:a(()=>[e(T,{type:"primary",onClick:C},{default:a(()=>[...l[3]||(l[3]=[g("刷新数据",-1)])]),_:1})]),_:1})]))]),_:1})])}}}),$e=Z(Ne,[["__scopeId","data-v-2d4da6cb"]]),ze={class:"income-statement-table"},Te={class:"filter-section"},Oe={key:1,class:"pagination-container"},Fe={key:2,class:"loading-container"},Pe={key:3,class:"empty-container"},Ve=J({__name:"IncomeStatementTable",props:{stockCode:{}},emits:["loading","error"],setup(G,{emit:_}){const D=G,d=_,f=y(!1),m=y([]),k=y(0),r=y(1),E=y(20),I=y(""),L=oe({page:1,page_size:20,date:""}),C=async()=>{if(!D.stockCode){U.warning("请提供股票代码");return}f.value=!0,d("loading",!0);try{L.page=r.value,L.page_size=E.value;const t=await ve(D.stockCode,L);m.value=t.data,k.value=t.data.length,t.data.length===0&&U.info("暂无利润表数据")}catch(t){console.error("获取利润表数据失败:",t);const l="获取利润表数据失败，请稍后重试";U.error(l),d("error",l)}finally{f.value=!1,d("loading",!1)}},F=({prop:t,order:l})=>{console.log("排序变化:",t,l)},P=t=>{E.value=t,r.value=1,C()},V=t=>{r.value=t,C()},h=t=>t==null?"-":t>=1e8?(t/1e8).toFixed(2)+"亿":t>=1e4?(t/1e4).toFixed(2)+"万":t.toString(),z=t=>t==null?"":t>0?"growth-positive":t<0?"growth-negative":"",A=()=>{},s=()=>{I.value=""};return Q(()=>D.stockCode,t=>{t&&(r.value=1,C())}),ee(()=>{D.stockCode&&C()}),(t,l)=>{const x=i("el-icon"),H=i("el-input"),N=i("el-col"),T=i("el-button"),$=i("el-row"),n=i("el-table-column"),c=i("el-table"),b=i("el-pagination"),R=i("el-skeleton"),O=i("el-empty"),u=i("el-card");return v(),S("div",ze,[e(u,null,{default:a(()=>[w("div",Te,[e($,{gutter:20,align:"middle"},{default:a(()=>[e(N,{span:8},{default:a(()=>[e(H,{modelValue:I.value,"onUpdate:modelValue":l[0]||(l[0]=o=>I.value=o),placeholder:"输入报告期进行筛选（如：2023、2023-12）",clearable:"",onInput:A},{prefix:a(()=>[e(x,null,{default:a(()=>[e(W(ae))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(N,{span:4},{default:a(()=>[e(T,{onClick:s},{default:a(()=>[...l[2]||(l[2]=[g("清除筛选",-1)])]),_:1})]),_:1})]),_:1})]),!f.value&&m.value.length>0?(v(),X(c,{key:0,data:m.value,border:"",stripe:"",style:{width:"100%"},height:"500",onSortChange:F},{default:a(()=>[e(n,{prop:"report_date",label:"报告期",width:"120",sortable:""}),e(n,{prop:"operating_revenue",label:"营业总收入","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.operating_revenue)),1)]),_:1}),e(n,{prop:"operating_revenue_growth_rate",label:"营业收入增长率","min-width":"130",sortable:""},{default:a(o=>[w("span",{class:M(z(o.row.operating_revenue_growth_rate))},p(o.row.operating_revenue_growth_rate?o.row.operating_revenue_growth_rate.toFixed(2)+"%":"-"),3)]),_:1}),e(n,{prop:"total_operating_expenses",label:"营业总成本","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.total_operating_expenses)),1)]),_:1}),e(n,{prop:"operating_expenses",label:"营业费用","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.operating_expenses)),1)]),_:1}),e(n,{prop:"sales_expenses",label:"销售费用","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.sales_expenses)),1)]),_:1}),e(n,{prop:"management_expenses",label:"管理费用","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.management_expenses)),1)]),_:1}),e(n,{prop:"financial_expenses",label:"财务费用","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.financial_expenses)),1)]),_:1}),e(n,{prop:"operating_profit",label:"营业利润","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.operating_profit)),1)]),_:1}),e(n,{prop:"total_profit",label:"利润总额","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.total_profit)),1)]),_:1}),e(n,{prop:"net_profit",label:"净利润","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.net_profit)),1)]),_:1}),e(n,{prop:"net_profit_growth_rate",label:"净利润增长率","min-width":"120",sortable:""},{default:a(o=>[w("span",{class:M(z(o.row.net_profit_growth_rate))},p(o.row.net_profit_growth_rate?o.row.net_profit_growth_rate.toFixed(2)+"%":"-"),3)]),_:1}),e(n,{prop:"announcement_date",label:"公告日期",width:"120"})]),_:1},8,["data"])):ne("",!0),!f.value&&m.value.length>0?(v(),S("div",Oe,[e(b,{"current-page":r.value,"onUpdate:currentPage":l[1]||(l[1]=o=>r.value=o),"page-size":E.value,total:k.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:P,onCurrentChange:V},null,8,["current-page","page-size","total"])])):f.value?(v(),S("div",Fe,[e(R,{rows:10,animated:""})])):(v(),S("div",Pe,[e(O,{description:"暂无利润表数据"},{default:a(()=>[e(T,{type:"primary",onClick:C},{default:a(()=>[...l[3]||(l[3]=[g("刷新数据",-1)])]),_:1})]),_:1})]))]),_:1})])}}}),He=Z(Ve,[["__scopeId","data-v-fbfffdc4"]]),Ge={class:"cash-flow-statement-table"},Me={class:"filter-section"},Ue={key:1,class:"pagination-container"},Be={key:2,class:"loading-container"},je={key:3,class:"empty-container"},Ke=J({__name:"CashFlowStatementTable",props:{stockCode:{}},emits:["loading","error"],setup(G,{emit:_}){const D=G,d=_,f=y(!1),m=y([]),k=y(0),r=y(1),E=y(20),I=y(""),L=oe({page:1,page_size:20,date:""}),C=async()=>{if(!D.stockCode){U.warning("请提供股票代码");return}f.value=!0,d("loading",!0);try{L.page=r.value,L.page_size=E.value;const t=await we(D.stockCode,L);m.value=t.data,k.value=t.data.length,t.data.length===0&&U.info("暂无现金流量表数据")}catch(t){console.error("获取现金流量表数据失败:",t);const l="获取现金流量表数据失败，请稍后重试";U.error(l),d("error",l)}finally{f.value=!1,d("loading",!1)}},F=({prop:t,order:l})=>{console.log("排序变化:",t,l)},P=t=>{E.value=t,r.value=1,C()},V=t=>{r.value=t,C()},h=t=>t==null?"-":Math.abs(t)>=1e8?(t/1e8).toFixed(2)+"亿":Math.abs(t)>=1e4?(t/1e4).toFixed(2)+"万":t.toString(),z=t=>t==null?"":t>0?"cash-flow-positive":t<0?"cash-flow-negative":"",A=()=>{},s=()=>{I.value=""};return Q(()=>D.stockCode,t=>{t&&(r.value=1,C())}),ee(()=>{D.stockCode&&C()}),(t,l)=>{const x=i("el-icon"),H=i("el-input"),N=i("el-col"),T=i("el-button"),$=i("el-row"),n=i("el-table-column"),c=i("el-table"),b=i("el-pagination"),R=i("el-skeleton"),O=i("el-empty"),u=i("el-card");return v(),S("div",Ge,[e(u,null,{default:a(()=>[w("div",Me,[e($,{gutter:20,align:"middle"},{default:a(()=>[e(N,{span:8},{default:a(()=>[e(H,{modelValue:I.value,"onUpdate:modelValue":l[0]||(l[0]=o=>I.value=o),placeholder:"输入报告期进行筛选（如：2023、2023-12）",clearable:"",onInput:A},{prefix:a(()=>[e(x,null,{default:a(()=>[e(W(ae))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(N,{span:4},{default:a(()=>[e(T,{onClick:s},{default:a(()=>[...l[2]||(l[2]=[g("清除筛选",-1)])]),_:1})]),_:1})]),_:1})]),!f.value&&m.value.length>0?(v(),X(c,{key:0,data:m.value,border:"",stripe:"",style:{width:"100%"},height:"500",onSortChange:F},{default:a(()=>[e(n,{prop:"report_date",label:"报告期",width:"120",sortable:""}),e(n,{prop:"operating_cash_flow",label:"经营活动现金流量净额","min-width":"160",sortable:""},{default:a(o=>[w("span",{class:M(z(o.row.operating_cash_flow))},p(h(o.row.operating_cash_flow)),3)]),_:1}),e(n,{prop:"investing_cash_flow",label:"投资活动现金流量净额","min-width":"160",sortable:""},{default:a(o=>[w("span",{class:M(z(o.row.investing_cash_flow))},p(h(o.row.investing_cash_flow)),3)]),_:1}),e(n,{prop:"financing_cash_flow",label:"筹资活动现金流量净额","min-width":"160",sortable:""},{default:a(o=>[w("span",{class:M(z(o.row.financing_cash_flow))},p(h(o.row.financing_cash_flow)),3)]),_:1}),e(n,{prop:"net_cash_flow",label:"现金及现金等价物净增加额","min-width":"180",sortable:""},{default:a(o=>[w("span",{class:M(z(o.row.net_cash_flow))},p(h(o.row.net_cash_flow)),3)]),_:1}),e(n,{prop:"cash_received_from_sales",label:"销售商品、提供劳务收到的现金","min-width":"200",sortable:""},{default:a(o=>[g(p(h(o.row.cash_received_from_sales)),1)]),_:1}),e(n,{prop:"cash_paid_for_goods",label:"购买商品、接受劳务支付的现金","min-width":"200",sortable:""},{default:a(o=>[g(p(h(o.row.cash_paid_for_goods)),1)]),_:1}),e(n,{prop:"cash_paid_to_employees",label:"支付给职工以及为职工支付的现金","min-width":"200",sortable:""},{default:a(o=>[g(p(h(o.row.cash_paid_to_employees)),1)]),_:1}),e(n,{prop:"taxes_paid",label:"支付的各项税费","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.taxes_paid)),1)]),_:1}),e(n,{prop:"cash_from_investments",label:"收回投资收到的现金","min-width":"140",sortable:""},{default:a(o=>[g(p(h(o.row.cash_from_investments)),1)]),_:1}),e(n,{prop:"cash_for_investments",label:"投资支付的现金","min-width":"120",sortable:""},{default:a(o=>[g(p(h(o.row.cash_for_investments)),1)]),_:1}),e(n,{prop:"cash_from_financing",label:"取得借款收到的现金","min-width":"140",sortable:""},{default:a(o=>[g(p(h(o.row.cash_from_financing)),1)]),_:1}),e(n,{prop:"cash_for_debt_repayment",label:"偿还债务支付的现金","min-width":"140",sortable:""},{default:a(o=>[g(p(h(o.row.cash_for_debt_repayment)),1)]),_:1}),e(n,{prop:"announcement_date",label:"公告日期",width:"120"})]),_:1},8,["data"])):ne("",!0),!f.value&&m.value.length>0?(v(),S("div",Ue,[e(b,{"current-page":r.value,"onUpdate:currentPage":l[1]||(l[1]=o=>r.value=o),"page-size":E.value,total:k.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:P,onCurrentChange:V},null,8,["current-page","page-size","total"])])):f.value?(v(),S("div",Be,[e(R,{rows:10,animated:""})])):(v(),S("div",je,[e(O,{description:"暂无现金流量表数据"},{default:a(()=>[e(T,{type:"primary",onClick:C},{default:a(()=>[...l[3]||(l[3]=[g("刷新数据",-1)])]),_:1})]),_:1})]))]),_:1})])}}}),Ye=Z(Ke,[["__scopeId","data-v-4cbf1178"]]),We={class:"history-data-table"},qe={key:0,class:"table-container"},Je={class:"pagination-container"},Ze={key:1,class:"empty-container"},Qe=J({__name:"HistoryDataTable",props:{historyData:{}},emits:["refresh","sort-change"],setup(G,{expose:_,emit:D}){const d=G,f=D,m=y("date"),k=y("desc"),r=y(1),E=y(20),I=q(()=>d.historyData.length?[...d.historyData].sort((s,t)=>{const l=s[m.value],x=t[m.value];if(typeof l=="string"&&typeof x=="string")return k.value==="asc"?l.localeCompare(x):x.localeCompare(l);{const H=l==null?-1/0:Number(l),N=x==null?-1/0:Number(x);return k.value==="asc"?H-N:N-H}}):[]),L=q(()=>{const s=(r.value-1)*E.value,t=s+E.value;return I.value.slice(s,t)}),C=({prop:s,order:t})=>{m.value=s||"date",k.value=t==="ascending"?"asc":"desc",f("sort-change",{prop:s,order:t})},F=s=>{E.value=s,r.value=1},P=s=>{r.value=s},V=()=>{f("refresh")},h=s=>s>0?"price-up":s<0?"price-down":"price-unchanged",z=s=>s==null?"-":s>=1e8?(s/1e8).toFixed(2)+"亿手":s>=1e4?(s/1e4).toFixed(2)+"万手":s.toString()+"手",A=s=>s==null?"-":s>=1e8?(s/1e8).toFixed(2)+"亿":s>=1e4?(s/1e4).toFixed(2)+"万":s.toString();return _({resetPagination:()=>{r.value=1}}),(s,t)=>{const l=i("el-table-column"),x=i("el-table"),H=i("el-pagination"),N=i("el-button"),T=i("el-empty");return v(),S("div",We,[s.historyData.length>0?(v(),S("div",qe,[e(x,{data:L.value,border:"",stripe:"",style:{width:"100%","max-width":"100%"},height:"400",onSortChange:C},{default:a(()=>[e(l,{prop:"date",label:"日期",width:"120",sortable:""}),e(l,{prop:"open_price",label:"开盘价","min-width":"100",sortable:""}),e(l,{prop:"high_price",label:"最高价","min-width":"100",sortable:""}),e(l,{prop:"low_price",label:"最低价","min-width":"100",sortable:""}),e(l,{prop:"close_price",label:"收盘价","min-width":"100",sortable:""}),e(l,{prop:"change_percent",label:"涨跌幅","min-width":"100",sortable:""},{default:a($=>[w("span",{class:M(h($.row.change_percent))},p($.row.change_percent>0?"+":"")+p($.row.change_percent.toFixed(2))+"% ",3)]),_:1}),e(l,{prop:"volume",label:"成交量","min-width":"120",sortable:""},{default:a($=>[g(p(z($.row.volume)),1)]),_:1}),e(l,{prop:"amount",label:"成交额","min-width":"120",sortable:""},{default:a($=>[g(p(A($.row.amount)),1)]),_:1}),e(l,{prop:"turnover_rate",label:"换手率","min-width":"100",sortable:""},{default:a($=>[g(p($.row.turnover_rate?$.row.turnover_rate.toFixed(2)+"%":"-"),1)]),_:1})]),_:1},8,["data"]),w("div",Je,[e(H,{"current-page":r.value,"onUpdate:currentPage":t[0]||(t[0]=$=>r.value=$),"page-size":E.value,total:s.historyData.length,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:P},null,8,["current-page","page-size","total"])])])):(v(),S("div",Ze,[e(T,{description:"暂无历史行情数据"},{default:a(()=>[e(N,{type:"primary",onClick:V},{default:a(()=>[...t[1]||(t[1]=[g("查询数据",-1)])]),_:1})]),_:1})]))])}}}),Xe=Z(Qe,[["__scopeId","data-v-1afb5bc5"]]),et={class:"performance-data-table"},tt={class:"filter-section"},at={key:1,class:"text-gray-400"},ot={class:"pagination-container"},nt=J({__name:"PerformanceDataTable",props:{performanceData:{},loading:{type:Boolean,default:!1}},emits:["refresh","sort-change"],setup(G,{emit:_}){const D=G,d=_,f=y(1),m=y(20),k=y(""),r=q(()=>{if(!k.value)return D.performanceData;const t=k.value.toLowerCase().trim();return D.performanceData.filter(l=>l.report_date.toLowerCase().includes(t))}),E=q(()=>{const t=(f.value-1)*m.value,l=t+m.value;return r.value.slice(t,l)}),I=()=>{f.value=1},L=()=>{k.value="",f.value=1},C=({prop:t,order:l})=>{d("sort-change",{prop:t,order:l})},F=t=>{m.value=t,f.value=1},P=t=>{f.value=t},V=t=>t?t.includes("-")?t:t.length===8?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t:"--",h=(t,l=2)=>t==null?"--":t.toFixed(l),z=t=>t==null?"--":`${t.toFixed(2)}%`,A=t=>t==null?"--":(t/1e8).toFixed(2),s=t=>t==null||t===0?"":t>0?"text-red-500":"text-green-500";return(t,l)=>{const x=i("el-icon"),H=i("el-input"),N=i("el-col"),T=i("el-button"),$=i("el-row"),n=i("el-table-column"),c=i("el-table"),b=i("el-pagination"),R=i("el-empty"),O=_e("loading");return v(),S("div",et,[w("div",tt,[e($,{gutter:20,align:"middle"},{default:a(()=>[e(N,{span:8},{default:a(()=>[e(H,{modelValue:k.value,"onUpdate:modelValue":l[0]||(l[0]=u=>k.value=u),placeholder:"输入报告期进行筛选（如：2023、2023-12）",clearable:"",onInput:I},{prefix:a(()=>[e(x,null,{default:a(()=>[e(W(ae))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(N,{span:4},{default:a(()=>[e(T,{onClick:L},{default:a(()=>[...l[3]||(l[3]=[g("清除筛选",-1)])]),_:1})]),_:1})]),_:1})]),de((v(),X(c,{data:E.value,stripe:"",border:"",height:"600",onSortChange:C},{default:a(()=>[e(n,{prop:"report_date",label:"报告期",width:"120",sortable:"custom"},{default:a(({row:u})=>[g(p(V(u.report_date)),1)]),_:1}),e(n,{prop:"earnings_per_share",label:"每股收益(元)",width:"120",sortable:"custom",align:"right"},{default:a(({row:u})=>[w("span",{class:M(s(u.earnings_per_share))},p(h(u.earnings_per_share,4)),3)]),_:1}),e(n,{prop:"operating_revenue",label:"营业收入(亿元)",width:"140",sortable:"custom",align:"right"},{default:a(({row:u})=>[g(p(A(u.operating_revenue)),1)]),_:1}),e(n,{prop:"operating_revenue_growth_rate",label:"营收增长率(%)",width:"140",sortable:"custom",align:"right"},{default:a(({row:u})=>[w("span",{class:M(s(u.operating_revenue_growth_rate))},p(z(u.operating_revenue_growth_rate)),3)]),_:1}),e(n,{prop:"net_profit",label:"净利润(亿元)",width:"140",sortable:"custom",align:"right"},{default:a(({row:u})=>[w("span",{class:M(s(u.net_profit))},p(A(u.net_profit)),3)]),_:1}),e(n,{prop:"net_profit_growth_rate",label:"净利润增长率(%)",width:"150",sortable:"custom",align:"right"},{default:a(({row:u})=>[w("span",{class:M(s(u.net_profit_growth_rate))},p(z(u.net_profit_growth_rate)),3)]),_:1}),e(n,{prop:"net_assets_per_share",label:"每股净资产(元)",width:"140",sortable:"custom",align:"right"},{default:a(({row:u})=>[g(p(h(u.net_assets_per_share,4)),1)]),_:1}),e(n,{prop:"roe",label:"净资产收益率(%)",width:"150",sortable:"custom",align:"right"},{default:a(({row:u})=>[w("span",{class:M(s(u.roe))},p(z(u.roe)),3)]),_:1}),e(n,{prop:"operating_cash_flow_per_share",label:"每股经营现金流(元)",width:"170",sortable:"custom",align:"right"},{default:a(({row:u})=>[w("span",{class:M(s(u.operating_cash_flow_per_share))},p(h(u.operating_cash_flow_per_share,4)),3)]),_:1}),e(n,{prop:"gross_profit_margin",label:"毛利率(%)",width:"120",sortable:"custom",align:"right"},{default:a(({row:u})=>[u.gross_profit_margin!==null?(v(),S("span",{key:0,class:M(s(u.gross_profit_margin))},p(z(u.gross_profit_margin)),3)):(v(),S("span",at,"--"))]),_:1}),e(n,{prop:"announcement_date",label:"公告日期",width:"120"},{default:a(({row:u})=>[g(p(V(u.announcement_date)),1)]),_:1})]),_:1},8,["data"])),[[O,t.loading]]),w("div",ot,[e(b,{"current-page":f.value,"onUpdate:currentPage":l[1]||(l[1]=u=>f.value=u),"page-size":m.value,"onUpdate:pageSize":l[2]||(l[2]=u=>m.value=u),"page-sizes":[10,20,50,100],total:r.value.length,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:P},null,8,["current-page","page-size","total"])]),!t.loading&&r.value.length===0?(v(),X(R,{key:0,description:k.value?"未找到匹配的业绩数据":"暂无业绩数据"},null,8,["description"])):ne("",!0)])}}}),lt=Z(nt,[["__scopeId","data-v-3dd3a3b7"]]),rt={class:"stock-chart-container"},st={key:0,class:"chart-wrapper"},it={key:1,class:"loading-container"},ct={key:2,class:"empty-container"},dt=J({__name:"StockChart",props:{historyData:{},stockInfo:{},loading:{type:Boolean,default:!1}},setup(G){const _=G,D=y(null);let d=null;const f=()=>{if(console.log("StockChart initChart called",{hasChartRef:!!D.value,dataLength:_.historyData.length,stockInfo:_.stockInfo,loading:_.loading}),!D.value||!_.historyData.length){console.log("StockChart initChart early return",{hasChartRef:!!D.value,dataLength:_.historyData.length});return}d&&d.dispose(),d=re(D.value),console.log("StockChart chart instance created",d);const m={title:{text:`${_.stockInfo.name} (${_.stockInfo.code}) 历史K线图`,left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["K线","成交量"],bottom:10},grid:[{id:"main",left:"10%",right:"10%",height:"60%",top:"10%"},{id:"volume",left:"10%",right:"10%",top:"75%",height:"15%"}],xAxis:[{type:"category",data:_.historyData.map(r=>r.date),scale:!0,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},splitNumber:20,gridIndex:0},{type:"category",data:_.historyData.map(r=>r.date),scale:!0,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},gridIndex:1,axisLabel:{show:!1}}],yAxis:[{type:"value",scale:!0,splitLine:{show:!0},position:"right",name:"价格",nameLocation:"middle",nameGap:30,gridIndex:0},{type:"value",scale:!0,splitLine:{show:!1},name:"成交量",nameLocation:"middle",nameGap:15,gridIndex:1}],dataZoom:[{type:"inside",start:0,end:100,xAxisIndex:[0,1]},{show:!0,type:"slider",bottom:5,start:0,end:100,xAxisIndex:[0,1]}],series:[{name:"K线",type:"candlestick",xAxisIndex:0,yAxisIndex:0,data:_.historyData.map(r=>[r.open_price,r.close_price,r.low_price,r.high_price]),itemStyle:{color:"#f56c6c",color0:"#67c23a",borderColor:"#f56c6c",borderColor0:"#67c23a"}},{name:"成交量",type:"bar",xAxisIndex:1,yAxisIndex:1,data:_.historyData.map(r=>r.volume),itemStyle:{color:function(r){const E=r.dataIndex,I=_.historyData[E];return I.close_price>I.open_price?"#f56c6c":"#67c23a"}}}]};console.log("StockChart option prepared",m),d.setOption(m),console.log("StockChart setOption completed");const k=()=>{d?.resize()};window.addEventListener("resize",k)};return Q(()=>[_.historyData,_.stockInfo,_.loading],async()=>{console.log("StockChart watch triggered",{loading:_.loading,dataLength:_.historyData.length,stockInfo:_.stockInfo}),!_.loading&&_.historyData.length>0?(await te(),f()):d&&d.clear()},{deep:!0,immediate:!0}),ee(async()=>{console.log("StockChart onMounted",{loading:_.loading,dataLength:_.historyData.length}),!_.loading&&_.historyData.length>0&&(await te(),f())}),le(()=>{d&&(d.dispose(),d=null),window.removeEventListener("resize",()=>{d?.resize()})}),(m,k)=>{const r=i("el-skeleton"),E=i("el-empty");return v(),S("div",rt,[!m.loading&&m.historyData.length>0?(v(),S("div",st,[w("div",{ref_key:"chartRef",ref:D,class:"stock-chart"},null,512)])):m.loading?(v(),S("div",it,[e(r,{rows:8,animated:""})])):(v(),S("div",ct,[e(E,{description:"暂无历史行情数据"})]))])}}}),_t=Z(dt,[["__scopeId","data-v-8daccfac"]]),ut={class:"performance-chart-container"},pt={class:"filter-section"},mt={key:0,class:"chart-wrapper"},gt={key:1,class:"loading-container"},ht={key:2,class:"empty-container"},ft=J({__name:"PerformanceChart",props:{performanceData:{},stockInfo:{},loading:{type:Boolean,default:!1}},setup(G){const _=G,D=y(null);let d=null;const f=y(""),m=q(()=>{if(!f.value)return _.performanceData;const L=f.value.toLowerCase().trim();return _.performanceData.filter(C=>C.report_date.toLowerCase().includes(L))}),k=()=>f.value&&_.performanceData.length>0?"未找到匹配的业绩数据":"暂无业绩数据",r=()=>{m.value.length>0?te(()=>{I()}):d&&d.clear()},E=()=>{f.value=""},I=()=>{if(!D.value||!m.value.length)return;d&&d.dispose(),d=re(D.value);const L=[...m.value].sort((s,t)=>s.report_date.localeCompare(t.report_date)),C=L.map(s=>s.report_date),F=L.map(s=>s.operating_revenue/1e8),P=L.map(s=>s.net_profit/1e8),V=L.map(s=>s.earnings_per_share),h=L.map(s=>s.roe),z={title:{text:`${_.stockInfo.name} (${_.stockInfo.code}) 业绩数据趋势`,left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["营业收入(亿元)","净利润(亿元)","每股收益(元)","ROE(%)"],top:40},grid:{left:"10%",right:"10%",top:"20%",bottom:"10%"},xAxis:{type:"category",data:C,axisLabel:{rotate:45}},yAxis:[{type:"value",name:"金额(亿元)",position:"left",axisLabel:{formatter:"{value}"}},{type:"value",name:"比率",position:"right",axisLabel:{formatter:"{value}"}}],series:[{name:"营业收入(亿元)",type:"line",yAxisIndex:0,data:F,smooth:!0,itemStyle:{color:"#409EFF"}},{name:"净利润(亿元)",type:"line",yAxisIndex:0,data:P,smooth:!0,itemStyle:{color:"#67C23A"}},{name:"每股收益(元)",type:"line",yAxisIndex:1,data:V,smooth:!0,itemStyle:{color:"#E6A23C"}},{name:"ROE(%)",type:"line",yAxisIndex:1,data:h,smooth:!0,itemStyle:{color:"#F56C6C"}}]};d.setOption(z);const A=()=>{d?.resize()};window.addEventListener("resize",A)};return Q(()=>[_.performanceData,_.stockInfo],async()=>{!_.loading&&m.value.length>0?(await te(),I()):d&&d.clear()},{deep:!0}),Q(()=>m.value,async()=>{!_.loading&&m.value.length>0?(await te(),I()):d&&d.clear()},{deep:!0}),ee(async()=>{!_.loading&&m.value.length>0&&(await te(),I())}),le(()=>{d&&(d.dispose(),d=null),window.removeEventListener("resize",()=>{d?.resize()})}),(L,C)=>{const F=i("el-input"),P=i("el-button"),V=i("el-skeleton"),h=i("el-empty");return v(),S("div",ut,[w("div",pt,[e(F,{modelValue:f.value,"onUpdate:modelValue":C[0]||(C[0]=z=>f.value=z),placeholder:"筛选报告期 (如: 2023, 2023-12)",clearable:"","prefix-icon":W(ae),onInput:r,style:{width:"300px","margin-right":"10px"}},null,8,["modelValue","prefix-icon"]),e(P,{onClick:E},{default:a(()=>[...C[1]||(C[1]=[g("清除筛选",-1)])]),_:1})]),!L.loading&&m.value.length>0?(v(),S("div",mt,[C[2]||(C[2]=w("h3",null,"业绩数据趋势",-1)),w("div",{ref_key:"performanceChartRef",ref:D,class:"performance-chart"},null,512)])):L.loading?(v(),S("div",gt,[e(V,{rows:6,animated:""})])):(v(),S("div",ht,[e(h,{description:k()},null,8,["description"])]))])}}}),yt=Z(ft,[["__scopeId","data-v-72c8fdbb"]]),bt={class:"candlestick-pattern-heatmap"},vt={class:"header"},wt={key:1,class:"empty"},kt=J({__name:"CandlestickPatternHeatmap",props:{stockCode:{},startDate:{},endDate:{}},setup(G){const _=G,D=y({}),d=y(!1),f=y(null),m=y(0),k=y(!1),r=["hammer","morning_star","piercing","inverted_hammer","three_white_soldiers","ladder_bottom","matching_low","mat_hold","morning_doji_star","homing_pigeon","stick_sandwich","takuri","unique_three_river"],E=["hanging_man","evening_star","dark_cloud_cover","three_black_crows","identical_three_crows","two_crows","advance_block","evening_doji_star","in_neck","on_neck","shooting_star","stalled_pattern","thrusting","upside_gap_two_crows","conceal_baby_swallow"],I=["doji","long_legged_doji","gravestone_doji","dragonfly_doji","rickshaw_man","spinning_top","marubozu","short_line","long_line","doji_star","tristar","separating_lines","rise_fall_three_methods","tasuki_gap","gap_side_by_side_white","three_inside","three_line_strike","three_outside","three_stars_in_south","abandoned_baby","belt_hold","breakaway","closing_marubozu","counterattack","kicking","kicking_by_length","engulfing","harami","xside_gap_three_methods"],L=[...r,...I,...E],C={hammer:"锤子线（看涨）",morning_star:"早晨之星（看涨）",piercing:"刺透（看涨）",inverted_hammer:"倒锤头（看涨）",three_white_soldiers:"三个白兵（看涨）",ladder_bottom:"梯底（看涨）",matching_low:"相同低价（看涨）",mat_hold:"垫脚石（看涨）",morning_doji_star:"十字晨星（看涨）",homing_pigeon:"家鸽（看涨）",stick_sandwich:"条形三明治（看涨）",takuri:"探水杆（看涨）",unique_three_river:"独特三河（看涨）",hanging_man:"上吊线（看跌）",evening_star:"黄昏之星（看跌）",dark_cloud_cover:"乌云盖顶（看跌）",three_black_crows:"三只黑乌鸦（看跌）",identical_three_crows:"同样三乌鸦（看跌）",two_crows:"两只乌鸦（看跌）",advance_block:"大敌当前（看跌）",evening_doji_star:"十字暮星（看跌）",in_neck:"颈内线（看跌）",on_neck:"颈上线（看跌）",shooting_star:"射击之星（看跌）",stalled_pattern:"停顿形态（看跌）",thrusting:"插入形态（看跌）",upside_gap_two_crows:"向上跳空两只乌鸦（看跌）",conceal_baby_swallow:"藏婴吞没（看跌）",doji:"十字星（中性）",long_legged_doji:"长脚十字星（中性）",gravestone_doji:"墓碑十字星（中性）",dragonfly_doji:"蜻蜓十字（中性）",rickshaw_man:"黄包车夫（中性）",spinning_top:"纺锤线（中性/双向）",marubozu:"秃线/缺影线（中性/双向）",short_line:"短线（中性/双向）",long_line:"长线（中性/双向）",doji_star:"十字星形态（中性/双向）",tristar:"三星（中性/双向）",separating_lines:"分离线（中性/双向）",rise_fall_three_methods:"上升/下降三法（中性/双向）",tasuki_gap:"跳空并列线（中性/双向）",gap_side_by_side_white:"并列阳线（中性/双向）",three_inside:"三内部上涨/下跌（中性/双向）",three_line_strike:"三线打击（中性/双向）",three_outside:"三外部上涨/下跌（中性/双向）",three_stars_in_south:"南方三星（中性/双向）",abandoned_baby:"弃婴（中性/双向）",belt_hold:"捉腰带线（中性/双向）",breakaway:"脱离形态（中性/双向）",closing_marubozu:"收盘秃线（中性/双向）",counterattack:"反击线（中性/双向）",kicking:"踢击（看涨/看跌）",kicking_by_length:"由较长秃线决定的反冲（中性/双向）",engulfing:"吞没（看涨/看跌）",harami:"孕线（看涨/看跌）",xside_gap_three_methods:"向上/向下跳空三法（中性/双向）"},F=[{key:"two_crows",talib:"CDL2CROWS",name:"两只乌鸦",summary:"看跌反转，三日模式，第二三天高开收阴，收盘价降低。"},{key:"three_black_crows",talib:"CDL3BLACKCROWS",name:"三只黑乌鸦",summary:"强烈看跌反转，上涨后出现三根连续阴线，空方强劲。"},{key:"three_inside",talib:"CDL3INSIDE",name:"三内部上涨/下跌",summary:"趋势反转，Inside Up 为阴阳阳组合，第三日收盘高于第一日开盘。"},{key:"three_line_strike",talib:"CDL3LINESTRIKE",name:"三线打击",summary:"看跌持续/反转，第四日高开低走，可能上涨趋势失效。"},{key:"three_outside",talib:"CDL3OUTSIDE",name:"三外部上涨/下跌",summary:"趋势反转，Outside Up 第一日K线位于第二日实体内部，预示上涨。"},{key:"three_stars_in_south",talib:"CDL3STARSINSOUTH",name:"南方三星",summary:"看涨反转，下跌中三日皆阴但实体缩短，下影线变短。"},{key:"three_white_soldiers",talib:"CDL3WHITESOLDIERS",name:"三个白兵",summary:"强烈看涨反转，底部三根连续阳线，买盘强劲。"},{key:"abandoned_baby",talib:"CDLABANDONEDBABY",name:"弃婴",summary:"典型反转，第二日跳空且十字星，趋势可能结束。"},{key:"advance_block",talib:"CDLADVANCEBLOCK",name:"大敌当前",summary:"看跌反转，三连阳但实体缩短、上影线变长，上涨动能衰竭。"},{key:"belt_hold",talib:"CDLBELTHOLD",name:"捉腰带线",summary:"趋势反转，下跌中长阳线，开盘为最低价，收盘接近最高。"},{key:"breakaway",talib:"CDLBREAKAWAY",name:"脱离形态",summary:"趋势反转，五日模式，下跌后出现组合，预示趋势脱离转向。"},{key:"closing_marubozu",talib:"CDLCLOSINGMARUBOZU",name:"收盘秃线",summary:"趋势持续，一日模式，收盘等于最高价（阳线），上涨动力强。"},{key:"conceal_baby_swallow",talib:"CDLCONCEALBABYSWALL",name:"藏婴吞没",summary:"看涨反转，下跌中四日模式，最后一日暗示底部反转。"},{key:"counterattack",talib:"CDLCOUNTERATTACK",name:"反击线",summary:"趋势反转信号，两日收盘价处同一水平，多空短暂平衡。"},{key:"dark_cloud_cover",talib:"CDLDARKCLOUDCOVER",name:"乌云盖顶",summary:"看跌反转，第二日高开后收盘深入第一日实体下半部。"},{key:"doji",talib:"CDLDOJI",name:"十字线",summary:"趋势反转指示，开收盘几乎相同，趋势末端是重要警示。"},{key:"doji_star",talib:"CDLDOJISTAR",name:"十字星形态",summary:"趋势反转指示，与十字线类似，可能伴随跳空，反转意义更强。"},{key:"dragonfly_doji",talib:"CDLDRAGONFLYDOJI",name:"蜻蜓十字",summary:"看涨反转，长下影线，底部出现时预示可能反弹。"},{key:"engulfing",talib:"CDLENGULFING",name:"吞没形态",summary:"趋势反转，两日第二日吞没第一日，看涨/看跌取决于方向。"},{key:"evening_doji_star",talib:"CDLEVENINGDOJISTAR",name:"十字暮星",summary:"强烈看跌反转，暮星变体，第二日为十字星。"},{key:"evening_star",talib:"CDLEVENINGSTAR",name:"暮星/黄昏之星",summary:"看跌反转，三日模式，第三日阴线深入第一日实体。"},{key:"gap_side_by_side_white",talib:"CDLGAPSIDESIDEWHITE",name:"并列阳线",summary:"趋势持续，跳空后并列两根阳线，趋势将延续。"},{key:"gravestone_doji",talib:"CDLGRAVESTONEDOJI",name:"墓碑十字",summary:"看跌反转，长上影线位于顶部，出现在上涨趋势顶部危险。"},{key:"hammer",talib:"CDLHAMMER",name:"锤头线",summary:"看涨反转，实体小、长下影线，底部预示回升。"},{key:"hanging_man",talib:"CDLHANGINGMAN",name:"上吊线",summary:"看跌反转，形似锤头线但位于上涨顶部。"},{key:"harami",talib:"CDLHARAMI",name:"孕线",summary:"趋势反转，两日第二日小实体位于第一日内部。"},{key:"harami_cross",talib:"CDLHARAMICROSS",name:"十字孕线",summary:"孕线变体，第二日为十字星，反转意味更强。"},{key:"high_wave",talib:"CDLHIGHWAVE",name:"风高浪大线",summary:"趋势反转，极长影线与短实体，剧烈波动与犹豫。"},{key:"hikkake",talib:"CDLHIKKAKE",name:"陷阱模式",summary:"趋势持续/失败反转，初似反转但后续走势失败恢复原趋势。"},{key:"hikkakemod",talib:"CDLHIKKAKEMOD",name:"修正陷阱模式",summary:"趋势持续，陷阱模式的修正定义，延续原有趋势。"},{key:"homing_pigeon",talib:"CDLHOMINGPIGEON",name:"家鸽",summary:"看涨反转，与孕线类似，两日同色，下跌中出现。"},{key:"identical_three_crows",talib:"CDLIDENTICAL3CROWS",name:"三胞胎乌鸦",summary:"强烈看跌反转，三日阴线长度更接近，开盘等于前日收盘。"},{key:"in_neck",talib:"CDLINNECK",name:"颈内线",summary:"趋势持续（下跌），第二日阳线收盘略高于前一日收盘。"},{key:"inverted_hammer",talib:"CDLINVERTEDHAMMER",name:"倒锤头",summary:"看涨反转，长上影线，需次日阳线确认。"},{key:"kicking",talib:"CDLKICKING",name:"反冲形态",summary:"趋势反转，两根相反颜色且跳空的秃线组成。"},{key:"kicking_by_length",talib:"CDLKICKINGBYLENGTH",name:"由较长秃线决定的反冲",summary:"趋势反转，较长的秃线方向决定看涨/看跌。"},{key:"ladder_bottom",talib:"CDLLADDERBOTTOM",name:"梯底",summary:"看涨反转，五日模式，最后一日阳线确认底部。"},{key:"long_legged_doji",talib:"CDLLONGLEGGEDDOJI",name:"长腿十字",summary:"趋势反转指示，极长上下影线与极短实体，强烈警示。"},{key:"long_line",talib:"CDLLONGLINE",name:"长线",summary:"趋势强度指示，实体很长，显示趋势动力强。"},{key:"marubozu",talib:"CDLMARUBOZU",name:"秃线/缺影线",summary:"趋势持续，几乎无影线，显示趋势动力强劲。"},{key:"matching_low",talib:"CDLMATCHINGLOW",name:"相同低价",summary:"看涨反转，两日最低收盘价相同，下跌动能减弱。"},{key:"mat_hold",talib:"CDLMATHOLD",name:"垫脚石",summary:"趋势持续（上涨），上升中短暂休息后继续上涨。"},{key:"morning_doji_star",talib:"CDLMORNINGDOJISTAR",name:"十字晨星",summary:"强烈看涨反转，晨星变体，第二日为十字星。"},{key:"morning_star",talib:"CDLMORNINGSTAR",name:"晨星/启明星",summary:"看涨反转，三日模式，底部经典信号。"},{key:"on_neck",talib:"CDLONNECK",name:"颈上线",summary:"趋势持续（下跌），第二日阳线回升至前一日最低点。"},{key:"piercing",talib:"CDLPIERCING",name:"刺透形态",summary:"看涨反转，两日第二日大幅低开后强劲回升，切入前日实体一半以上。"},{key:"rickshaw_man",talib:"CDLRICKSHAWMAN",name:"黄包车夫",summary:"趋势反转指示，特殊长腿十字，开收位于区间中点。"},{key:"rise_fall_three_methods",talib:"CDLRISEFALL3METHODS",name:"上升/下降三法",summary:"趋势持续，长阳后数日小实体回调，最后再以长阳确认。"},{key:"separating_lines",talib:"CDLSEPARATINGLINES",name:"分离线",summary:"趋势持续，两日颜色相反但开盘相同，沿原方向继续。"},{key:"shooting_star",talib:"CDLSHOOTINGSTAR",name:"射击之星",summary:"看跌反转，位于上涨顶部，长上影线，可能见顶回落。"},{key:"short_line",talib:"CDLSHORTLINE",name:"短线",summary:"趋势动能减弱，实体很短，波动小，市场犹豫。"},{key:"spinning_top",talib:"CDLSPINNINGTOP",name:"纺锤线",summary:"趋势犹豫/反转警示，小实体与较短影线，力量平衡。"},{key:"stalled_pattern",talib:"CDLSTALLEDPATTERN",name:"停顿形态",summary:"看跌反转，上涨末端三烛线组合，动能衰竭。"},{key:"stick_sandwich",talib:"CDLSTICKSANDWICH",name:"条形三明治",summary:"看涨反转，三日两边阴线中间阳线，阴线收盘同一水平。"},{key:"takuri",talib:"CDLTAKURI",name:"探水杆",summary:"看涨反转，蜻蜓十字的一种，下影线特别长。"},{key:"tasuki_gap",talib:"CDLTASUKIGAP",name:"跳空并列线",summary:"趋势持续，跳空后下一日未回补缺口，趋势延续。"},{key:"thrusting",talib:"CDLTHRUSTING",name:"插入形态",summary:"趋势持续（下跌），第二日阳线未能超过前一日实体一半。"},{key:"tristar",talib:"CDLTRISTAR",name:"三星",summary:"趋势反转，三个十字星组成，罕见但重要信号。"},{key:"unique_three_river",talib:"CDLUNIQUE3RIVER",name:"独特三河",summary:"看涨反转，三日复杂组合，底部出现预示反转。"},{key:"upside_gap_two_crows",talib:"CDLUPSIDEGAP2CROWS",name:"向上跳空两只乌鸦",summary:"看跌反转，上涨中出现两只乌鸦，是顶部警告。"},{key:"xside_gap_three_methods",talib:"CDLXSIDEGAP3METHODS",name:"向上/向下跳空三法",summary:"趋势持续，跳空并列线的扩展，经过整理后延续。"}],P=q(()=>F.map(A=>({...A,group:r.includes(A.key)?"看涨":E.includes(A.key)?"看跌":I.includes(A.key)?"中性/双向":"趋势持续/其它"}))),V=q(()=>{const A=m.value||L.length;return Math.max(500,A*28+140)}),h=async()=>{if(!_.stockCode){d.value=!1;return}try{const A=c=>{if(c)return/^\d{8}$/.test(c)?`${c.slice(0,4)}-${c.slice(4,6)}-${c.slice(6,8)}`:c},s=A(_.startDate),t=A(_.endDate),l=await Se(_.stockCode,{start_date:s,end_date:t});if(!l){d.value=!1;return}const x=Array.isArray(l.patterns)?l.patterns:[];if(!x.length){d.value=!1;return}const H=x.map(c=>String(c.date)),N=L.filter(c=>x.some(b=>typeof b[c]=="number"&&b[c]!==0));m.value=N.length;const T=[],$=new Map;N.forEach((c,b)=>$.set(c,b)),x.forEach((c,b)=>{N.forEach(R=>{const O=c[R],u=typeof O=="number"?O:0,o=$.get(R);typeof o=="number"&&T.push([b,o,u])})});const n=[{value:-100,label:"看跌",color:"#4a7bd0"},{value:0,label:"无信号",color:"#bdbdbd"},{value:100,label:"看涨",color:"#e84e40"}];D.value={tooltip:{position:"top",formatter:c=>{const b=c.data[0],R=c.data[1],O=c.data[2],u=H[b],o=N[R],K=C[o];return`${u}<br/>${K}: <br/>${O===100?"看涨(+100)":O===-100?"看跌(-100)":"无信号(0)"}`}},grid:{left:5,right:20,top:40,bottom:40},xAxis:{type:"category",data:H,axisLabel:{rotate:45}},yAxis:{type:"category",data:N.map(c=>C[c])},visualMap:{type:"piecewise",show:!0,pieces:n,orient:"horizontal",left:"center",top:8,textStyle:{fontSize:12}},series:[{type:"heatmap",data:T,emphasis:{itemStyle:{shadowBlur:6,shadowColor:"rgba(0,0,0,0.25)"}}}]},d.value=T.length>0}catch(A){console.error("[CandlestickPatternHeatmap] 加载形态识别热力图失败:",A),d.value=!1}},z=A=>{f.value=A};return Q(()=>[_.stockCode,_.startDate,_.endDate],h,{immediate:!0}),ee(()=>{h()}),(A,s)=>{const t=i("el-link"),l=i("el-empty"),x=i("el-table-column"),H=i("el-table"),N=i("el-dialog");return v(),S("div",bt,[w("div",vt,[s[3]||(s[3]=w("h3",null,"形态识别结果热力图",-1)),s[4]||(s[4]=w("span",{class:"subtitle"},"日期范围与历史行情一致；纵轴为形态类别，按看涨/看跌/中性分组",-1)),e(t,{type:"primary",underline:!1,onClick:s[0]||(s[0]=T=>k.value=!0)},{default:a(()=>[...s[2]||(s[2]=[g("形态说明",-1)])]),_:1})]),d.value?(v(),X(Le,{key:0,option:D.value,height:V.value,onChartReady:z},null,8,["option","height"])):(v(),S("div",wt,[e(l,{description:"暂无形态识别数据"})])),e(N,{modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=T=>k.value=T),title:"K线形态说明（TA-Lib）",width:"80%"},{default:a(()=>[e(H,{data:P.value,height:"60vh",size:"small"},{default:a(()=>[e(x,{prop:"key",label:"字段",width:"180"}),e(x,{prop:"name",label:"形态名称",width:"200"}),e(x,{prop:"talib",label:"TA-Lib 函数",width:"200"}),e(x,{prop:"group",label:"分组",width:"140"}),e(x,{prop:"summary",label:"主要作用与预示"})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}}),Ct=Z(kt,[["__scopeId","data-v-c06a15fb"]]),Dt={class:"stock-history-view"},Lt={class:"header-content"},St={class:"stock-info"},It={class:"stock-code"},xt={key:0},At={class:"header-actions"},Et={class:"query-section"},Rt={class:"chart-container"},Nt={class:"chart-container"},$t={class:"chart-container"},zt={key:0,class:"data-container"},Tt={key:1,class:"loading-container"},Ot={key:2,class:"empty-container"},Ft=J({__name:"StockHistoryView",setup(G){const _=ue(),D=ye(),d=y(!1),f=y(!1),m=y(!1),k=oe({code:"",name:"",industry:"",total_shares:0,circulating_shares:0,list_date:"",pe_ratio:0,pb_ratio:0,total_market_cap:0,circulating_market_cap:0,created_at:"",updated_at:"",latest_price:0,change_percent:0,change_amount:0,volume:0,amount:0,amplitude:0,high:0,low:0,open_price:0,close_price:0,volume_ratio:0,turnover_rate:0,price_change_speed:0,change_5min:0,change_60d:0,change_ytd:0}),r=oe({code:_.params.code||"",dateRange:[]}),E=q(()=>{const n=o=>{const K=o.getFullYear(),B=String(o.getMonth()+1).padStart(2,"0"),Y=String(o.getDate()).padStart(2,"0");return`${K}${B}${Y}`},c=o=>{if(/^\d{8}$/.test(o)){const K=Number(o.slice(0,4)),B=Number(o.slice(4,6))-1,Y=Number(o.slice(6,8));return new Date(K,B,Y)}return/^\d{4}-\d{2}-\d{2}$/.test(o)?new Date(o):new Date},b=(o,K)=>{const B=c(o);return B.setDate(B.getDate()-K),n(B)},R=r.dateRange?.[1]??n(new Date),O=/^\d{8}$/.test(R)?R:n(c(R));return[b(O,30),O]}),I=y([]),L=y([]),C=y([]),F=y("date"),P=y("desc"),V=y("history"),h=y(!1);q(()=>I.value.length?[...I.value].sort((n,c)=>{const b=n[F.value],R=c[F.value];if(typeof b=="string"&&typeof R=="string")return P.value==="asc"?b.localeCompare(R):R.localeCompare(b);{const O=b==null?-1/0:Number(b),u=R==null?-1/0:Number(R);return P.value==="asc"?O-u:u-O}}):[]);const z=()=>{D.back()},A=async()=>{if(!r.code){U.warning("请选择股票");return}d.value=!0;try{const n=r.dateRange[0]||"",c=r.dateRange[1]||"";console.log("StockHistoryView fetchHistoryData called",{code:r.code,startDate:n,endDate:c});const b=await ke(r.code,{start_date:n,end_date:c,adjust:""});if(console.log("StockHistoryView getStockHistory response",{responseLength:b?.length,firstItem:b?.[0]}),I.value=b,b&&b.length>0){const R=b[0];k.code=r.code,k.name=R.stock_name||"",console.log("StockHistoryView stockInfo updated",k)}await s(),U.success("历史行情数据加载成功")}catch(n){console.error("获取历史行情数据失败:",n),U.error("获取历史行情数据失败，请稍后重试")}finally{d.value=!1}},s=async()=>{if(r.code){m.value=!0;try{const n=await Ce(r.code,{page:1,page_size:20});L.value=n.reports.sort((c,b)=>b.report_date.localeCompare(c.report_date)),console.log("业绩数据加载成功:",L.value.length,"条记录")}catch(n){console.error("获取业绩数据失败:",n)}finally{m.value=!1}}},t=async n=>{if(!(n.length<2)){f.value=!0;try{const b=(await De()).data;C.value=b.filter(R=>R.code.includes(n)||R.name.includes(n)).slice(0,20)}catch(c){console.error("搜索股票失败:",c)}finally{f.value=!1}}},l=n=>{r.code=n,D.push(`/stock-history/${n}`)},x=()=>{A()},H=()=>{r.dateRange=[]},N=({prop:n,order:c})=>{F.value=n||"date",P.value=c==="ascending"?"asc":"desc"},T=n=>{h.value=n},$=n=>{U.error(n)};return Q(()=>_.params.code,n=>{n&&typeof n=="string"&&(r.code=n,A())}),ee(()=>{const n=new Date,c=new Date;c.setDate(c.getDate()-30),r.dateRange=[c.toISOString().split("T")[0].replace(/-/g,""),n.toISOString().split("T")[0].replace(/-/g,"")],r.code&&A()}),(n,c)=>{const b=i("el-button"),R=i("el-option"),O=i("el-select"),u=i("el-form-item"),o=i("el-date-picker"),K=i("el-form"),B=i("el-card"),Y=i("el-tab-pane"),se=i("el-tabs"),ie=i("el-skeleton"),ce=i("el-empty");return v(),S("div",Dt,[e(B,{class:"page-header"},{header:a(()=>[w("div",Lt,[w("div",St,[w("h2",null,[g(p(k.name)+" ",1),w("span",It,p(k.code),1)]),k.industry?(v(),S("p",xt,p(k.industry),1)):ne("",!0)]),w("div",At,[e(b,{type:"primary",icon:W(he),onClick:z},{default:a(()=>[...c[3]||(c[3]=[g("返回",-1)])]),_:1},8,["icon"]),e(b,{type:"success",icon:W(fe),onClick:A,loading:d.value},{default:a(()=>[...c[4]||(c[4]=[g(" 刷新数据 ",-1)])]),_:1},8,["icon","loading"])])])]),default:a(()=>[w("div",Et,[e(K,{inline:!0,model:r},{default:a(()=>[e(u,{label:"股票代码"},{default:a(()=>[e(O,{modelValue:r.code,"onUpdate:modelValue":c[0]||(c[0]=j=>r.code=j),filterable:"",remote:"",placeholder:"请输入股票代码或名称","remote-method":t,loading:f.value,onChange:l},{default:a(()=>[(v(!0),S(pe,null,me(C.value,j=>(v(),X(R,{key:j.code,label:`${j.name} (${j.code})`,value:j.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),e(u,{label:"日期范围"},{default:a(()=>[e(o,{modelValue:r.dateRange,"onUpdate:modelValue":c[1]||(c[1]=j=>r.dateRange=j),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),e(u,null,{default:a(()=>[e(b,{type:"primary",icon:W(ae),onClick:x},{default:a(()=>[...c[5]||(c[5]=[g("查询",-1)])]),_:1},8,["icon"]),e(b,{icon:W(ge),onClick:H},{default:a(()=>[...c[6]||(c[6]=[g("重置",-1)])]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),w("div",Rt,[e(B,{class:"chart-card"},{header:a(()=>[...c[7]||(c[7]=[w("div",{class:"card-header"},[w("span",null,"K线形态识别热力图（最近一月）")],-1)])]),default:a(()=>[e(Ct,{"stock-code":r.code,"start-date":E.value[0],"end-date":E.value[1]},null,8,["stock-code","start-date","end-date"])]),_:1})]),w("div",Nt,[e(_t,{"history-data":I.value,"stock-info":k,loading:d.value},null,8,["history-data","stock-info","loading"])]),w("div",$t,[e(yt,{"performance-data":L.value,"stock-info":k,loading:m.value},null,8,["performance-data","stock-info","loading"])]),!d.value&&(I.value.length>0||r.code)?(v(),S("div",zt,[e(se,{modelValue:V.value,"onUpdate:modelValue":c[2]||(c[2]=j=>V.value=j),type:"card",class:"data-tabs"},{default:a(()=>[e(Y,{label:"历史行情",name:"history"},{default:a(()=>[e(Xe,{"history-data":I.value,onRefresh:x,onSortChange:N},null,8,["history-data"])]),_:1}),e(Y,{label:"业绩数据",name:"performance"},{default:a(()=>[e(lt,{"performance-data":L.value,loading:m.value,onRefresh:x,onSortChange:N},null,8,["performance-data","loading"])]),_:1}),e(Y,{label:"资产负债表",name:"balance-sheet"},{default:a(()=>[e($e,{"stock-code":r.code,onLoading:T,onError:$},null,8,["stock-code"])]),_:1}),e(Y,{label:"利润表",name:"income-statement"},{default:a(()=>[e(He,{"stock-code":r.code,onLoading:T,onError:$},null,8,["stock-code"])]),_:1}),e(Y,{label:"现金流量表",name:"cash-flow-statement"},{default:a(()=>[e(Ye,{"stock-code":r.code,onLoading:T,onError:$},null,8,["stock-code"])]),_:1})]),_:1},8,["modelValue"])])):d.value?(v(),S("div",Tt,[e(ie,{rows:10,animated:""})])):(v(),S("div",Ot,[e(ce,{description:"暂无历史行情数据"},{default:a(()=>[e(b,{type:"primary",onClick:x},{default:a(()=>[...c[8]||(c[8]=[g("查询数据",-1)])]),_:1})]),_:1})]))]),_:1})])}}}),Ut=Z(Ft,[["__scopeId","data-v-f820c671"]]);export{Ut as default};
