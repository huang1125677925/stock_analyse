import{d as J,a as g,r as U,y as K,c as f,b as x,e,w as o,i as r,E as Q,k as w,l as W,O as X,F as V,A as k,f as b,D as Y,G as Z,t as ee,u as ae,o as u,_ as le}from"./index-yvE1imiI.js";import{g as B}from"./etfApi-CUoMHvdn.js";const te={class:"etf-basic-view"},ne={class:"page-header"},oe={class:"header-content"},se={class:"pagination"},de=J({__name:"EtfBasicView",setup(re){const A=ae(),v=g(!1),E=g([]),d=U({page:1,page_size:20,total:0,pages:0}),t=U({ts_code:"",index_code:"",exchange:"",list_status:"",etf_type:"",mgr_name:"",name:""}),z=g([]),C=g([]),F=g([]),T=g([]),D=async()=>{try{const s=await B({page:1,page_size:5e3});if(s.data){const l=s.data,m=new Map;l.forEach(n=>{n.index_code&&m.set(n.index_code,n.index_name||"")}),z.value=Array.from(m.entries()).map(([n,p])=>({value:n,label:p?`${n} ${p}`:n}));const h=new Set;l.forEach(n=>{n.exchange&&h.add(n.exchange)}),C.value=Array.from(h).sort();const y=new Set;l.forEach(n=>{n.etf_type&&y.add(n.etf_type)}),F.value=Array.from(y).sort();const i=new Set;l.forEach(n=>{n.mgr_name&&i.add(n.mgr_name)}),T.value=Array.from(i).sort((n,p)=>n.localeCompare(p,"zh-CN"))}}catch(s){console.error("获取筛选选项失败",s)}},_=async()=>{v.value=!0;try{const s=await B({ts_code:t.ts_code||void 0,index_code:t.index_code||void 0,exchange:t.exchange||void 0,list_status:t.list_status||void 0,etf_type:t.etf_type||void 0,mgr_name:t.mgr_name||void 0,name:t.name||void 0,page:d.page,page_size:d.page_size});E.value=s.data||[],d.total=s.total||0,d.pages=s.pages||0}catch(s){Q.error(s?.message||"ETF 基本信息获取失败")}finally{v.value=!1}},O=()=>{d.page=1,_()},N=()=>{t.ts_code="",t.index_code="",t.exchange="",t.list_status="",t.etf_type="",t.mgr_name="",t.name="",d.page=1,_()},M=()=>_(),L=s=>{d.page_size=s,d.page=1,_()},P=s=>{d.page=s,_()},$=s=>{s&&A.push({name:"index-analysis",query:{ts_code:s}})};return K(()=>{D(),_()}),(s,l)=>{const m=r("el-button"),h=r("el-icon"),y=r("el-space"),i=r("el-option"),n=r("el-select"),p=r("el-form-item"),q=r("el-input"),I=r("el-form"),S=r("el-card"),c=r("el-table-column"),R=r("el-link"),j=r("el-table"),G=r("el-pagination"),H=Z("loading");return u(),f("div",te,[x("div",ne,[x("div",oe,[l[11]||(l[11]=x("h2",null,"ETF 基本信息",-1)),e(y,null,{default:o(()=>[e(m,{type:"primary",loading:v.value,onClick:O},{default:o(()=>[...l[8]||(l[8]=[w("查询",-1)])]),_:1},8,["loading"]),e(m,{onClick:N},{default:o(()=>[...l[9]||(l[9]=[w("重置",-1)])]),_:1}),e(m,{onClick:M},{default:o(()=>[e(h,null,{default:o(()=>[e(W(X))]),_:1}),l[10]||(l[10]=w("刷新",-1))]),_:1})]),_:1})])]),e(S,{class:"search-card"},{default:o(()=>[e(I,{model:t,"label-width":"110px","label-position":"left",inline:""},{default:o(()=>[e(p,{label:"指数代码"},{default:o(()=>[e(n,{modelValue:t.index_code,"onUpdate:modelValue":l[0]||(l[0]=a=>t.index_code=a),placeholder:"选择或搜索指数",clearable:"",filterable:"",style:{width:"200px"}},{default:o(()=>[(u(!0),f(V,null,k(z.value,a=>(u(),b(i,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"交易所"},{default:o(()=>[e(n,{modelValue:t.exchange,"onUpdate:modelValue":l[1]||(l[1]=a=>t.exchange=a),placeholder:"选择交易所",clearable:"",style:{width:"140px"}},{default:o(()=>[(u(!0),f(V,null,k(C.value,a=>(u(),b(i,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"上市状态"},{default:o(()=>[e(n,{modelValue:t.list_status,"onUpdate:modelValue":l[2]||(l[2]=a=>t.list_status=a),placeholder:"全部",clearable:"",style:{width:"160px"}},{default:o(()=>[e(i,{label:"全部",value:""}),e(i,{label:"上市",value:"L"}),e(i,{label:"退市",value:"D"}),e(i,{label:"暂停",value:"P"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"ETF类型"},{default:o(()=>[e(n,{modelValue:t.etf_type,"onUpdate:modelValue":l[3]||(l[3]=a=>t.etf_type=a),placeholder:"选择类型",clearable:"",style:{width:"160px"}},{default:o(()=>[(u(!0),f(V,null,k(F.value,a=>(u(),b(i,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"管理人"},{default:o(()=>[e(n,{modelValue:t.mgr_name,"onUpdate:modelValue":l[4]||(l[4]=a=>t.mgr_name=a),placeholder:"选择或搜索管理人",clearable:"",filterable:"",style:{width:"180px"}},{default:o(()=>[(u(!0),f(V,null,k(T.value,a=>(u(),b(i,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"名称关键词"},{default:o(()=>[e(q,{modelValue:t.name,"onUpdate:modelValue":l[5]||(l[5]=a=>t.name=a),placeholder:"支持模糊搜索",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),e(S,{class:"table-card"},{default:o(()=>[Y((u(),b(j,{data:E.value,border:"",style:{width:"100%"}},{default:o(()=>[e(c,{prop:"extname",label:"ETF简称","min-width":"160",align:"center"}),e(c,{prop:"ts_code",label:"ETF代码","min-width":"140",align:"center"}),e(c,{prop:"index_name",label:"跟踪指数","min-width":"160",align:"center"}),e(c,{prop:"index_code",label:"指数代码","min-width":"140",align:"center"},{default:o(({row:a})=>[e(R,{type:"primary",underline:!1,onClick:ie=>$(a.index_code)},{default:o(()=>[w(ee(a.index_code),1)]),_:2},1032,["onClick"])]),_:1}),e(c,{prop:"exchange",label:"交易所","min-width":"80",align:"center"}),e(c,{prop:"csname",label:"基金简称","min-width":"160",align:"center"}),e(c,{prop:"etf_type",label:"ETF类型","min-width":"120",align:"center"}),e(c,{prop:"mgt_fee",label:"管理费率","min-width":"100",align:"center"}),e(c,{prop:"list_date",label:"上市日期","min-width":"120",align:"center"}),e(c,{prop:"delist_date",label:"退市日期","min-width":"120",align:"center"}),e(c,{prop:"custod_name",label:"托管人","min-width":"180",align:"center"})]),_:1},8,["data"])),[[H,v.value]]),x("div",se,[e(G,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:d.total,"page-sizes":[10,20,50,100],"page-size":d.page_size,"onUpdate:pageSize":l[6]||(l[6]=a=>d.page_size=a),"current-page":d.page,"onUpdate:currentPage":l[7]||(l[7]=a=>d.page=a),onSizeChange:L,onCurrentChange:P},null,8,["total","page-size","current-page"])])]),_:1})])}}}),ue=le(de,[["__scopeId","data-v-224dfdaf"]]);export{ue as default};
