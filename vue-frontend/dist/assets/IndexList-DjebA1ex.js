import{d as T,a as b,r as z,y as j,D as q,G,c as C,b as w,e,w as o,i as c,E as L,F as H,A as W,f as Z,aa as I,k as m,l as J,O as Q,g as E,t as D,u as X,o as g,_ as Y}from"./index-Cmt4OYPI.js";import{f as ee}from"./indexBasicApi-BQvVLKXi.js";const te={class:"index-list","element-loading-text":"正在加载指数数据..."},ae={class:"search-section"},le={class:"table-section"},oe={class:"table-header"},ne={key:0,class:"total-count"},se={key:0,class:"pagination-wrapper"},re=T({__name:"IndexList",setup(ie){const U=X(),u=b(!1),x=b([]),k=b([]),S=b([]),n=z({current_page:1,total_count:0,page_size:20}),s=z({search:"",code:"",market:"SSE",category:""}),f=async()=>{u.value=!0;try{const a=await ee({market:s.market||void 0});x.value=a;const t=new Set;a.forEach(r=>{r.category&&t.add(r.category)}),S.value=Array.from(t).sort(),h()}catch(a){console.error("获取指数列表失败:",a),L.error("网络请求失败，请稍后重试")}finally{u.value=!1}},h=()=>{let a=[...x.value];const t=s.search.trim().toLowerCase(),r=s.code.trim().toLowerCase(),_=s.category;_&&(a=a.filter(i=>i.category===_)),t&&(a=a.filter(i=>i.ts_code&&i.ts_code.toLowerCase().includes(t)||i.name&&i.name.toLowerCase().includes(t))),r&&(a=a.filter(i=>i.ts_code&&i.ts_code.toLowerCase()===r)),n.total_count=a.length;const d=(n.current_page-1)*n.page_size,y=d+n.page_size;k.value=a.slice(d,y)},v=()=>{n.current_page=1,h()},B=()=>{s.search="",s.code="",s.market="SSE",s.category="",n.current_page=1,f()},K=()=>{f()},M=a=>{n.page_size=a,n.current_page=1,h()},N=a=>{n.current_page=a,h()},A=a=>{U.push({path:"/analysis/index-analysis",query:{ts_code:a.ts_code,market:a.market}}),L.success(`正在跳转到指数分析: ${a.name||""} (${a.ts_code})`)};return j(()=>{f()}),(a,t)=>{const r=c("el-option"),_=c("el-select"),d=c("el-form-item"),y=c("el-input"),i=c("el-button"),F=c("el-form"),V=c("el-card"),O=c("el-tag"),p=c("el-table-column"),$=c("el-table"),P=c("el-pagination"),R=G("loading");return q((g(),C("div",te,[w("div",ae,[e(V,{shadow:"hover"},{default:o(()=>[e(F,{model:s,inline:"",class:"search-form"},{default:o(()=>[e(d,{label:"市场"},{default:o(()=>[e(_,{modelValue:s.market,"onUpdate:modelValue":t[0]||(t[0]=l=>s.market=l),placeholder:"选择市场",style:{width:"160px"},clearable:"",onChange:f},{default:o(()=>[e(r,{label:"MSCI指数",value:"MSCI"}),e(r,{label:"中证指数",value:"CSI"}),e(r,{label:"上交所指数",value:"SSE"}),e(r,{label:"深交所指数",value:"SZSE"}),e(r,{label:"中金指数",value:"CICC"}),e(r,{label:"申万指数",value:"SW"}),e(r,{label:"其他指数",value:"OTH"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"类别"},{default:o(()=>[e(_,{modelValue:s.category,"onUpdate:modelValue":t[1]||(t[1]=l=>s.category=l),placeholder:"选择类别",style:{width:"160px"},clearable:"",onChange:v},{default:o(()=>[(g(!0),C(H,null,W(S.value,l=>(g(),Z(r,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"搜索关键词"},{default:o(()=>[e(y,{modelValue:s.search,"onUpdate:modelValue":t[2]||(t[2]=l=>s.search=l),placeholder:"输入指数代码或名称",clearable:"",style:{width:"200px"},onKeyup:I(v,["enter"])},null,8,["modelValue"])]),_:1}),e(d,{label:"指数代码"},{default:o(()=>[e(y,{modelValue:s.code,"onUpdate:modelValue":t[3]||(t[3]=l=>s.code=l),placeholder:"精确匹配指数代码",clearable:"",style:{width:"150px"},onKeyup:I(v,["enter"])},null,8,["modelValue"])]),_:1}),e(d,null,{default:o(()=>[e(i,{type:"primary",onClick:v,loading:u.value},{default:o(()=>[...t[6]||(t[6]=[m(" 搜索 ",-1)])]),_:1},8,["loading"]),e(i,{onClick:B},{default:o(()=>[...t[7]||(t[7]=[m("重置",-1)])]),_:1}),e(i,{onClick:K,loading:u.value,icon:J(Q)},{default:o(()=>[...t[8]||(t[8]=[m(" 刷新 ",-1)])]),_:1},8,["loading","icon"])]),_:1})]),_:1},8,["model"])]),_:1})]),w("div",le,[e(V,{shadow:"hover"},{header:o(()=>[w("div",oe,[t[9]||(t[9]=w("span",null,"指数数据列表",-1)),n.total_count?(g(),C("span",ne," 共 "+D(n.total_count)+" 条记录 ",1)):E("",!0)])]),default:o(()=>[e($,{data:k.value,stripe:"",border:"",style:{width:"100%"},"empty-text":u.value?"正在加载...":"暂无数据"},{default:o(()=>[e(p,{prop:"ts_code",label:"指数代码",width:"200",align:"center"},{default:o(({row:l})=>[e(O,{type:"primary"},{default:o(()=>[m(D(l.ts_code),1)]),_:2},1024)]),_:1}),e(p,{prop:"name",label:"指数名称","min-width":"200",align:"center","show-overflow-tooltip":""}),e(p,{prop:"market",label:"市场",width:"100",align:"center"}),e(p,{prop:"publisher",label:"发布商",width:"150","show-overflow-tooltip":""}),e(p,{prop:"category",label:"类别",width:"120",align:"center"}),e(p,{label:"操作",width:"100",align:"center",fixed:"right"},{default:o(({row:l})=>[e(i,{type:"primary",link:"",size:"small",onClick:ce=>A(l)},{default:o(()=>[...t[10]||(t[10]=[m(" 查看详情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","empty-text"]),n.total_count>0?(g(),C("div",se,[e(P,{"current-page":n.current_page,"onUpdate:currentPage":t[4]||(t[4]=l=>n.current_page=l),"page-size":n.page_size,"onUpdate:pageSize":t[5]||(t[5]=l=>n.page_size=l),"page-sizes":[10,20,50,100],total:n.total_count,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:M,onCurrentChange:N},null,8,["current-page","page-size","total"])])):E("",!0)]),_:1})])])),[[R,u.value]])}}}),pe=Y(re,[["__scopeId","data-v-9bc50d9c"]]);export{pe as default};
