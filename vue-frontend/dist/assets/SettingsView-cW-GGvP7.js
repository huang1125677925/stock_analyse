import{d as N,a as g,x as m,A as S,c as y,e as t,w as a,i,a8 as F,E as c,C as M,D as T,f as A,F as $,b as _,k as r,t as d,a9 as j,o as p,_ as q}from"./index-D1GCCknF.js";const z={class:"invitation-management"},G={class:"invitation-header"},H={class:"invite-stats"},J=N({__name:"SettingsView",setup(K){const s=g([]),v=g(!1),f=g(!1),h=m(()=>s.value.filter(e=>e.is_used).length),C=m(()=>s.value.filter(e=>!e.is_used).length),b=m(()=>s.value.length),k=async()=>{v.value=!0;try{const e=await F();s.value=e}catch(e){console.error("获取邀请码列表失败:",e),c.error("获取邀请码列表失败")}finally{v.value=!1}},x=async()=>{f.value=!0;try{const e=await j();c.success("邀请码生成成功"),s.value.unshift(e)}catch(e){console.error("生成邀请码失败:",e),c.error("生成邀请码失败")}finally{f.value=!1}},I=e=>{navigator.clipboard.writeText(e).then(()=>{c.success("邀请码已复制到剪贴板")}).catch(()=>{c.error("复制失败，请手动复制")})};return S(()=>{k()}),(e,n)=>{const w=i("el-button"),V=i("el-empty"),u=i("el-tag"),l=i("el-table-column"),B=i("el-table"),D=i("el-card"),E=T("loading");return p(),y("div",z,[t(D,null,{header:a(()=>[_("div",G,[n[1]||(n[1]=_("span",null,"邀请码管理",-1)),t(w,{type:"primary",onClick:x,loading:f.value},{default:a(()=>[...n[0]||(n[0]=[r(" 生成邀请码 ",-1)])]),_:1},8,["loading"])])]),default:a(()=>[M((p(),y("div",null,[s.value.length===0?(p(),A(V,{key:0,description:"暂无邀请码"})):(p(),y($,{key:1},[_("div",H,[t(u,{type:"danger"},{default:a(()=>[r("已使用："+d(h.value),1)]),_:1}),t(u,{type:"success",class:"stats-gap"},{default:a(()=>[r("未使用："+d(C.value),1)]),_:1}),t(u,{class:"stats-gap"},{default:a(()=>[r("总数："+d(b.value),1)]),_:1})]),t(B,{data:s.value,style:{width:"100%"}},{default:a(()=>[t(l,{prop:"code",label:"邀请码",width:"180"}),t(l,{label:"状态",width:"120"},{default:a(o=>[t(u,{type:o.row.is_used?"info":"success"},{default:a(()=>[r(d(o.row.is_used?"已使用":"未使用"),1)]),_:2},1032,["type"])]),_:1}),t(l,{label:"使用者",width:"150"},{default:a(o=>[_("span",null,d(o.row.used_by||"-"),1)]),_:1}),t(l,{prop:"created_at",label:"创建时间",width:"180"}),t(l,{prop:"expires_at",label:"过期时间",width:"180"}),t(l,{label:"操作"},{default:a(o=>[t(w,{type:"primary",link:"",onClick:L=>I(o.row.code),disabled:o.row.is_used},{default:a(()=>[...n[2]||(n[2]=[r(" 复制 ",-1)])]),_:2},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data"])],64))])),[[E,v.value]])]),_:1})])}}}),P=q(J,[["__scopeId","data-v-44349c9c"]]);export{P as default};
