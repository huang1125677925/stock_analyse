import{x as W,d as Z,z as C,a as M,y as G,c as i,e as a,f as y,g as E,w as l,i as s,E as I,b,k as v,F as h,A as w,t as N,o as r,_ as J}from"./index-orgCiLiJ.js";async function K(U,p={}){return await W.get("/django/api/strategy/individual-analysis/actual-rise-ratio/",{params:{start_date:p.startDate,end_date:p.endDate,prediction_type:p.predictionType}})}const X={class:"ml-index-validation"},ee={class:"card-header"},te={class:"actions"},ae={class:"card-header"},le={key:0,class:"summary"},oe={key:1,class:"table-wrapper"},ne={key:2,class:"kv-wrapper"},se={key:0},re=Z({__name:"MlIndexPredictionValidation",setup(U){const p=C(()=>window.innerWidth<768),n=M({stockCode:"",startDate:"",endDate:"",predictionType:""}),k=M(!1),d=M(null),F=C(()=>!d.value||!Array.isArray(d.value.data)||d.value.data.length===0?[]:Object.keys(d.value.data[0]??{})),P={market:"市场",code:"代码",name:"名称",trade_date:"交易日期",predict_rise_prob:"预测上涨概率",confidence:"置信度",actual_rise_ratio_5d:"5日实际上涨比例(未满5天则按实际天数计算)",prediction_type:"预测类型",created_at:"创建时间"},j=C(()=>{const t=[];if(!d.value)return t;const e=d.value.data;return e&&typeof e=="object"&&(e.stock_code&&t.push({label:"代码",value:e.stock_code}),e.start_date&&t.push({label:"开始日期",value:e.start_date}),e.end_date&&t.push({label:"结束日期",value:e.end_date}),e.prediction_type&&t.push({label:"预测类型",value:e.prediction_type}),typeof e.count=="number"&&t.push({label:"记录数",value:e.count}),typeof e.total=="number"&&t.push({label:"总条数",value:e.total})),t});function R(t){return["string","number","boolean"].includes(typeof t)||t===null||t===void 0}function $(t){return Array.isArray(t)?t.map(e=>typeof e=="object"&&e?e:{value:e}):typeof t=="object"&&t?Object.entries(t).map(([e,u])=>({key:e,value:u})):[{value:t}]}function L(t){if(Array.isArray(t)){const e=t.find(u=>typeof u=="object"&&u);return e?Object.keys(e):["value"]}return typeof t=="object"&&t?["key","value"]:["value"]}async function A(){n.value.stockCode||(n.value.stockCode=""),k.value=!0;try{const t=m=>{const f=m.getFullYear(),x=String(m.getMonth()+1).padStart(2,"0"),g=String(m.getDate()).padStart(2,"0");return`${f}-${x}-${g}`},e=new Date,u=new Date(e);u.setDate(e.getDate()-6);const V=t(u),_=t(e),c=await K(n.value.stockCode,{startDate:n.value.startDate||V,endDate:n.value.endDate||_,predictionType:n.value.predictionType||void 0});d.value=c,I.success("查询成功")}catch{I.error("查询失败，请稍后重试")}finally{k.value=!1}}function q(){n.value={stockCode:"",startDate:"",endDate:"",predictionType:""},d.value=null}return G(()=>{A()}),(t,e)=>{const u=s("el-tag"),V=s("el-input"),_=s("el-form-item"),c=s("el-col"),m=s("el-date-picker"),f=s("el-option"),x=s("el-select"),g=s("el-button"),H=s("el-row"),Q=s("el-form"),S=s("el-card"),T=s("el-descriptions-item"),z=s("el-descriptions"),O=s("el-table-column"),B=s("el-table");return r(),i("div",X,[a(S,{class:"query-card",shadow:"hover"},{header:l(()=>[b("div",ee,[e[5]||(e[5]=b("span",null,"指数预测验证查询",-1)),a(u,{type:"success",size:"small"},{default:l(()=>[...e[4]||(e[4]=[v("5日实际上涨比例",-1)])]),_:1})])]),default:l(()=>[a(Q,{model:n.value,"label-position":"right","label-width":"120px",inline:!1},{default:l(()=>[a(H,{gutter:12},{default:l(()=>[a(c,{xs:24,sm:12,md:8},{default:l(()=>[a(_,{label:"代码（TS）"},{default:l(()=>[a(V,{modelValue:n.value.stockCode,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value.stockCode=o),placeholder:"例如：000001.SH 或 399001.SZ"},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{xs:24,sm:12,md:8},{default:l(()=>[a(_,{label:"开始日期"},{default:l(()=>[a(m,{modelValue:n.value.startDate,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.startDate=o),type:"date",placeholder:"选择开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{xs:24,sm:12,md:8},{default:l(()=>[a(_,{label:"结束日期"},{default:l(()=>[a(m,{modelValue:n.value.endDate,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.endDate=o),type:"date",placeholder:"选择结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{xs:24,sm:12,md:8},{default:l(()=>[a(_,{label:"预测类型"},{default:l(()=>[a(x,{modelValue:n.value.predictionType,"onUpdate:modelValue":e[3]||(e[3]=o=>n.value.predictionType=o),placeholder:"可选：后端支持类型"},{default:l(()=>[a(f,{label:"macd_xgb",value:"macd_xgb"}),a(f,{label:"svm",value:"svm"}),a(f,{label:"lr",value:"lr"}),a(f,{label:"auto",value:"auto"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(c,{xs:24,sm:24,md:8},{default:l(()=>[b("div",te,[a(g,{type:"primary",loading:k.value,onClick:A},{default:l(()=>[...e[6]||(e[6]=[v("查询",-1)])]),_:1},8,["loading"]),a(g,{onClick:q},{default:l(()=>[...e[7]||(e[7]=[v("重置",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),d.value?(r(),y(S,{key:0,class:"result-card",shadow:"never"},{header:l(()=>[b("div",ae,[e[9]||(e[9]=b("span",null,"查询结果",-1)),a(u,{type:"info",size:"small"},{default:l(()=>[...e[8]||(e[8]=[v("动态渲染",-1)])]),_:1})])]),default:l(()=>[j.value.length?(r(),i("div",le,[a(z,{column:p.value?1:3,border:""},{default:l(()=>[(r(!0),i(h,null,w(j.value,(o,D)=>(r(),y(T,{key:D,label:o.label},{default:l(()=>[v(N(o.value),1)]),_:2},1032,["label"]))),128))]),_:1},8,["column"])])):E("",!0),Array.isArray(d.value.data)?(r(),i("div",oe,[a(B,{data:d.value.data,stripe:"",size:"small"},{default:l(()=>[(r(!0),i(h,null,w(F.value,o=>(r(),y(O,{key:o,prop:o,label:P[o]||o,"min-width":120,align:"center",sortable:""},null,8,["prop","label"]))),128))]),_:1},8,["data"])])):(r(),i("div",ne,[a(z,{column:p.value?1:2,border:""},{default:l(()=>[(r(!0),i(h,null,w(d.value.data,(o,D)=>(r(),y(T,{key:D,label:D,align:"center"},{default:l(()=>[R(o)?(r(),i("span",se,N(o),1)):(r(),y(B,{key:1,data:$(o),size:"small",style:{width:"100%"}},{default:l(()=>[(r(!0),i(h,null,w(L(o),Y=>(r(),y(O,{key:Y,prop:Y,label:Y,"min-width":120,align:"center"},null,8,["prop","label"]))),128))]),_:2},1032,["data"]))]),_:2},1032,["label"]))),128))]),_:1},8,["column"])]))]),_:1})):E("",!0)])}}}),ue=J(re,[["__scopeId","data-v-ab3eb1da"]]);export{ue as default};
