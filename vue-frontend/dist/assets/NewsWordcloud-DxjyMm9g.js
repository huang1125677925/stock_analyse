import{J as L,d as U,a as v,x as z,z as O,c as V,e as t,w as o,b as n,i as r,o as m,_ as E,A as R,C as j,D as J,f as T,E as W,k as B,g as F,F as K,y as P,K as Q,t as x}from"./index-B1jiIi42.js";async function G(D){return(await L.get("/django/api/news/wordcloud/",{params:D})).data}const H={class:"word-frequency-table"},X={class:"table-header"},Z={class:"actions"},ee={class:"table-footer"},I=10,te=U({__name:"WordFrequencyTable",props:{words:{}},setup(D){const u=D,f=v(""),w=v("desc"),p=v(1),c=z(()=>{const d=f.value.trim();return[...d?u.words.filter(i=>i.word.includes(d)):u.words].sort((i,g)=>w.value==="desc"?g.count-i.count:i.count-g.count)}),_=z(()=>{const d=(p.value-1)*I;return c.value.slice(d,d+I)});function C({prop:d,order:l}){d!=="count"||!l||(w.value=l==="descending"?"desc":"asc")}return O(()=>u.words,()=>{p.value=1}),(d,l)=>{const S=r("el-input"),i=r("el-table-column"),g=r("el-table"),N=r("el-pagination"),a=r("el-card");return m(),V("div",H,[t(a,{shadow:"never"},{header:o(()=>[n("div",X,[l[2]||(l[2]=n("span",null,"词频统计列表",-1)),n("div",Z,[t(S,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),placeholder:"搜索词",clearable:"",style:{width:"220px"}},null,8,["modelValue"])])])]),default:o(()=>[t(g,{data:_.value,style:{width:"100%"},stripe:"",border:"",onSortChange:C},{default:o(()=>[t(i,{type:"index",label:"#",width:"80"}),t(i,{prop:"word",label:"词","min-width":"180"}),t(i,{prop:"count",label:"频次",width:"120",sortable:"custom"})]),_:1},8,["data"]),n("div",ee,[t(N,{background:"",layout:"prev, pager, next, total",total:c.value.length,"page-size":I,"current-page":p.value,onCurrentChange:l[1]||(l[1]=e=>p.value=e)},null,8,["total","current-page"])])]),_:1})])}}}),ne=E(te,[["__scopeId","data-v-677f29f3"]]),ae={class:"news-wordcloud-view"},oe={class:"query-form"},le={class:"panel-header"},se={key:0,class:"stats"},re={key:0,class:"wordcloud-container"},ue=["title"],de=U({__name:"NewsWordcloud",setup(D){const u=v(null),f=v(100),w=v(3),p=v(!1),c=v([]),_=v(null);function C(a){return a.toISOString().split("T")[0]}function d(){const a=new Date,e=new Date(Date.now()-720*60*60*1e3);u.value=[C(e),C(a)]}async function l(){if(!u.value||u.value.length!==2){W.warning("请选择日期范围");return}p.value=!0;try{const[a,e]=u.value,y=await G({start_date:a,end_date:e,top_n:f.value,min_len:w.value});c.value=y.words||[],_.value=y}catch(a){console.error("加载新闻词云失败:",a),W.error("加载新闻词云失败")}finally{p.value=!1}}function S(){d(),f.value=100,w.value=2}const i=z(()=>c.value.reduce((a,e)=>Math.max(a,e.count),0)),g=z(()=>c.value.reduce((a,e)=>Math.min(a,e.count),1/0));function N(a){const k=g.value===1/0?0:g.value,h=i.value||1,b=h===k?.5:(a.count-k)/(h-k),M=Math.round(12+b*30),q=Math.round(200-b*160),$=70,Y=45+Math.round((1-b)*15),s=Math.random()<.1?Math.random()<.5?-10:10:0;return{fontSize:M+"px",color:`hsl(${q}, ${$}%, ${Y}%)`,transform:`rotate(${s}deg)`}}return R(()=>{d(),l()}),(a,e)=>{const y=r("el-card"),k=r("el-date-picker"),h=r("el-form-item"),b=r("el-input-number"),M=r("el-button"),q=r("el-form"),$=r("el-empty"),Y=J("loading");return m(),V("div",ae,[t(y,{shadow:"hover",class:"page-header"},{default:o(()=>[...e[3]||(e[3]=[n("div",{class:"header-content"},[n("h2",null,"新闻利好分析词云统计"),n("p",null,"统计指定日期范围内 CCTV 新闻 AI 内容的高频词，用于词云展示。")],-1)])]),_:1}),t(y,{shadow:"hover",class:"query-panel"},{header:o(()=>[...e[4]||(e[4]=[n("div",{class:"panel-header"},[n("span",null,"查询条件")],-1)])]),default:o(()=>[n("div",oe,[t(q,{inline:!0,"label-width":"80px"},{default:o(()=>[t(h,{label:"日期范围"},{default:o(()=>[t(k,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),t(h,{label:"Top N"},{default:o(()=>[t(b,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=s=>f.value=s),min:1,max:500},null,8,["modelValue"])]),_:1}),t(h,{label:"最小长度"},{default:o(()=>[t(b,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=s=>w.value=s),min:1,max:10},null,8,["modelValue"])]),_:1}),t(h,null,{default:o(()=>[t(M,{type:"primary",loading:p.value,onClick:l},{default:o(()=>[...e[5]||(e[5]=[B("查询",-1)])]),_:1},8,["loading"]),t(M,{onClick:S},{default:o(()=>[...e[6]||(e[6]=[B("重置",-1)])]),_:1})]),_:1})]),_:1})])]),_:1}),j((m(),T(y,{shadow:"hover",class:"result-panel"},{header:o(()=>[n("div",le,[e[9]||(e[9]=n("span",null,"词云结果",-1)),_.value?(m(),V("div",se,[n("span",null,"词总数："+x(_.value.total),1),e[7]||(e[7]=n("span",{class:"divider"},"|",-1)),n("span",null,"区间："+x(_.value.query.start_date)+" 至 "+x(_.value.query.end_date),1),e[8]||(e[8]=n("span",{class:"divider"},"|",-1)),n("span",null,"TopN："+x(_.value.query.top_n)+" 最小长度："+x(_.value.query.min_len),1)])):F("",!0)])]),default:o(()=>[c.value.length>0?(m(),V("div",re,[(m(!0),V(K,null,P(c.value,(s,A)=>(m(),V("span",{key:s.word+"_"+A,class:"word-item",style:Q(N(s)),title:s.word+"："+s.count},x(s.word),13,ue))),128))])):F("",!0),c.value.length>0?(m(),T(ne,{key:1,words:c.value},null,8,["words"])):(m(),T($,{key:2,description:"暂无数据，请调整查询条件","image-size":200}))]),_:1})),[[Y,p.value]])])}}}),ie=E(de,[["__scopeId","data-v-1ec92205"]]);export{ie as default};
