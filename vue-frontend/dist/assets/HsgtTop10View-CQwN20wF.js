import{x as I,d as L,a as D,r as O,z as q,y as J,c as K,e,w as o,i as d,E as P,b as c,l as T,O as Q,k as i,M as W,f as V,g as X,D as U,G as Z,t as _,L as A,o as h,_ as ee}from"./index-orgCiLiJ.js";async function te(w){return(await I.get("/django/api/tasks/hsgt-top10/",{params:w})).data}const ae={class:"hsgt-top10-view"},le={class:"header-content"},oe={class:"header-actions"},ne={class:"card-header"},se=L({__name:"HsgtTop10View",setup(w){const p=D(!1),b=D([]),M=D("summary");function k(l){const t=l.getFullYear(),u=(l.getMonth()+1).toString().padStart(2,"0"),s=l.getDate().toString().padStart(2,"0");return`${t}${u}${s}`}const E=()=>k(new Date),r=O({market_type:1,ts_code:"",start_date:(l=>k(new Date(Date.now()-l*24*60*60*1e3)))(30),end_date:E(),trade_date:void 0,fields:void 0}),B=q(()=>{const l=new Map;return b.value.forEach(t=>{const u=t.ts_code;l.has(u)||l.set(u,{ts_code:u,name:t.name,count:0,total_net_amount:0,total_buy:0,total_sell:0,total_amount:0,latest_close:t.close,latest_date:t.trade_date});const s=l.get(u);s.count+=1,s.total_net_amount+=Number(t.net_amount)||0,s.total_buy+=Number(t.buy)||0,s.total_sell+=Number(t.sell)||0,s.total_amount+=Number(t.amount)||0,t.trade_date>s.latest_date&&(s.latest_date=t.trade_date,s.latest_close=t.close)}),Array.from(l.values())});function m(l){return l?(l/1e8).toFixed(2):"0.00"}function x(l){return l>0?"text-red":l<0?"text-green":""}function H(l){if(l.records&&Array.isArray(l.records))return l.records;if(l.fields&&l.items){const t=l.fields;return l.items.map(u=>{const s={};return t.forEach((y,g)=>{s[y]=u[g]}),s})}return[]}async function v(){p.value=!0;try{const l=await te({...r}),t=H(l);b.value=t}catch(l){P.error(l?.message||"数据加载失败")}finally{p.value=!1}}function z(){v()}function $(){v()}return J(()=>{v()}),(l,t)=>{const u=d("el-button"),s=d("el-card"),y=d("el-option"),g=d("el-select"),f=d("el-form-item"),j=d("el-input"),Y=d("el-date-picker"),F=d("el-form"),n=d("el-table-column"),S=d("el-table"),C=d("el-tab-pane"),R=d("el-tabs"),G=d("el-empty"),N=Z("loading");return h(),K("div",ae,[e(s,{class:"page-header"},{default:o(()=>[c("div",le,[t[7]||(t[7]=c("h2",null,"沪深股通十大成交股",-1)),c("div",oe,[e(u,{type:"primary",icon:T(Q),onClick:$,loading:p.value},{default:o(()=>[...t[6]||(t[6]=[i("刷新",-1)])]),_:1},8,["icon","loading"])])])]),_:1}),e(s,{class:"search-section"},{header:o(()=>[c("div",ne,[t[9]||(t[9]=c("span",null,"查询条件",-1)),e(u,{type:"primary",link:"",icon:T(W),onClick:z},{default:o(()=>[...t[8]||(t[8]=[i("搜索",-1)])]),_:1},8,["icon"])])]),default:o(()=>[e(F,{inline:!0,model:r,"label-width":"100px"},{default:o(()=>[e(f,{label:"市场类型"},{default:o(()=>[e(g,{modelValue:r.market_type,"onUpdate:modelValue":t[0]||(t[0]=a=>r.market_type=a),placeholder:"选择市场",style:{width:"160px"}},{default:o(()=>[e(y,{label:"上交所(1)",value:"1"}),e(y,{label:"深交所(3)",value:"3"})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"股票代码"},{default:o(()=>[e(j,{modelValue:r.ts_code,"onUpdate:modelValue":t[1]||(t[1]=a=>r.ts_code=a),placeholder:"选填，如 600000.SH",clearable:""},null,8,["modelValue"])]),_:1}),e(f,{label:"开始日期"},{default:o(()=>[e(Y,{modelValue:r.start_date,"onUpdate:modelValue":t[2]||(t[2]=a=>r.start_date=a),type:"date",format:"YYYYMMDD","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),e(f,{label:"结束日期"},{default:o(()=>[e(Y,{modelValue:r.end_date,"onUpdate:modelValue":t[3]||(t[3]=a=>r.end_date=a),type:"date",format:"YYYYMMDD","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),e(f,{label:"交易日期"},{default:o(()=>[e(Y,{modelValue:r.trade_date,"onUpdate:modelValue":t[4]||(t[4]=a=>r.trade_date=a),type:"date",format:"YYYYMMDD","value-format":"YYYYMMDD",placeholder:"单日查询"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),e(s,{class:"table-section"},{default:o(()=>[e(R,{modelValue:M.value,"onUpdate:modelValue":t[5]||(t[5]=a=>M.value=a)},{default:o(()=>[e(C,{label:"汇总统计",name:"summary"},{default:o(()=>[U((h(),V(S,{data:B.value,height:"560",style:{width:"100%"},"default-sort":{prop:"total_net_amount",order:"descending"}},{default:o(()=>[e(n,{type:"index",label:"序号",width:"60"}),e(n,{prop:"ts_code",label:"代码",width:"100"}),e(n,{prop:"name",label:"名称",width:"100"}),e(n,{prop:"count",label:"上榜次数",width:"100",sortable:""}),e(n,{prop:"total_net_amount",label:"净买入额(亿)","min-width":"140",sortable:""},{default:o(({row:a})=>[c("span",{class:A(x(a.total_net_amount))},_(m(a.total_net_amount)),3)]),_:1}),e(n,{prop:"total_buy",label:"买入额(亿)","min-width":"140",sortable:""},{default:o(({row:a})=>[i(_(m(a.total_buy)),1)]),_:1}),e(n,{prop:"total_sell",label:"卖出额(亿)","min-width":"140",sortable:""},{default:o(({row:a})=>[i(_(m(a.total_sell)),1)]),_:1}),e(n,{prop:"total_amount",label:"成交总额(亿)","min-width":"140",sortable:""},{default:o(({row:a})=>[i(_(m(a.total_amount)),1)]),_:1}),e(n,{prop:"latest_close",label:"最新收盘价",width:"120"},{default:o(({row:a})=>[i(_(a.latest_close)+" ("+_(a.latest_date)+") ",1)]),_:1})]),_:1},8,["data"])),[[N,p.value]])]),_:1}),e(C,{label:"明细数据",name:"detail"},{default:o(()=>[U((h(),V(S,{data:b.value,height:"560",style:{width:"100%"}},{default:o(()=>[e(n,{prop:"trade_date",label:"交易日期",width:"100",sortable:""}),e(n,{prop:"ts_code",label:"代码",width:"100"}),e(n,{prop:"name",label:"名称",width:"100"}),e(n,{prop:"close",label:"收盘价",width:"100"}),e(n,{prop:"change",label:"涨跌幅",width:"100"}),e(n,{prop:"rank",label:"排名",width:"80",sortable:""}),e(n,{prop:"net_amount",label:"净买入(亿)","min-width":"120",sortable:""},{default:o(({row:a})=>[c("span",{class:A(x(a.net_amount))},_(m(a.net_amount)),3)]),_:1}),e(n,{prop:"buy",label:"买入(亿)","min-width":"120",sortable:""},{default:o(({row:a})=>[i(_(m(a.buy)),1)]),_:1}),e(n,{prop:"sell",label:"卖出(亿)","min-width":"120",sortable:""},{default:o(({row:a})=>[i(_(m(a.sell)),1)]),_:1}),e(n,{prop:"amount",label:"成交额(亿)","min-width":"120",sortable:""},{default:o(({row:a})=>[i(_(m(a.amount)),1)]),_:1}),e(n,{prop:"market_type",label:"市场",width:"80"},{default:o(({row:a})=>[i(_(a.market_type==="1"?"沪":"深"),1)]),_:1})]),_:1},8,["data"])),[[N,p.value]])]),_:1})]),_:1},8,["modelValue"]),!p.value&&b.value.length===0?(h(),V(G,{key:0,description:"暂无数据"})):X("",!0)]),_:1})])}}}),ue=ee(se,[["__scopeId","data-v-36df2f13"]]);export{ue as default};
