import{x as S,d as j,a as c,y as q,f as v,w as n,i as o,e as l,D as N,k as D,G as $,c as E,A as T,F as U,b as z,o as m,_ as G}from"./index-B1jknyhk.js";async function I(g){return(await S.get("/django/api/tasks/broker-recommend/",{params:g})).data}const L=j({__name:"BrokerRecommendView",setup(g){const i=c(!1),r=c(null),b=c("last7d"),V=c({month:""}),_=c([]),p=c([]);function M(a){if(!a)return[];if(Array.isArray(a.records)&&a.records.length>0)return a.records;if(Array.isArray(a.items)&&Array.isArray(a.fields)){const e=a.fields;return a.items.map(t=>{const u={};return e.forEach((d,f)=>u[d]=t[f]),u})}return[]}async function y(){i.value=!0;try{const a=r.value&&r.value[1]?.slice(0,6)||"",e=await I({month:a}),t=M(e);_.value=t,p.value=t.length?Object.keys(t[0]):[]}finally{i.value=!1}}function R(){r.value=null,_.value=[],p.value=[]}function k(a){const e=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),u=String(a.getDate()).padStart(2,"0");return`${e}${t}${u}`}function h(a){const e=new Date,t=new Date;switch(a){case"last7d":t.setDate(e.getDate()-6);break;case"last1m":t.setMonth(e.getMonth()-1);break;case"last3m":t.setMonth(e.getMonth()-3);break;case"last6m":t.setMonth(e.getMonth()-6);break;case"last1y":t.setFullYear(e.getFullYear()-1);break;case"last3y":t.setFullYear(e.getFullYear()-3);break}r.value=[k(t),k(e)]}function Y(a){h(a)}return q(()=>{h("last7d"),y()}),(a,e)=>{const t=o("el-option"),u=o("el-select"),d=o("el-form-item"),f=o("el-date-picker"),w=o("el-button"),B=o("el-form"),x=o("el-table-column"),A=o("el-table"),C=o("el-card"),F=$("loading");return m(),v(C,{class:"page-card"},{header:n(()=>[...e[2]||(e[2]=[z("div",{class:"card-header"},"券商月度金股",-1)])]),default:n(()=>[l(B,{inline:!0,model:V.value,class:"query-form"},{default:n(()=>[l(d,{label:"快捷选择"},{default:n(()=>[l(u,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s),style:{width:"180px"},onChange:Y},{default:n(()=>[l(t,{label:"最近一周",value:"last7d"}),l(t,{label:"最近1月",value:"last1m"}),l(t,{label:"最近三月",value:"last3m"}),l(t,{label:"最近半年",value:"last6m"}),l(t,{label:"最近一年",value:"last1y"}),l(t,{label:"最近三年",value:"last3y"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"日期范围"},{default:n(()=>[l(f,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYYMMDD","unlink-panels":""},null,8,["modelValue"])]),_:1}),l(d,null,{default:n(()=>[l(w,{type:"primary",loading:i.value,onClick:y},{default:n(()=>[...e[3]||(e[3]=[D("查询",-1)])]),_:1},8,["loading"]),l(w,{onClick:R},{default:n(()=>[...e[4]||(e[4]=[D("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),N((m(),v(A,{data:_.value,border:"",stripe:"",style:{width:"100%"}},{default:n(()=>[(m(!0),E(U,null,T(p.value,s=>(m(),v(x,{key:s,prop:s,label:s,"min-width":"120"},null,8,["prop","label"]))),128))]),_:1},8,["data"])),[[F,i.value]])]),_:1})}}}),P=G(L,[["__scopeId","data-v-730336b4"]]);export{P as default};
