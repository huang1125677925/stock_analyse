import{x as N,d as j,a as b,r as O,y as T,c as k,e as t,w as a,i as s,E as F,b as d,l as M,O as I,k as w,M as Z,D as z,f as y,g as G,G as L,F as R,A as q,o as m,_ as J}from"./index-yvE1imiI.js";async function P(D){return(await N.get("/django/api/tasks/hk-hold/",{params:D})).data}const Q={class:"hk-hold-detail-view"},W={class:"header-content"},X={class:"header-actions"},$={class:"card-header"},ee=j({__name:"HkHoldDetailView",setup(D){const r=b(!1),p=b([]),V=b([]);function g(l){return l.toISOString().slice(0,10).replace(/-/g,"")}const H=()=>g(new Date),n=O({exchange:"HK",ts_code:"",start_date:(l=>g(new Date(Date.now()-l*24*60*60*1e3)))(7),end_date:H(),trade_date:void 0,fields:void 0});function S(l){if(l.records&&Array.isArray(l.records))return l.records;if(l.fields&&l.items){const e=l.fields;return l.items.map(_=>{const i={};return e.forEach((c,v)=>{i[c]=_[v]}),i})}return[]}async function f(){r.value=!0;try{const l=await P({...n}),e=S(l);p.value=e,V.value=e.length?Object.keys(e[0]):[]}catch(l){F.error(l?.message||"数据加载失败")}finally{r.value=!1}}function x(){f()}function C(){f()}return T(()=>{f()}),(l,e)=>{const _=s("el-button"),i=s("el-card"),c=s("el-option"),v=s("el-select"),u=s("el-form-item"),h=s("el-input"),Y=s("el-date-picker"),U=s("el-form"),A=s("el-table-column"),B=s("el-table"),E=s("el-empty"),K=L("loading");return m(),k("div",Q,[t(i,{class:"page-header"},{default:a(()=>[d("div",W,[e[7]||(e[7]=d("h2",null,"沪深港股通持股明细",-1)),d("div",X,[t(_,{type:"primary",icon:M(I),onClick:C,loading:r.value},{default:a(()=>[...e[6]||(e[6]=[w("刷新",-1)])]),_:1},8,["icon","loading"])])])]),_:1}),t(i,{class:"search-section"},{header:a(()=>[d("div",$,[e[9]||(e[9]=d("span",null,"查询条件",-1)),t(_,{type:"primary",link:"",icon:M(Z),onClick:x},{default:a(()=>[...e[8]||(e[8]=[w("搜索",-1)])]),_:1},8,["icon"])])]),default:a(()=>[t(U,{inline:!0,model:n,"label-width":"100px"},{default:a(()=>[t(u,{label:"交易所"},{default:a(()=>[t(v,{modelValue:n.exchange,"onUpdate:modelValue":e[0]||(e[0]=o=>n.exchange=o),placeholder:"选择交易所",style:{width:"160px"}},{default:a(()=>[t(c,{label:"港股通(HK)",value:"HK"}),t(c,{label:"沪股通(SH)",value:"SH"}),t(c,{label:"深股通(SZ)",value:"SZ"})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"TS代码"},{default:a(()=>[t(h,{modelValue:n.ts_code,"onUpdate:modelValue":e[1]||(e[1]=o=>n.ts_code=o),placeholder:"如 00700.HK / 600000.SH",clearable:""},null,8,["modelValue"])]),_:1}),t(u,{label:"开始日期"},{default:a(()=>[t(Y,{modelValue:n.start_date,"onUpdate:modelValue":e[2]||(e[2]=o=>n.start_date=o),type:"date",format:"YYYYMMDD","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),t(u,{label:"结束日期"},{default:a(()=>[t(Y,{modelValue:n.end_date,"onUpdate:modelValue":e[3]||(e[3]=o=>n.end_date=o),type:"date",format:"YYYYMMDD","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),t(u,{label:"交易日期"},{default:a(()=>[t(Y,{modelValue:n.trade_date,"onUpdate:modelValue":e[4]||(e[4]=o=>n.trade_date=o),type:"date",format:"YYYYMMDD","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),t(u,{label:"字段列表"},{default:a(()=>[t(h,{modelValue:n.fields,"onUpdate:modelValue":e[5]||(e[5]=o=>n.fields=o),placeholder:"逗号分隔，可留空",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),t(i,{class:"table-section"},{header:a(()=>[...e[10]||(e[10]=[d("div",{class:"card-header"},[d("span",null,"数据列表")],-1)])]),default:a(()=>[z((m(),y(B,{data:p.value,height:"560",style:{width:"100%"}},{default:a(()=>[(m(!0),k(R,null,q(V.value,o=>(m(),y(A,{key:o,prop:o,label:o,"min-width":"120"},null,8,["prop","label"]))),128))]),_:1},8,["data"])),[[K,r.value]]),!r.value&&p.value.length===0?(m(),y(E,{key:0,description:"暂无数据"})):G("",!0)]),_:1})])}}}),ae=J(ee,[["__scopeId","data-v-a1b74647"]]);export{ae as default};
