import{x as H,d as U,a as i,y as j,f as b,w as n,i as s,e as t,D as q,k as D,G as N,c as $,A as E,F as T,b as z,o as _,_ as G}from"./index-DeYthsa7.js";async function I(g){return(await H.get("/django/api/tasks/ccass-hold/",{params:g})).data}const K=U({__name:"CcassHoldView",setup(g){const m=i(!1),r=i(null),y=i("last7d"),u=i({}),f=i([]),v=i([]);function C(a){if(!a)return[];if(Array.isArray(a.records)&&a.records.length>0)return a.records;if(Array.isArray(a.items)&&Array.isArray(a.fields)){const e=a.fields;return a.items.map(l=>{const d={};return e.forEach((c,p)=>d[c]=l[p]),d})}return[]}async function k(){m.value=!0;try{const a={...u.value};r.value&&(a.start_date=r.value[0],a.end_date=r.value[1]);const e=await I(a),l=C(e);f.value=l,v.value=l.length?Object.keys(l[0]):[]}finally{m.value=!1}}function M(){u.value={},r.value=null,f.value=[],v.value=[]}function V(a){const e=a.getFullYear(),l=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0");return`${e}${l}${d}`}function h(a){const e=new Date,l=new Date;switch(a){case"last7d":l.setDate(e.getDate()-6);break;case"last1m":l.setMonth(e.getMonth()-1);break;case"last3m":l.setMonth(e.getMonth()-3);break;case"last6m":l.setMonth(e.getMonth()-6);break;case"last1y":l.setFullYear(e.getFullYear()-1);break;case"last3y":l.setFullYear(e.getFullYear()-3);break}r.value=[V(l),V(e)]}function Y(a){h(a)}return j(()=>{h("last7d"),k()}),(a,e)=>{const l=s("el-option"),d=s("el-select"),c=s("el-form-item"),p=s("el-input"),x=s("el-date-picker"),w=s("el-button"),A=s("el-form"),F=s("el-table-column"),R=s("el-table"),S=s("el-card"),B=N("loading");return _(),b(S,{class:"page-card"},{header:n(()=>[...e[4]||(e[4]=[z("div",{class:"card-header"},"中结持股汇总",-1)])]),default:n(()=>[t(A,{inline:!0,model:u.value,class:"query-form"},{default:n(()=>[t(c,{label:"快捷选择"},{default:n(()=>[t(d,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=o=>y.value=o),style:{width:"180px"},onChange:Y},{default:n(()=>[t(l,{label:"最近一周",value:"last7d"}),t(l,{label:"最近1月",value:"last1m"}),t(l,{label:"最近三月",value:"last3m"}),t(l,{label:"最近半年",value:"last6m"}),t(l,{label:"最近一年",value:"last1y"}),t(l,{label:"最近三年",value:"last3y"})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"股票代码"},{default:n(()=>[t(p,{modelValue:u.value.ts_code,"onUpdate:modelValue":e[1]||(e[1]=o=>u.value.ts_code=o),placeholder:"如 00960.HK 或 605009.SH",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"港交所代码"},{default:n(()=>[t(p,{modelValue:u.value.hk_code,"onUpdate:modelValue":e[2]||(e[2]=o=>u.value.hk_code=o),placeholder:"如 95009",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"日期范围"},{default:n(()=>[t(x,{modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYYMMDD","unlink-panels":""},null,8,["modelValue"])]),_:1}),t(c,null,{default:n(()=>[t(w,{type:"primary",loading:m.value,onClick:k},{default:n(()=>[...e[5]||(e[5]=[D("查询",-1)])]),_:1},8,["loading"]),t(w,{onClick:M},{default:n(()=>[...e[6]||(e[6]=[D("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),q((_(),b(R,{data:f.value,border:"",stripe:"",style:{width:"100%"}},{default:n(()=>[(_(!0),$(T,null,E(v.value,o=>(_(),b(F,{key:o,prop:o,label:o,"min-width":"120"},null,8,["prop","label"]))),128))]),_:1},8,["data"])),[[B,m.value]])]),_:1})}}}),O=G(K,[["__scopeId","data-v-1ef96cf2"]]);export{O as default};
