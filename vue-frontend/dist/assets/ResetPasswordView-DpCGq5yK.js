import{d as k,a as p,r as x,c as C,b as a,e as o,f as R,g as B,w as r,h as E,i as n,k as w,s as M,E as N,u as $,o as g,_ as q}from"./index-DghMyGCw.js";const F={class:"reset-password-container"},L={class:"reset-password-card"},U={class:"reset-password-footer"},h=k({__name:"ResetPasswordView",setup(z){const _=$(),c=p(),s=x({email:"",newPassword:"",confirmPassword:""}),m=p(!1),d=p(""),v={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:20,message:"密码长度必须在6-20个字符之间",trigger:"blur"},{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$/,message:"密码必须包含数字和字母，长度在6-20个字符之间",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:(i,e,t)=>{e!==s.newPassword?t(new Error("两次输入的密码不一致")):t()},trigger:"blur"}]};async function f(){try{d.value="",await c.value.validate(),m.value=!0,await M(s.email,s.newPassword),N.success("密码重置成功"),_.push("/login")}catch(i){console.error("重置密码过程中发生错误:",i),d.value=i.message||"重置密码失败，请稍后再试"}finally{m.value=!1}}return(i,e)=>{const t=n("el-input"),u=n("el-form-item"),b=n("el-button"),P=n("router-link"),V=n("el-form"),y=n("el-alert");return g(),C("div",F,[a("div",L,[e[7]||(e[7]=a("div",{class:"reset-password-header"},[a("h2",null,"重置密码"),a("p",null,"请输入您的邮箱和新密码")],-1)),o(V,{ref_key:"resetForm$",ref:c,model:s,rules:v,"label-position":"top",onSubmit:E(f,["prevent"])},{default:r(()=>[o(u,{label:"邮箱",prop:"email"},{default:r(()=>[o(t,{modelValue:s.email,"onUpdate:modelValue":e[0]||(e[0]=l=>s.email=l),placeholder:"请输入邮箱","prefix-icon":"Message"},null,8,["modelValue"])]),_:1}),o(u,{label:"新密码",prop:"newPassword"},{default:r(()=>[o(t,{modelValue:s.newPassword,"onUpdate:modelValue":e[1]||(e[1]=l=>s.newPassword=l),placeholder:"请输入新密码",type:"password","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),o(u,{label:"确认新密码",prop:"confirmPassword"},{default:r(()=>[o(t,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>s.confirmPassword=l),placeholder:"请再次输入新密码",type:"password","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),o(u,null,{default:r(()=>[o(b,{type:"primary",onClick:f,loading:m.value,class:"reset-button"},{default:r(()=>[...e[4]||(e[4]=[w(" 重置密码 ",-1)])]),_:1},8,["loading"])]),_:1}),a("div",U,[a("p",null,[e[6]||(e[6]=w("记起密码了？",-1)),o(P,{to:"/login"},{default:r(()=>[...e[5]||(e[5]=[w("返回登录",-1)])]),_:1})])])]),_:1},8,["model"]),d.value?(g(),R(y,{key:0,title:d.value,type:"error","show-icon":"",closable:!0,onClose:e[3]||(e[3]=l=>d.value="")},null,8,["title"])):B("",!0)])])}}}),Z=q(h,[["__scopeId","data-v-ce6771db"]]);export{Z as default};
