import{d as X,a as l,z as Y,y as Z,j as ee,E as g,D as te,c as z,e as a,w as n,i as s,b as d,F as ae,A as ne,f as L,l as y,K as oe,k as u,L as re,H as le,I as se,t as _,C as B,M as ie,u as ce,o as v,_ as de}from"./index-6CnVgsnb.js";import{g as ue}from"./individualStockApi-DUAPiQp3.js";import{a as pe}from"./industryAnalysisApi-BmV1iody.js";const _e={class:"stock-list-view"},ge={class:"header-content"},me={class:"header-actions"},he={class:"search-section"},fe={class:"table-container"},ve={class:"pagination-container"},be=X({__name:"StockListView",setup(we){const D=ce(),k=ee(),m=l(!1),C=l([]),h=l(""),p=l(""),x=l([]),M=l(""),$=l("asc"),i=l(1),b=l(10),S=l(0),E=Y(()=>C.value),c=async()=>{m.value=!0;try{const e=await ue({page:i.value,page_size:b.value,keyword:h.value,industry:p.value||void 0});C.value=e.data,S.value=e.total,g.success("股票数据加载成功")}catch(e){console.error("获取股票列表失败:",e),g.error("获取股票列表失败，请稍后重试")}finally{m.value=!1}},N=async()=>{try{const e=await pe();x.value=e.sectors}catch(e){console.error("获取行业列表失败:",e),g.error("获取行业列表失败")}},U=()=>{i.value=1,c()},F=()=>{i.value=1,c()},j=()=>{h.value="",p.value="",i.value=1,c()},q=({prop:e,order:o})=>{M.value=e||"",$.value=o==="ascending"?"asc":"desc"},H=e=>{b.value=e,i.value=1,c()},K=e=>{i.value=e,c()},P=e=>{D.push(`/stock-history/${e}`)},V=e=>e==null?"-":e>=1e11?(e/1e11).toFixed(2)+"千亿":e>=1e8?(e/1e8).toFixed(2)+"亿":e>=1e4?(e/1e4).toFixed(2)+"万":e.toString(),R=e=>e==null?"-":e>=1e8?(e/1e8).toFixed(2)+"亿手":e>=1e4?(e/1e4).toFixed(2)+"万手":e.toString()+"手";return Z(()=>{const e=k.query.industry;e&&(p.value=e,g.success(`已自动筛选行业：${e}`)),c(),N()}),te(()=>k.query.industry,e=>{e&&typeof e=="string"&&(p.value=e,i.value=1,c(),g.success(`已切换到行业：${e}`))},{immediate:!1}),(e,o)=>{const f=s("el-button"),A=s("el-option"),O=s("el-select"),w=s("el-form-item"),Q=s("el-input"),T=s("el-form"),r=s("el-table-column"),G=s("el-table"),I=s("el-pagination"),J=s("el-card"),W=se("loading");return v(),z("div",_e,[a(J,{class:"page-header"},{header:n(()=>[d("div",ge,[o[4]||(o[4]=d("h2",null,"股票列表",-1)),d("div",me,[a(f,{type:"primary",icon:y(ie),onClick:c,loading:m.value},{default:n(()=>[...o[3]||(o[3]=[u(" 刷新数据 ",-1)])]),_:1},8,["icon","loading"])])])]),default:n(()=>[d("div",he,[a(T,{inline:!0,class:"search-form"},{default:n(()=>[a(w,{label:"选择行业"},{default:n(()=>[a(O,{modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=t=>p.value=t),placeholder:"请选择行业",style:{width:"200px"},clearable:"",filterable:"",onChange:U},{default:n(()=>[(v(!0),z(ae,null,ne(x.value,t=>(v(),L(A,{key:t.name,label:t.name,value:t.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(w,{label:"股票代码/名称"},{default:n(()=>[a(Q,{modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=t=>h.value=t),placeholder:"请输入股票代码或名称",clearable:"",onClear:F},null,8,["modelValue"])]),_:1}),a(w,null,{default:n(()=>[a(f,{type:"primary",icon:y(oe),onClick:F},{default:n(()=>[...o[5]||(o[5]=[u("搜索",-1)])]),_:1},8,["icon"]),a(f,{icon:y(re),onClick:j},{default:n(()=>[...o[6]||(o[6]=[u("重置",-1)])]),_:1},8,["icon"])]),_:1})]),_:1})]),d("div",fe,[le((v(),L(G,{data:E.value,border:"",stripe:"",style:{width:"100%"},onSortChange:q,fit:""},{default:n(()=>[a(r,{prop:"code",label:"股票代码","min-width":"100",sortable:"",align:"center","header-align":"center"}),a(r,{prop:"name",label:"股票名称","min-width":"120",sortable:"",align:"center","header-align":"center"}),a(r,{prop:"industry",label:"行业","min-width":"120",align:"center","header-align":"center"}),a(r,{prop:"total_market_cap",label:"总市值","min-width":"100",sortable:"",align:"center","header-align":"center"},{default:n(t=>[u(_(V(t.row.total_market_cap)),1)]),_:1}),a(r,{prop:"pe_ratio",label:"市盈率","min-width":"80",sortable:"",align:"center","header-align":"center"}),a(r,{prop:"pb_ratio",label:"市净率","min-width":"80",sortable:"",align:"center","header-align":"center"}),a(r,{prop:"latest_price",label:"最新价","min-width":"100",sortable:"",align:"center","header-align":"center"}),a(r,{prop:"change_percent",label:"涨跌幅","min-width":"100",sortable:"",align:"center","header-align":"center"},{default:n(t=>[d("span",{class:B(t.row.change_percent>=0?"text-success":"text-danger")},_(t.row.change_percent?t.row.change_percent.toFixed(2)+"%":"-"),3)]),_:1}),a(r,{prop:"change_amount",label:"涨跌额","min-width":"100",sortable:"",align:"center","header-align":"center"},{default:n(t=>[d("span",{class:B(t.row.change_amount>=0?"text-success":"text-danger")},_(t.row.change_amount?t.row.change_amount.toFixed(2):"-"),3)]),_:1}),a(r,{prop:"volume",label:"成交量","min-width":"100",sortable:"",align:"center","header-align":"center"},{default:n(t=>[u(_(R(t.row.volume)),1)]),_:1}),a(r,{prop:"amount",label:"成交额","min-width":"100",sortable:"",align:"center","header-align":"center"},{default:n(t=>[u(_(V(t.row.amount)),1)]),_:1}),a(r,{prop:"turnover_rate",label:"换手率","min-width":"80",sortable:"",align:"center","header-align":"center"},{default:n(t=>[u(_(t.row.turnover_rate?t.row.turnover_rate.toFixed(2)+"%":"-"),1)]),_:1}),a(r,{label:"操作","min-width":"180",fixed:"right",align:"center","header-align":"center"},{default:n(t=>[a(f,{type:"primary",size:"small",onClick:ye=>P(t.row.code)},{default:n(()=>[...o[7]||(o[7]=[u(" 股票详情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[W,m.value]])]),d("div",ve,[a(I,{"current-page":i.value,"onUpdate:currentPage":o[2]||(o[2]=t=>i.value=t),"page-size":b.value,total:S.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:K},null,8,["current-page","page-size","total"])])]),_:1})])}}}),Se=de(be,[["__scopeId","data-v-3ccd47e9"]]);export{Se as default};
