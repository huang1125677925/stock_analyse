import{d as te,a as u,z as ae,y as ne,H as oe,I as le,c as C,b as l,g as z,f as S,e as n,w as o,i as r,E as R,l as g,M as se,k as P,t as d,Y as D,F as N,A as re,C as B,Z as ie,$ as ce,a0 as ue,o as c,_ as de}from"./index-XfLqPdCy.js";import{g as F}from"./strategyApi-DypMCbkz.js";const _e={class:"index-rps-view","element-loading-text":"正在加载指数RPS数据..."},pe={class:"page-header"},fe={class:"header-content"},ge={class:"header-actions"},ve={key:0,class:"rps-data-section"},he={class:"table-header"},me={class:"table-controls"},we={class:"custom-header"},ye={class:"custom-header"},Se={class:"change-percent-cell"},Re={class:"trend-indicator"},xe={class:"custom-header"},be={class:"rps-cell"},ke={class:"table-footer"},Ce=te({__name:"IndexRpsView",setup(Pe){const v=u(!1),x=u(!1),_=u([]),I=u(""),b=u(""),p=u(["5","20","60"]),m=u(1),w=u(20),T=ae(()=>{let e=_.value;b.value&&(e=e.filter(f=>f.指数简称.includes(b.value)));const a=(m.value-1)*w.value,i=a+w.value;return e.slice(a,i)}),E=()=>p.value.length>0?`RPS_${p.value[0]}`:"",M=e=>e>=90?"#f56c6c":e>=80?"#e6a23c":e>=70?"#67c23a":"#909399",U=e=>e>=90?"极强":e>=80?"强势":e>=70?"良好":e>=50?"一般":"弱势",j=e=>e>=90?"rank-excellent":e>=80?"rank-strong":e>=70?"rank-good":e>=50?"rank-normal":"rank-weak",q=({row:e})=>{if(p.value.length>0){const a=e[`RPS_${p.value[0]}`];if(a>=90)return"row-excellent";if(a>=80)return"row-strong";if(a>=70)return"row-good"}return""},A=e=>{e.prop&&e.order&&_.value.sort((a,i)=>{const f=a[e.prop],k=i[e.prop];return e.order==="ascending"?f-k:k-f})},L=e=>{w.value=e,m.value=1},H=e=>{m.value=e},K=e=>{R({message:`${e.指数简称} (${e.指数代码})`,type:"info"})},Y=e=>e?new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"",V=async()=>{if(!v.value){v.value=!0;try{const e=p.value.join(","),a=await F(e);_.value=a.data,I.value=a.query_time,R.success("RPS数据加载成功")}catch(e){console.error("加载RPS数据失败:",e),R.error("加载RPS数据失败，请稍后重试")}finally{v.value=!1}}},Z=async()=>{if(!x.value){x.value=!0;try{const e=p.value.join(","),i=(await F(e,!0)).saved_count;R.success(`成功保存${i}条RPS数据到数据库`)}catch(e){console.error("保存RPS数据失败:",e),R.error("保存RPS数据失败，请稍后重试")}finally{x.value=!1}}};return ne(()=>{V()}),(e,a)=>{const i=r("el-button"),f=r("el-card"),k=r("el-input"),y=r("el-table-column"),G=r("el-tag"),h=r("el-icon"),$=r("el-tooltip"),J=r("el-progress"),O=r("el-table"),Q=r("el-pagination"),W=r("el-empty"),X=le("loading");return oe((c(),C("div",_e,[l("div",pe,[n(f,{shadow:"hover"},{default:o(()=>[l("div",fe,[a[5]||(a[5]=l("div",{class:"strategy-info"},[l("h1",{class:"strategy-title"},"指数RPS强度排名"),l("p",{class:"strategy-subtitle"},"板块轮动与强势指数分析")],-1)),l("div",ge,[n(i,{onClick:V,loading:v.value,icon:g(se),type:"primary"},{default:o(()=>[...a[3]||(a[3]=[P("刷新数据",-1)])]),_:1},8,["loading","icon"]),n(i,{onClick:Z,loading:x.value,type:"success"},{default:o(()=>[...a[4]||(a[4]=[P("保存数据",-1)])]),_:1},8,["loading"])])])]),_:1})]),_.value.length>0?(c(),C("div",ve,[n(f,{shadow:"hover"},{header:o(()=>[l("div",he,[l("h3",null,"指数RPS强度排名 ("+d(Y(I.value))+")",1),l("div",me,[n(k,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=t=>b.value=t),placeholder:"搜索指数名称","prefix-icon":"Search",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])])]),default:o(()=>[n(O,{data:T.value,stripe:"",border:"",style:{width:"100%"},"default-sort":{prop:E(),order:"descending"},height:"600","row-class-name":q,"highlight-current-row":"",onSortChange:A},{default:o(()=>[n(y,{type:"index",label:"#",width:"50",fixed:"left",align:"center"}),n(y,{prop:"指数代码",label:"指数代码",width:"100",sortable:"custom",fixed:"left",align:"center"},{default:o(t=>[n(G,{size:"small",effect:"plain"},{default:o(()=>[P(d(t.row.指数代码),1)]),_:2},1024)]),_:1}),n(y,{prop:"指数简称",label:"指数简称",width:"120",sortable:"custom",fixed:"left"},{header:o(()=>[l("div",we,[a[6]||(a[6]=l("span",null,"指数简称",-1)),n($,{content:"点击指数名称可查看详情",placement:"top"},{default:o(()=>[n(h,null,{default:o(()=>[n(g(D))]),_:1})]),_:1})])]),default:o(t=>[n(i,{type:"text",onClick:s=>K(t.row)},{default:o(()=>[P(d(t.row.指数简称),1)]),_:2},1032,["onClick"])]),_:1}),(c(!0),C(N,null,re(p.value,t=>(c(),C(N,{key:t},[n(y,{label:`${t}日涨跌幅`,width:"120",sortable:"custom",prop:`${t}日涨跌幅`,align:"center"},{header:o(()=>[l("div",ye,[l("span",null,d(t)+"日涨跌幅",1),n($,{content:`${t}日内的价格变化百分比`,placement:"top"},{default:o(()=>[n(h,null,{default:o(()=>[n(g(D))]),_:1})]),_:2},1032,["content"])])]),default:o(s=>[l("div",Se,[l("span",{class:B({up:s.row[`${t}日涨跌幅`]>0,down:s.row[`${t}日涨跌幅`]<0})},d(s.row[`${t}日涨跌幅`]>0?"+":"")+d(s.row[`${t}日涨跌幅`].toFixed(2))+"% ",3),l("div",Re,[s.row[`${t}日涨跌幅`]>0?(c(),S(h,{key:0},{default:o(()=>[n(g(ie))]),_:1})):s.row[`${t}日涨跌幅`]<0?(c(),S(h,{key:1},{default:o(()=>[n(g(ce))]),_:1})):(c(),S(h,{key:2},{default:o(()=>[n(g(ue))]),_:1}))])])]),_:2},1032,["label","prop"]),n(y,{label:`RPS_${t}`,width:"170",sortable:"custom",prop:`RPS_${t}`,align:"center"},{header:o(()=>[l("div",xe,[l("span",null,"RPS_"+d(t),1),n($,{content:"相对强度指标，值越高表示相对强度越强",placement:"top"},{default:o(()=>[n(h,null,{default:o(()=>[n(g(D))]),_:1})]),_:1})])]),default:o(s=>[l("div",be,[n(J,{percentage:s.row[`RPS_${t}`],color:M(s.row[`RPS_${t}`]),format:ee=>ee.toFixed(1),"stroke-width":18,"text-inside":!0,"show-text":!0},null,8,["percentage","color","format"]),l("div",{class:B(["rps-rank",j(s.row[`RPS_${t}`])])},d(U(s.row[`RPS_${t}`])),3)])]),_:2},1032,["label","prop"])],64))),128))]),_:1},8,["data","default-sort"]),l("div",ke,[_.value.length>10?(c(),S(Q,{key:0,layout:"total, sizes, prev, pager, next",total:_.value.length,"page-sizes":[10,20,50,100],"page-size":w.value,"onUpdate:pageSize":a[1]||(a[1]=t=>w.value=t),"current-page":m.value,"onUpdate:currentPage":a[2]||(a[2]=t=>m.value=t),onSizeChange:L,onCurrentChange:H},null,8,["total","page-size","current-page"])):z("",!0)])]),_:1})])):z("",!0),!v.value&&_.value.length===0?(c(),S(W,{key:1,description:"暂无RPS数据"})):z("",!0)])),[[X,v.value]])}}}),De=de(Ce,[["__scopeId","data-v-f9234315"]]);export{De as default};
