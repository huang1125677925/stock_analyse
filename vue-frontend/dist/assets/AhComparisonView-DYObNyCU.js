import{x as U,d as j,a as i,y as q,f as b,w as n,i as s,e as t,D as H,k as A,G as N,c as $,A as E,F as T,b as z,o as _,_ as G}from"./index-B1jknyhk.js";async function I(g){return(await U.get("/django/api/tasks/ah-comparison/",{params:g})).data}const K=j({__name:"AhComparisonView",setup(g){const m=i(!1),r=i(null),y=i("last7d"),u=i({}),f=i([]),v=i([]);function D(l){if(!l)return[];if(Array.isArray(l.records)&&l.records.length>0)return l.records;if(Array.isArray(l.items)&&Array.isArray(l.fields)){const e=l.fields;return l.items.map(a=>{const d={};return e.forEach((c,p)=>d[c]=a[p]),d})}return[]}async function k(){m.value=!0;try{const l={...u.value};r.value&&(l.start_date=r.value[0],l.end_date=r.value[1]);const e=await I(l),a=D(e);f.value=a,v.value=a.length?Object.keys(a[0]):[]}finally{m.value=!1}}function C(){u.value={},r.value=null,f.value=[],v.value=[]}function h(l){const e=l.getFullYear(),a=String(l.getMonth()+1).padStart(2,"0"),d=String(l.getDate()).padStart(2,"0");return`${e}${a}${d}`}function V(l){const e=new Date,a=new Date;switch(l){case"last7d":a.setDate(e.getDate()-6);break;case"last1m":a.setMonth(e.getMonth()-1);break;case"last3m":a.setMonth(e.getMonth()-3);break;case"last6m":a.setMonth(e.getMonth()-6);break;case"last1y":a.setFullYear(e.getFullYear()-1);break;case"last3y":a.setFullYear(e.getFullYear()-3);break}r.value=[h(a),h(e)]}function M(l){V(l)}return q(()=>{V("last7d"),k()}),(l,e)=>{const a=s("el-option"),d=s("el-select"),c=s("el-form-item"),p=s("el-input"),Y=s("el-date-picker"),w=s("el-button"),x=s("el-form"),F=s("el-table-column"),R=s("el-table"),S=s("el-card"),B=N("loading");return _(),b(S,{class:"page-card"},{header:n(()=>[...e[4]||(e[4]=[z("div",{class:"card-header"},"AH股比价查询",-1)])]),default:n(()=>[t(x,{inline:!0,model:u.value,class:"query-form"},{default:n(()=>[t(c,{label:"快捷选择"},{default:n(()=>[t(d,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=o=>y.value=o),style:{width:"180px"},onChange:M},{default:n(()=>[t(a,{label:"最近一周",value:"last7d"}),t(a,{label:"最近1月",value:"last1m"}),t(a,{label:"最近三月",value:"last3m"}),t(a,{label:"最近半年",value:"last6m"}),t(a,{label:"最近一年",value:"last1y"}),t(a,{label:"最近三年",value:"last3y"})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"A股代码"},{default:n(()=>[t(p,{modelValue:u.value.ts_code,"onUpdate:modelValue":e[1]||(e[1]=o=>u.value.ts_code=o),placeholder:"例如 600519.SH",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"港股代码"},{default:n(()=>[t(p,{modelValue:u.value.hk_code,"onUpdate:modelValue":e[2]||(e[2]=o=>u.value.hk_code=o),placeholder:"例如 00960.HK",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"日期范围"},{default:n(()=>[t(Y,{modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYYMMDD","unlink-panels":""},null,8,["modelValue"])]),_:1}),t(c,null,{default:n(()=>[t(w,{type:"primary",loading:m.value,onClick:k},{default:n(()=>[...e[5]||(e[5]=[A("查询",-1)])]),_:1},8,["loading"]),t(w,{onClick:C},{default:n(()=>[...e[6]||(e[6]=[A("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),H((_(),b(R,{data:f.value,border:"",stripe:"",style:{width:"100%"}},{default:n(()=>[(_(!0),$(T,null,E(v.value,o=>(_(),b(F,{key:o,prop:o,label:o,"min-width":"120"},null,8,["prop","label"]))),128))]),_:1},8,["data"])),[[B,m.value]])]),_:1})}}}),O=G(K,[["__scopeId","data-v-5e27e9ba"]]);export{O as default};
