import{b as L}from"./industryApi-B0Iv3-0Z.js";import{d as N,a as v,r as I,y as P,c as $,e as l,w as n,i as r,E as Y,b as d,D as U,k as g,G as W,f as q,t as u,K as x,o as F,_ as z}from"./index-Bun73MF3.js";const G={class:"sw-industry-valuation-view"},K={class:"form-row"},R=N({__name:"SwIndustryValuationView",setup(T){const i=v(!1),p=v([]),_=I({level:"L1"}),V=new Date,f=new Date;f.setFullYear(f.getFullYear()-1);const w=t=>{const e=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),b=String(t.getDate()).padStart(2,"0");return`${e}${c}${b}`},s=v([w(f),w(V)]),S=[{text:"最近一年",value:()=>{const t=new Date,e=new Date;return e.setFullYear(e.getFullYear()-1),[e,t]}},{text:"最近三年",value:()=>{const t=new Date,e=new Date;return e.setFullYear(e.getFullYear()-3),[e,t]}},{text:"最近五年",value:()=>{const t=new Date,e=new Date;return e.setFullYear(e.getFullYear()-5),[e,t]}},{text:"最近十年",value:()=>{const t=new Date,e=new Date;return e.setFullYear(e.getFullYear()-10),[e,t]}}],h=async()=>{if(!s.value||s.value.length!==2){Y.warning("请选择日期范围");return}i.value=!0;try{const t=await L({start_date:s.value[0],end_date:s.value[1],level:_.level});Array.isArray(t)?p.value=t:p.value=[]}catch(t){Y.error(t.message||"获取数据失败")}finally{i.value=!1}},y=t=>t?t.toFixed(2):"--",D=t=>t>=.8?{color:"#F56C6C",fontWeight:"bold"}:t<=.2?{color:"#67C23A",fontWeight:"bold"}:t>=.6?{color:"#E6A23C"}:{color:"#303133"};return P(()=>{h()}),(t,e)=>{const c=r("el-option"),b=r("el-select"),m=r("el-form-item"),C=r("el-date-picker"),k=r("el-button"),M=r("el-form"),o=r("el-table-column"),A=r("el-table"),B=r("el-card"),E=W("loading");return F(),$("div",G,[l(B,{shadow:"hover"},{header:n(()=>[...e[2]||(e[2]=[d("div",{class:"card-header"},[d("div",{class:"header-title"},[d("span",null,"申万行业估值分析")])],-1)])]),default:n(()=>[d("div",K,[l(M,{inline:!0,"label-width":"80px"},{default:n(()=>[l(m,{label:"行业分级"},{default:n(()=>[l(b,{modelValue:_.level,"onUpdate:modelValue":e[0]||(e[0]=a=>_.level=a),placeholder:"选择分级",style:{width:"150px"}},{default:n(()=>[l(c,{label:"一级行业",value:"L1"}),l(c,{label:"二级行业",value:"L2"}),l(c,{label:"三级行业",value:"L3"})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"日期范围"},{default:n(()=>[l(C,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYYMMDD","value-format":"YYYYMMDD",shortcuts:S,style:{width:"320px"},clearable:!1},null,8,["modelValue"])]),_:1}),l(m,null,{default:n(()=>[l(k,{type:"primary",loading:i.value,onClick:h},{default:n(()=>[...e[3]||(e[3]=[g("查询",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),U((F(),q(A,{data:p.value,border:"",style:{width:"100%"},"default-sort":{prop:"pe_percentile",order:"ascending"}},{default:n(()=>[l(o,{prop:"ts_code",label:"行业代码",width:"120",sortable:""}),l(o,{prop:"name",label:"行业名称","min-width":"150",align:"center",sortable:""}),l(o,{prop:"trade_date",label:"交易日期",width:"120",sortable:""}),l(o,{label:"PE (市盈率)",align:"center"},{default:n(()=>[l(o,{prop:"pe",label:"数值",width:"100",sortable:""},{default:n(({row:a})=>[g(u(y(a.pe)),1)]),_:1}),l(o,{prop:"pe_percentile",label:"分位数 (%)",width:"120",sortable:""},{default:n(({row:a})=>[d("span",{style:x(D(a.pe_percentile))},u(a.pe_percentile!==void 0&&a.pe_percentile!==null?a.pe_percentile.toFixed(2)+"%":"--"),5)]),_:1})]),_:1}),l(o,{label:"PB (市净率)",align:"center"},{default:n(()=>[l(o,{prop:"pb",label:"数值",width:"100",sortable:""},{default:n(({row:a})=>[g(u(y(a.pb)),1)]),_:1}),l(o,{prop:"pb_percentile",label:"分位数 (%)",width:"120",sortable:""},{default:n(({row:a})=>[d("span",{style:x(D(a.pb_percentile))},u(a.pb_percentile!==void 0&&a.pb_percentile!==null?a.pb_percentile.toFixed(2)+"%":"--"),5)]),_:1})]),_:1})]),_:1},8,["data"])),[[E,i.value]])]),_:1})])}}}),J=z(R,[["__scopeId","data-v-e810ffb6"]]);export{J as default};
