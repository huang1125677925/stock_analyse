import{x as R,d as T,a as k,r as D,y as F,D as G,G as P,c as v,b as l,e,w as a,i as r,E as V,l as q,O as A,k as d,a4 as I,g as L,t as g,u as H,o as y,_ as J}from"./index-DMQzgR5H.js";async function Q(b){return(await R.get("/django/api/market/index-basic-data/",{params:b})).data}const W={class:"index-list","element-loading-text":"正在加载指数数据..."},X={class:"page-header"},Y={class:"header-content"},Z={class:"header-actions"},ee={class:"search-section"},te={class:"table-section"},ae={class:"table-header"},oe={key:0,class:"total-count"},ne={key:0,class:"pagination-wrapper"},se=T({__name:"IndexList",setup(b){const x=H(),c=k(!1),w=k([]),o=D({current_page:1,total_pages:0,total_count:0,page_size:20,has_next:!1,has_previous:!1}),i=D({search:"",code:""}),p=async()=>{c.value=!0;try{const n=await Q({page:o.current_page,page_size:o.page_size,search:i.search.trim()||void 0,code:i.code.trim()||void 0});w.value=n.list,Object.assign(o,n.pagination)}catch(n){console.error("获取指数列表失败:",n),V.error("网络请求失败，请稍后重试")}finally{c.value=!1}},m=()=>{o.current_page=1,p()},N=()=>{i.search="",i.code="",o.current_page=1,p()},S=()=>{p()},B=n=>{o.page_size=n,o.current_page=1,p()},U=n=>{o.current_page=n,p()},$=n=>{x.push(`/stock-history/${n.code}`),V.success(`正在跳转到股票历史: ${n.name} (${n.code})`)},C=n=>n?new Date(n).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-";return F(()=>{p()}),(n,t)=>{const _=r("el-button"),h=r("el-card"),z=r("el-input"),f=r("el-form-item"),j=r("el-form"),u=r("el-table-column"),E=r("el-tag"),K=r("el-table"),M=r("el-pagination"),O=P("loading");return G((y(),v("div",W,[l("div",X,[e(h,{shadow:"hover"},{default:a(()=>[l("div",Y,[t[5]||(t[5]=l("div",{class:"title-section"},[l("h1",{class:"page-title"},"指数列表"),l("p",{class:"page-subtitle"},"查看和管理股票市场指数基础信息")],-1)),l("div",Z,[e(_,{onClick:S,loading:c.value,icon:q(A),type:"primary"},{default:a(()=>[...t[4]||(t[4]=[d(" 刷新数据 ",-1)])]),_:1},8,["loading","icon"])])])]),_:1})]),l("div",ee,[e(h,{shadow:"hover"},{default:a(()=>[e(j,{model:i,inline:"",class:"search-form"},{default:a(()=>[e(f,{label:"搜索关键词"},{default:a(()=>[e(z,{modelValue:i.search,"onUpdate:modelValue":t[0]||(t[0]=s=>i.search=s),placeholder:"输入指数代码或名称",clearable:"",style:{width:"200px"},onKeyup:I(m,["enter"])},null,8,["modelValue"])]),_:1}),e(f,{label:"指数代码"},{default:a(()=>[e(z,{modelValue:i.code,"onUpdate:modelValue":t[1]||(t[1]=s=>i.code=s),placeholder:"精确匹配指数代码",clearable:"",style:{width:"150px"},onKeyup:I(m,["enter"])},null,8,["modelValue"])]),_:1}),e(f,null,{default:a(()=>[e(_,{type:"primary",onClick:m,loading:c.value},{default:a(()=>[...t[6]||(t[6]=[d(" 搜索 ",-1)])]),_:1},8,["loading"]),e(_,{onClick:N},{default:a(()=>[...t[7]||(t[7]=[d("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),l("div",te,[e(h,{shadow:"hover"},{header:a(()=>[l("div",ae,[t[8]||(t[8]=l("span",null,"指数数据列表",-1)),o.total_count?(y(),v("span",oe," 共 "+g(o.total_count)+" 条记录 ",1)):L("",!0)])]),default:a(()=>[e(K,{data:w.value,stripe:"",border:"",style:{width:"100%"},"empty-text":c.value?"正在加载...":"暂无数据"},{default:a(()=>[e(u,{prop:"id",label:"ID",width:"80",align:"center"}),e(u,{prop:"code",label:"指数代码",width:"120",align:"center"},{default:a(({row:s})=>[e(E,{type:"primary"},{default:a(()=>[d(g(s.code),1)]),_:2},1024)]),_:1}),e(u,{prop:"name",label:"指数名称","min-width":"200","show-overflow-tooltip":""}),e(u,{prop:"created_at",label:"创建时间",width:"180",align:"center"},{default:a(({row:s})=>[d(g(C(s.created_at)),1)]),_:1}),e(u,{prop:"updated_at",label:"更新时间",width:"180",align:"center"},{default:a(({row:s})=>[d(g(C(s.updated_at)),1)]),_:1}),e(u,{label:"操作",width:"120",align:"center",fixed:"right"},{default:a(({row:s})=>[e(_,{type:"primary",size:"small",onClick:le=>$(s)},{default:a(()=>[...t[9]||(t[9]=[d(" 查看详情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","empty-text"]),o.total_count>0?(y(),v("div",ne,[e(M,{"current-page":o.current_page,"onUpdate:currentPage":t[2]||(t[2]=s=>o.current_page=s),"page-size":o.page_size,"onUpdate:pageSize":t[3]||(t[3]=s=>o.page_size=s),"page-sizes":[10,20,50,100],total:o.total_count,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:B,onCurrentChange:U},null,8,["current-page","page-size","total"])])):L("",!0)]),_:1})])])),[[O,c.value]])}}}),re=J(se,[["__scopeId","data-v-50417816"]]);export{re as default};
