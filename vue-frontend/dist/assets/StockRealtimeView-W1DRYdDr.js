import{d as Y,a as g,j as Z,r as q,B as ee,y as te,c as m,e as a,w as o,i as r,E as L,b as t,F as N,A as T,f as se,L as h,t as i,k,l as V,O as E,g as ae,Q as oe,u as le,o as v,_ as ie}from"./index-B9GPqjFv.js";import{b as ne,c as re,g as de}from"./individualStockApi-DbSv9WxN.js";const ce={class:"stock-realtime-view"},_e={class:"header-content"},ue={class:"stock-info"},ve={class:"stock-code"},pe={key:0},me={class:"header-actions"},fe={class:"stock-selector"},ge={key:0,class:"realtime-data"},he={class:"price-section"},ke={class:"price-change"},ye={class:"trading-data"},xe={class:"data-item"},be={class:"data-item"},we={class:"data-item"},Se={class:"data-item"},Fe={class:"value"},Ce={class:"data-item"},Ve={class:"value"},Re={class:"data-item"},ze={class:"value"},Be={class:"valuation-data"},De={class:"data-item"},Me={class:"value"},Le={class:"data-item"},Ne={class:"value"},Te={class:"data-item"},Ee={class:"value"},Ie={class:"data-item"},$e={class:"value"},Ae={class:"data-item"},He={class:"value"},Oe={class:"data-item"},je={class:"value"},Pe={class:"update-time"},Qe={key:1,class:"loading-container"},Ue={class:"loading-header"},Ge={class:"loading-price"},Je={class:"loading-grid"},Ke={key:2,class:"empty-container"},We={class:"empty-actions"},Xe=Y({__name:"StockRealtimeView",setup(Ye){const R=Z(),z=le(),_=g(R.params.code||""),y=g(!1),F=g(!1),n=q({code:"",name:"",exchange:"",industry:"",total_market_cap:0,circulating_market_cap:0,pe_ratio:0,pb_ratio:0,list_date:""}),l=g(null),b=g(""),B=g([]),D=()=>{z.back()},w=async()=>{if(_.value){y.value=!0;try{const s=await ne(_.value);if(l.value=s,l.value){n.code=_.value,n.name=l.value.stock_name||"";try{const e=await re(_.value);n.industry=e.industry||"",n.exchange="",n.total_market_cap=e.total_market_cap||0,n.circulating_market_cap=e.circulating_market_cap||0,n.pe_ratio=e.pe_ratio||0,n.pb_ratio=e.pb_ratio||0,n.list_date=e.list_date||""}catch(e){console.error("获取股票详细信息失败:",e)}}L.success("实时行情数据加载成功")}catch(s){console.error("获取实时行情数据失败:",s),L.error("获取实时行情数据失败，请稍后重试")}finally{y.value=!1}}},I=async s=>{if(!(s.length<2)){F.value=!0;try{const c=(await de()).data;B.value=c.filter(p=>p.code.includes(s)||p.name.includes(s)).slice(0,20)}catch(e){console.error("搜索股票失败:",e)}finally{F.value=!1}}},$=s=>{_.value=s,z.push(`/stock-realtime/${s}`)},f=s=>s>0?"price-up":s<0?"price-down":"price-unchanged",A=s=>s==null?"-":s>=1e8?(s/1e8).toFixed(2)+"亿手":s>=1e4?(s/1e4).toFixed(2)+"万手":s.toString()+"手",H=s=>s==null?"-":s>=1e8?(s/1e8).toFixed(2)+"亿":s>=1e4?(s/1e4).toFixed(2)+"万":s.toString(),M=s=>s==null?"-":s>=1e11?(s/1e11).toFixed(2)+"千亿":s>=1e8?(s/1e8).toFixed(2)+"亿":s>=1e4?(s/1e4).toFixed(2)+"万":s.toString(),O=s=>s?new Date(s).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",j=()=>{const s=new Date,e=s.getHours(),c=s.getMinutes(),p=s.getDay();return p===0||p===6?"已收盘":e===9&&c>=30||e===10||e===11&&c<=30||e>=13&&e<15?"交易中":e<9||e===9&&c<30?"盘前":"已收盘"};return ee(()=>R.params.code,s=>{s&&typeof s=="string"&&(_.value=s,b.value=s,w())}),te(()=>{_.value&&(b.value=_.value,w())}),(s,e)=>{const c=r("el-button"),p=r("el-option"),P=r("el-select"),Q=r("el-form-item"),U=r("el-form"),S=r("el-divider"),d=r("el-col"),C=r("el-row"),G=r("el-tag"),x=r("el-skeleton-item"),J=r("el-skeleton"),K=r("el-icon"),W=r("el-empty"),X=r("el-card");return v(),m("div",ce,[a(X,{class:"page-header"},{header:o(()=>[t("div",_e,[t("div",ue,[t("h2",null,[k(i(n.name)+" ",1),t("span",ve,i(n.code),1)]),n.industry?(v(),m("p",pe,i(n.industry)+" | "+i(n.exchange),1)):ae("",!0)]),t("div",me,[a(c,{type:"primary",icon:V(oe),onClick:D},{default:o(()=>[...e[1]||(e[1]=[k("返回",-1)])]),_:1},8,["icon"]),a(c,{type:"success",icon:V(E),onClick:w,loading:y.value},{default:o(()=>[...e[2]||(e[2]=[k(" 刷新数据 ",-1)])]),_:1},8,["icon","loading"])])])]),default:o(()=>[t("div",fe,[a(U,{inline:!0},{default:o(()=>[a(Q,{label:"选择股票"},{default:o(()=>[a(P,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=u=>b.value=u),filterable:"",remote:"",placeholder:"请输入股票代码或名称","remote-method":I,loading:F.value,onChange:$},{default:o(()=>[(v(!0),m(N,null,T(B.value,u=>(v(),se(p,{key:u.code,label:`${u.name} (${u.code})`,value:u.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1})]),!y.value&&l.value?(v(),m("div",ge,[t("div",he,[t("div",{class:h(["current-price",f(l.value.change_percent)])},i(l.value.latest_price),3),t("div",ke,[t("div",{class:h(f(l.value.change_percent))},i(l.value.change_amount>0?"+":"")+i(l.value.change_amount),3),t("div",{class:h(f(l.value.change_percent))},i(l.value.change_percent>0?"+":"")+i(l.value.change_percent)+"% ",3)])]),a(S),t("div",ye,[a(C,{gutter:20},{default:o(()=>[a(d,{span:8,xs:12},{default:o(()=>[t("div",xe,[e[3]||(e[3]=t("div",{class:"label"},"今开",-1)),t("div",{class:h(["value",f(l.value.open_price-l.value.close_price)])},i(l.value.open_price),3)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",be,[e[4]||(e[4]=t("div",{class:"label"},"最高",-1)),t("div",{class:h(["value",f(l.value.high-l.value.close_price)])},i(l.value.high),3)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",we,[e[5]||(e[5]=t("div",{class:"label"},"最低",-1)),t("div",{class:h(["value",f(l.value.low-l.value.close_price)])},i(l.value.low),3)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",Se,[e[6]||(e[6]=t("div",{class:"label"},"昨收",-1)),t("div",Fe,i(l.value.close_price),1)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",Ce,[e[7]||(e[7]=t("div",{class:"label"},"成交量",-1)),t("div",Ve,i(A(l.value.volume)),1)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",Re,[e[8]||(e[8]=t("div",{class:"label"},"成交额",-1)),t("div",ze,i(H(l.value.amount)),1)])]),_:1})]),_:1})]),a(S),t("div",Be,[a(C,{gutter:20},{default:o(()=>[a(d,{span:8,xs:12},{default:o(()=>[t("div",De,[e[9]||(e[9]=t("div",{class:"label"},"市盈率(TTM)",-1)),t("div",Me,i(n.pe_ratio?n.pe_ratio.toFixed(2):"-"),1)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",Le,[e[10]||(e[10]=t("div",{class:"label"},"市净率",-1)),t("div",Ne,i(n.pb_ratio?n.pb_ratio.toFixed(2):"-"),1)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",Te,[e[11]||(e[11]=t("div",{class:"label"},"市值",-1)),t("div",Ee,i(M(n.total_market_cap)),1)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",Ie,[e[12]||(e[12]=t("div",{class:"label"},"流通市值",-1)),t("div",$e,i(M(n.circulating_market_cap)),1)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",Ae,[e[13]||(e[13]=t("div",{class:"label"},"换手率",-1)),t("div",He,i(l.value.turnover_rate?l.value.turnover_rate.toFixed(2)+"%":"-"),1)])]),_:1}),a(d,{span:8,xs:12},{default:o(()=>[t("div",Oe,[e[14]||(e[14]=t("div",{class:"label"},"振幅",-1)),t("div",je,i(l.value.amplitude?l.value.amplitude.toFixed(2)+"%":"-"),1)])]),_:1})]),_:1})]),a(S),t("div",Pe,[t("span",null,"数据更新时间: "+i(O(l.value.timestamp)),1),a(G,{size:"small",type:"info"},{default:o(()=>[k(i(j()),1)]),_:1})])])):y.value?(v(),m("div",Qe,[a(J,{rows:10,animated:""},{template:o(()=>[t("div",Ue,[a(x,{variant:"h1",style:{width:"50%"}})]),t("div",Ge,[a(x,{variant:"text",style:{width:"30%"}}),a(x,{variant:"text",style:{width:"20%"}})]),a(S),t("div",Je,[a(C,{gutter:20},{default:o(()=>[(v(),m(N,null,T(6,u=>a(d,{span:8,key:u},{default:o(()=>[a(x,{variant:"text",style:{width:"60%"}}),a(x,{variant:"text",style:{width:"40%"}})]),_:2},1024)),64))]),_:1})])]),_:1})])):(v(),m("div",Ke,[a(W,{description:"暂无实时行情数据","image-size":200},{image:o(()=>[a(K,{style:{"font-size":"80px",color:"#909399"}},{default:o(()=>[...e[15]||(e[15]=[t("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[t("path",{fill:"currentColor",d:"M128 896V128h768v768H128zm291.712-327.296 128 102.4 180.16-201.792-47.744-42.624-139.84 156.608-128-102.4-180.16 201.792 47.744 42.624 139.84-156.608z"})],-1)])]),_:1})]),default:o(()=>[e[18]||(e[18]=t("div",{class:"empty-text"},"可能是网络问题或者股票代码不存在",-1)),t("div",We,[a(c,{type:"primary",onClick:w,icon:V(E)},{default:o(()=>[...e[16]||(e[16]=[k("刷新数据",-1)])]),_:1},8,["icon"]),a(c,{onClick:D},{default:o(()=>[...e[17]||(e[17]=[k("返回列表",-1)])]),_:1})])]),_:1})]))]),_:1})])}}}),et=ie(Xe,[["__scopeId","data-v-5c781794"]]);export{et as default};
