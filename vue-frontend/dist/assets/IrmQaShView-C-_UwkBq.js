import{f as F}from"./irmQaApi-CoDVtWsV.js";import{d as I,a as p,r as N,y as Q,c as M,e as t,b as r,w as a,i as d,E as U,k as V,D as q,G as R,f as x,F as j,A,t as G,o as g,_ as L}from"./index-Dh57P_Gm.js";const O={class:"irm-qa-sh-view"},P={class:"header-content"},T={class:"actions"},z={class:"search-section"},J={class:"table-section"},K={class:"card-header"},W=I({__name:"IrmQaShView",emits:["loaded"],setup(X,{emit:E}){const H=E,_=p(!1),l=N({tsCode:"",fields:""}),u=p(),c=p([]),k=p([]),h=p(0);function b(i=7){const e=new Date,s=new Date(Date.now()-i*24*60*60*1e3),m=o=>{const S=o.getFullYear(),y=String(o.getMonth()+1).padStart(2,"0"),v=String(o.getDate()).padStart(2,"0"),w=String(o.getHours()).padStart(2,"0"),D=String(o.getMinutes()).padStart(2,"0"),C=String(o.getSeconds()).padStart(2,"0");return`${S}-${y}-${v} ${w}:${D}:${C}`};return[m(s),m(e)]}async function f(){try{_.value=!0;const[i,e]=u.value||b(),s=await F({tsCode:l.tsCode||void 0,pubDateStart:i,pubDateEnd:e,fields:l.fields||void 0});c.value=s.records||[],k.value=c.value.length?Object.keys(c.value[0]):[],h.value=s.count||c.value.length,H("loaded",h.value)}catch(i){U.error(i?.message||"数据加载失败")}finally{_.value=!1}}function $(){f()}function Y(){f()}function B(){l.tsCode="",l.fields="",u.value=b(),f()}return Q(()=>{u.value=b(),f()}),(i,e)=>{const s=d("el-button"),m=d("el-input"),o=d("el-form-item"),S=d("el-date-picker"),y=d("el-form"),v=d("el-card"),w=d("el-table-column"),D=d("el-table"),C=R("loading");return g(),M("div",O,[t(v,{class:"page-header",shadow:"hover"},{header:a(()=>[r("div",P,[e[5]||(e[5]=r("h2",null,"上证 E 互动问答",-1)),r("div",T,[t(s,{type:"primary",loading:_.value,onClick:$},{default:a(()=>[...e[3]||(e[3]=[V("查询",-1)])]),_:1},8,["loading"]),t(s,{onClick:B},{default:a(()=>[...e[4]||(e[4]=[V("重置",-1)])]),_:1})])])]),default:a(()=>[r("div",z,[t(y,{inline:!0,model:l,class:"query-form"},{default:a(()=>[t(o,{label:"股票代码"},{default:a(()=>[t(m,{modelValue:l.tsCode,"onUpdate:modelValue":e[0]||(e[0]=n=>l.tsCode=n),placeholder:"可选，例：600000.SH",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),t(o,{label:"发布日期范围"},{default:a(()=>[t(S,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value=n),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(o,{label:"字段"},{default:a(()=>[t(m,{modelValue:l.fields,"onUpdate:modelValue":e[2]||(e[2]=n=>l.fields=n),placeholder:"可选，逗号分隔，留空为默认字段",style:{width:"320px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1}),r("div",J,[t(v,null,{header:a(()=>[r("div",K,[r("span",null,"问答列表（"+G(h.value)+" 条）",1),t(s,{link:"",onClick:Y},{default:a(()=>[...e[6]||(e[6]=[V("刷新",-1)])]),_:1})])]),default:a(()=>[q((g(),x(D,{data:c.value,style:{width:"100%"},height:"560"},{default:a(()=>[(g(!0),M(j,null,A(k.value,n=>(g(),x(w,{key:n,prop:n,label:n,"show-overflow-tooltip":""},null,8,["prop","label"]))),128))]),_:1},8,["data"])),[[C,_.value]])]),_:1})])])}}}),te=L(W,[["__scopeId","data-v-d088ddc9"]]);export{te as default};
