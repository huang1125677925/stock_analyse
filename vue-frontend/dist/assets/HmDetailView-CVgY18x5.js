import{x as U,d as j,a as i,y as q,f as b,w as n,i as s,e as t,D as H,k as D,G as N,c as $,A as E,F as T,b as z,o as _,_ as G}from"./index-BS8n22Bm.js";async function I(g){return(await U.get("/django/api/tasks/hm-detail/",{params:g})).data}const L=j({__name:"HmDetailView",setup(g){const m=i(!1),r=i(null),y=i("last7d"),u=i({}),f=i([]),v=i([]);function M(l){if(!l)return[];if(Array.isArray(l.records)&&l.records.length>0)return l.records;if(Array.isArray(l.items)&&Array.isArray(l.fields)){const e=l.fields;return l.items.map(a=>{const c={};return e.forEach((d,p)=>c[d]=a[p]),c})}return[]}async function k(){m.value=!0;try{const l={...u.value};r.value&&(l.start_date=r.value[0],l.end_date=r.value[1]);const e=await I(l),a=M(e);f.value=a,v.value=a.length?Object.keys(a[0]):[]}finally{m.value=!1}}function Y(){u.value={},r.value=null,f.value=[],v.value=[]}function V(l){const e=l.getFullYear(),a=String(l.getMonth()+1).padStart(2,"0"),c=String(l.getDate()).padStart(2,"0");return`${e}${a}${c}`}function h(l){const e=new Date,a=new Date;switch(l){case"last7d":a.setDate(e.getDate()-6);break;case"last1m":a.setMonth(e.getMonth()-1);break;case"last3m":a.setMonth(e.getMonth()-3);break;case"last6m":a.setMonth(e.getMonth()-6);break;case"last1y":a.setFullYear(e.getFullYear()-1);break;case"last3y":a.setFullYear(e.getFullYear()-3);break}r.value=[V(a),V(e)]}function x(l){h(l)}return q(()=>{h("last7d"),k()}),(l,e)=>{const a=s("el-option"),c=s("el-select"),d=s("el-form-item"),p=s("el-input"),A=s("el-date-picker"),w=s("el-button"),C=s("el-form"),F=s("el-table-column"),R=s("el-table"),S=s("el-card"),B=N("loading");return _(),b(S,{class:"page-card"},{header:n(()=>[...e[4]||(e[4]=[z("div",{class:"card-header"},"游资每日明细",-1)])]),default:n(()=>[t(C,{inline:!0,model:u.value,class:"query-form"},{default:n(()=>[t(d,{label:"快捷选择"},{default:n(()=>[t(c,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=o=>y.value=o),style:{width:"180px"},onChange:x},{default:n(()=>[t(a,{label:"最近一周",value:"last7d"}),t(a,{label:"最近1月",value:"last1m"}),t(a,{label:"最近三月",value:"last3m"}),t(a,{label:"最近半年",value:"last6m"}),t(a,{label:"最近一年",value:"last1y"}),t(a,{label:"最近三年",value:"last3y"})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"游资名称"},{default:n(()=>[t(p,{modelValue:u.value.hm_name,"onUpdate:modelValue":e[1]||(e[1]=o=>u.value.hm_name=o),placeholder:"如 上海某营业部",clearable:""},null,8,["modelValue"])]),_:1}),t(d,{label:"股票代码"},{default:n(()=>[t(p,{modelValue:u.value.ts_code,"onUpdate:modelValue":e[2]||(e[2]=o=>u.value.ts_code=o),placeholder:"如 000001.SZ",clearable:""},null,8,["modelValue"])]),_:1}),t(d,{label:"日期范围"},{default:n(()=>[t(A,{modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYYMMDD","unlink-panels":""},null,8,["modelValue"])]),_:1}),t(d,null,{default:n(()=>[t(w,{type:"primary",loading:m.value,onClick:k},{default:n(()=>[...e[5]||(e[5]=[D("查询",-1)])]),_:1},8,["loading"]),t(w,{onClick:Y},{default:n(()=>[...e[6]||(e[6]=[D("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),H((_(),b(R,{data:f.value,border:"",stripe:"",style:{width:"100%"}},{default:n(()=>[(_(!0),$(T,null,E(v.value,o=>(_(),b(F,{key:o,prop:o,label:o,"min-width":"120"},null,8,["prop","label"]))),128))]),_:1},8,["data"])),[[B,m.value]])]),_:1})}}}),P=G(L,[["__scopeId","data-v-2e1d64ea"]]);export{P as default};
