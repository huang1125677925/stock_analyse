import{x as E,d as N,a as Y,r as j,y as L,c as k,e as t,w as a,i as s,E as O,b as d,l as H,O as T,k as M,M as F,D as I,f as b,g as z,G,F as R,A as q,o as _,_ as J}from"./index-CPDmQmJM.js";async function P(g){return(await E.get("/django/api/tasks/stock-hsgt/",{params:g})).data}const Q={class:"stock-hsgt-list-view"},W={class:"header-content"},X={class:"header-actions"},$={class:"card-header"},ee=N({__name:"StockHsgtListView",setup(g){const r=Y(!1),p=Y([]),V=Y([]);function D(l){return l.toISOString().slice(0,10).replace(/-/g,"")}const h=()=>D(new Date),n=j({type:"HK_SZ",ts_code:"",start_date:(l=>D(new Date(Date.now()-l*24*60*60*1e3)))(30),end_date:h(),trade_date:void 0,fields:void 0});function w(l){if(l.records&&Array.isArray(l.records))return l.records;if(l.fields&&l.items){const e=l.fields;return l.items.map(m=>{const i={};return e.forEach((u,v)=>{i[u]=m[v]}),i})}return[]}async function f(){r.value=!0;try{const l=await P({...n}),e=w(l);p.value=e,V.value=e.length?Object.keys(e[0]):[]}catch(l){O.error(l?.message||"数据加载失败")}finally{r.value=!1}}function K(){f()}function x(){f()}return L(()=>{f()}),(l,e)=>{const m=s("el-button"),i=s("el-card"),u=s("el-option"),v=s("el-select"),c=s("el-form-item"),S=s("el-input"),y=s("el-date-picker"),C=s("el-form"),U=s("el-table-column"),A=s("el-table"),Z=s("el-empty"),B=G("loading");return _(),k("div",Q,[t(i,{class:"page-header"},{default:a(()=>[d("div",W,[e[7]||(e[7]=d("h2",null,"沪深港通股票列表",-1)),d("div",X,[t(m,{type:"primary",icon:H(T),onClick:x,loading:r.value},{default:a(()=>[...e[6]||(e[6]=[M("刷新",-1)])]),_:1},8,["icon","loading"])])])]),_:1}),t(i,{class:"search-section"},{header:a(()=>[d("div",$,[e[9]||(e[9]=d("span",null,"查询条件",-1)),t(m,{type:"primary",link:"",icon:H(F),onClick:K},{default:a(()=>[...e[8]||(e[8]=[M("搜索",-1)])]),_:1},8,["icon"])])]),default:a(()=>[t(C,{inline:!0,model:n,"label-width":"100px"},{default:a(()=>[t(c,{label:"类型"},{default:a(()=>[t(v,{modelValue:n.type,"onUpdate:modelValue":e[0]||(e[0]=o=>n.type=o),placeholder:"选择类型",style:{width:"200px"}},{default:a(()=>[t(u,{label:"港股→深股通(HK_SZ)",value:"HK_SZ"}),t(u,{label:"深股通→港股(SZ_HK)",value:"SZ_HK"}),t(u,{label:"港股→沪股通(HK_SH)",value:"HK_SH"}),t(u,{label:"沪股通→港股(SH_HK)",value:"SH_HK"})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"TS代码"},{default:a(()=>[t(S,{modelValue:n.ts_code,"onUpdate:modelValue":e[1]||(e[1]=o=>n.ts_code=o),placeholder:"选填，如 600000.SH",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"开始日期"},{default:a(()=>[t(y,{modelValue:n.start_date,"onUpdate:modelValue":e[2]||(e[2]=o=>n.start_date=o),type:"date",format:"YYYYMMDD","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),t(c,{label:"结束日期"},{default:a(()=>[t(y,{modelValue:n.end_date,"onUpdate:modelValue":e[3]||(e[3]=o=>n.end_date=o),type:"date",format:"YYYYMMDD","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),t(c,{label:"交易日期"},{default:a(()=>[t(y,{modelValue:n.trade_date,"onUpdate:modelValue":e[4]||(e[4]=o=>n.trade_date=o),type:"date",format:"YYYYMMDD","value-format":"YYYYMMDD"},null,8,["modelValue"])]),_:1}),t(c,{label:"字段列表"},{default:a(()=>[t(S,{modelValue:n.fields,"onUpdate:modelValue":e[5]||(e[5]=o=>n.fields=o),placeholder:"逗号分隔，可留空",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),t(i,{class:"table-section"},{header:a(()=>[...e[10]||(e[10]=[d("div",{class:"card-header"},[d("span",null,"数据列表")],-1)])]),default:a(()=>[I((_(),b(A,{data:p.value,height:"560",style:{width:"100%"}},{default:a(()=>[(_(!0),k(R,null,q(V.value,o=>(_(),b(U,{key:o,prop:o,label:o,"min-width":"120"},null,8,["prop","label"]))),128))]),_:1},8,["data"])),[[B,r.value]]),!r.value&&p.value.length===0?(_(),b(Z,{key:0,description:"暂无数据"})):z("",!0)]),_:1})])}}}),ae=J(ee,[["__scopeId","data-v-b1fbf13a"]]);export{ae as default};
